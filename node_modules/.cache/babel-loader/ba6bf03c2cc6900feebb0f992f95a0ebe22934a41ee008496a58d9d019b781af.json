{"ast":null,"code":"// src/components/PatientRoutines.js\nimport React,{useState,useEffect}from'react';import{useParams,Link}from'react-router-dom';import axios from'axios';import{PieChart,Pie,Cell,Tooltip,Legend,BarChart,Bar,XAxis,YAxis,CartesianGrid,RadarChart,PolarGrid,PolarAngleAxis,PolarRadiusAxis,Radar,ResponsiveContainer}from'recharts';import'../styles/therapistRoutines.css';// Mapeo de actividad a categoría\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const categoryMap={futbol:'Ocio',dibujos:'Ocio',comics:'Ocio',tarea:'Obligaciones',videojuegos:'Ocio',helado:'Ocio',parque:'Ocio',banio:'Autocuidado',dormir:'Autocuidado',musica:'Ocio',bailar:'Ocio',amigos:'Ocio',bicicleta:'Ocio',dibujar:'Ocio',mascotas:'Ocio',experimentos:'Obligaciones',cantar:'Ocio',lego:'Ocio',nadar:'Autocuidado',computadora:'Ocio'};// Mapeo de categoría a grupo\nconst groupMap={Autocuidado:'Autocuidado',Obligaciones:'Obligaciones',Ocio:'Ocio'};// Colores para gráficos\nconst COLORS=['#8884d8','#82ca9d','#ffc658','#ff8042','#0088FE'];function PatientRoutines(){const{patientId}=useParams();const[results,setResults]=useState([]);const[filtered,setFiltered]=useState([]);const[from,setFrom]=useState('');const[to,setTo]=useState('');const[selected,setSelected]=useState(null);const[metrics,setMetrics]=useState(null);// 1) Cargar resultados de Máquina del Tiempo\nuseEffect(()=>{const token=localStorage.getItem('token');axios.get(`/api/game?patientId=${patientId}`,{headers:{'x-auth-token':token}}).then(resp=>{setResults(resp.data);// filtro inicial: últimos 7 días\nconst now=new Date(),weekAgo=new Date(now);weekAgo.setDate(now.getDate()-6);setFrom(weekAgo.toISOString().slice(0,10));setTo(now.toISOString().slice(0,10));}).catch(console.error);},[patientId]);// 2) Filtrar por rango de fechas\nuseEffect(()=>{if(!from||!to)return;const f=new Date(from),t=new Date(to);t.setHours(23,59,59,999);setFiltered(results.filter(r=>{const d=new Date(r.createdAt);return d>=f&&d<=t;}));},[results,from,to]);// 3) Elegir primer día filtrado\nuseEffect(()=>{if(filtered.length){setSelected(filtered[0].createdAt);}else{setSelected(null);setMetrics(null);}},[filtered]);// 4) Calcular métricas al cambiar selección\nuseEffect(()=>{if(!selected)return;const res=filtered.find(r=>r.createdAt===selected);if(!res)return setMetrics(null);setMetrics(computeMetrics(res,filtered));},[selected,filtered]);// Función para calcular todas las métricas\nfunction computeMetrics(result,allResults){const slots=result.timeSlots||[];// aplanar actividades\nconst activities=slots.flatMap(slot=>(slot.activities||[]).map(a=>({...a,slot:slot.slot})));const totalMin=activities.reduce((s,a)=>s+a.duration,0)||1;// 1. Distribución % por categoría\nconst catSum={};activities.forEach(a=>{const c=categoryMap[a.activityId]||'Otros';catSum[c]=(catSum[c]||0)+a.duration;});const distribution=Object.entries(catSum).map(_ref=>{let[name,val]=_ref;return{name,value:+(val/totalMin*100).toFixed(1)};});// 2. Horas absolutas por categoría\nconst hours=Object.entries(catSum).map(_ref2=>{let[name,val]=_ref2;return{name,hours:+(val/60).toFixed(2)};});// 3. Diversidad de actividades (conteo único)\nconst diversity=new Set(activities.map(a=>a.activityId)).size;// 4. Consistencia: % de franjas horarias (24) cubiertas\nconst covered=new Set(activities.map(a=>a.slot)).size;const consistency=+(covered/24*100).toFixed(1);// 5. Balance Autocuidado/Obligaciones/Ocio (radar)\nconst grpSum={Autocuidado:0,Obligaciones:0,Ocio:0};activities.forEach(a=>{const cat=categoryMap[a.activityId]||'Ocio';const g=groupMap[cat]||'Ocio';grpSum[g]+=a.duration;});const groupBalance=Object.entries(grpSum).map(_ref3=>{let[subject,val]=_ref3;return{subject,value:+(val/totalMin*100).toFixed(1)};});// 6. Patrón horarios (mañana/tarde/noche)\nconst periods={Mañana:[6,11],Tarde:[12,17],Noche:[18,23]};const pdSum={Mañana:0,Tarde:0,Noche:0};activities.forEach(a=>{const h=parseInt(a.slot.split(':')[0],10);for(let p in periods){const[s,e]=periods[p];if(h>=s&&h<=e)pdSum[p]+=a.duration;}});const timeOfDay=Object.entries(pdSum).map(_ref4=>{let[name,val]=_ref4;return{name,hours:+(val/60).toFixed(2)};});// 7. Variabilidad diaria: media y desviación por categoría\nconst allCatArrays={};allResults.forEach(r=>{const arr=(r.timeSlots||[]).flatMap(sl=>(sl.activities||[]).map(a=>{const c=categoryMap[a.activityId]||'Otros';return{c,dur:a.duration};}));const sums={};arr.forEach(_ref5=>{let{c,dur}=_ref5;return sums[c]=(sums[c]||0)+dur;});for(let c in sums){if(!allCatArrays[c])allCatArrays[c]=[];allCatArrays[c].push(sums[c]);}});const variability=Object.entries(allCatArrays).map(_ref6=>{let[cat,arr]=_ref6;const mean=arr.reduce((a,b)=>a+b,0)/arr.length;const std=Math.sqrt(arr.reduce((a,b)=>a+Math.pow(b-mean,2),0)/arr.length);return{category:cat,mean:+(mean/60).toFixed(2),std:+(std/60).toFixed(2)};});// 8. Top 5 actividades por tiempo\nconst actSum={};activities.forEach(a=>{actSum[a.activityId]=(actSum[a.activityId]||0)+a.duration;});const top5=Object.entries(actSum).map(_ref7=>{let[id,val]=_ref7;return{id,name:id,minutes:val};}).sort((a,b)=>b.minutes-a.minutes).slice(0,5);// 9. Índice de equilibrio global (1 - suma |p_i - 1/N| / 2)\nconst N=distribution.length;const uniform=100/N;const idx=1-distribution.reduce((acc,cat)=>acc+Math.abs(cat.value-uniform),0)/2/100;const balanceIndex=+idx.toFixed(2);return{distribution,hours,diversity,consistency,groupBalance,timeOfDay,variability,top5,balanceIndex};}return/*#__PURE__*/_jsxs(\"div\",{className:\"routines-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"routines-header\",children:[/*#__PURE__*/_jsx(Link,{to:\"/therapist/routines\",children:\"\\u2190 Volver\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Estad\\xEDsticas de Rutinas\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"filter-section\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Desde:\",/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:from,onChange:e=>setFrom(e.target.value)})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Hasta:\",/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:to,onChange:e=>setTo(e.target.value)})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"D\\xEDa:\",/*#__PURE__*/_jsx(\"select\",{value:selected||'',onChange:e=>setSelected(e.target.value),children:filtered.map(r=>{const d=new Date(r.createdAt).toLocaleDateString();return/*#__PURE__*/_jsx(\"option\",{value:r.createdAt,children:d},r.createdAt);})})]})]}),metrics&&/*#__PURE__*/_jsxs(\"div\",{className:\"metrics-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[\"Diversidad: \",/*#__PURE__*/_jsx(\"strong\",{children:metrics.diversity})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[\"Consistencia: \",/*#__PURE__*/_jsxs(\"strong\",{children:[metrics.consistency,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[\"\\xCDndice Equilibrio: \",/*#__PURE__*/_jsx(\"strong\",{children:metrics.balanceIndex})]})]}),metrics&&/*#__PURE__*/_jsxs(\"div\",{className:\"charts-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Distribuci\\xF3n % por Categor\\xEDa\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(PieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:metrics.distribution,dataKey:\"value\",nameKey:\"name\",cx:\"50%\",cy:\"50%\",outerRadius:80,label:true,children:metrics.distribution.map((e,i)=>/*#__PURE__*/_jsx(Cell,{fill:COLORS[i%COLORS.length]},i))}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Horas por Categor\\xEDa\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(BarChart,{data:metrics.hours,margin:{top:20,right:30,left:0,bottom:0},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"hours\",fill:\"#8884d8\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Balance Ocupacional\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(RadarChart,{cx:\"50%\",cy:\"50%\",outerRadius:80,data:metrics.groupBalance,children:[/*#__PURE__*/_jsx(PolarGrid,{}),/*#__PURE__*/_jsx(PolarAngleAxis,{dataKey:\"subject\"}),/*#__PURE__*/_jsx(PolarRadiusAxis,{angle:30,domain:[0,100]}),/*#__PURE__*/_jsx(Radar,{dataKey:\"value\",stroke:\"#82ca9d\",fill:\"#82ca9d\",fillOpacity:0.6}),/*#__PURE__*/_jsx(Tooltip,{})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Horas Ma\\xF1ana/Tarde/Noche\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(BarChart,{data:metrics.timeOfDay,margin:{top:20,right:30,left:0,bottom:0},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"hours\",fill:\"#ffc658\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block full-width\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Top\\xA05 Actividades (min)\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(BarChart,{data:metrics.top5,layout:\"vertical\",margin:{top:20,right:30,left:50,bottom:0},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{type:\"number\"}),/*#__PURE__*/_jsx(YAxis,{dataKey:\"name\",type:\"category\"}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"minutes\",fill:\"#ff8042\"})]})})]})]}),metrics&&/*#__PURE__*/_jsxs(\"div\",{className:\"variability-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Variabilidad Diaria\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"variability-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Categor\\xEDa\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Media\\xA0(h)\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Desv.\\xA0est.\\xA0(h)\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:metrics.variability.map(v=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:v.category}),/*#__PURE__*/_jsx(\"td\",{children:v.mean}),/*#__PURE__*/_jsx(\"td\",{children:v.std})]},v.category))})]})]})]});}export default PatientRoutines;","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","axios","PieChart","Pie","Cell","Tooltip","Legend","BarChart","Bar","XAxis","YAxis","CartesianGrid","RadarChart","PolarGrid","PolarAngleAxis","PolarRadiusAxis","Radar","ResponsiveContainer","jsx","_jsx","jsxs","_jsxs","categoryMap","futbol","dibujos","comics","tarea","videojuegos","helado","parque","banio","dormir","musica","bailar","amigos","bicicleta","dibujar","mascotas","experimentos","cantar","lego","nadar","computadora","groupMap","Autocuidado","Obligaciones","Ocio","COLORS","PatientRoutines","patientId","results","setResults","filtered","setFiltered","from","setFrom","to","setTo","selected","setSelected","metrics","setMetrics","token","localStorage","getItem","get","headers","then","resp","data","now","Date","weekAgo","setDate","getDate","toISOString","slice","catch","console","error","f","t","setHours","filter","r","d","createdAt","length","res","find","computeMetrics","result","allResults","slots","timeSlots","activities","flatMap","slot","map","a","totalMin","reduce","s","duration","catSum","forEach","c","activityId","distribution","Object","entries","_ref","name","val","value","toFixed","hours","_ref2","diversity","Set","size","covered","consistency","grpSum","cat","g","groupBalance","_ref3","subject","periods","Mañana","Tarde","Noche","pdSum","h","parseInt","split","p","e","timeOfDay","_ref4","allCatArrays","arr","sl","dur","sums","_ref5","push","variability","_ref6","mean","b","std","Math","sqrt","pow","category","actSum","top5","_ref7","id","minutes","sort","N","uniform","idx","acc","abs","balanceIndex","className","children","type","onChange","target","toLocaleDateString","width","height","dataKey","nameKey","cx","cy","outerRadius","label","i","fill","margin","top","right","left","bottom","strokeDasharray","angle","domain","stroke","fillOpacity","layout","v"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/PatientRoutines.js"],"sourcesContent":["// src/components/PatientRoutines.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport {\r\n  PieChart, Pie, Cell, Tooltip, Legend,\r\n  BarChart, Bar, XAxis, YAxis, CartesianGrid,\r\n  RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar,\r\n  ResponsiveContainer\r\n} from 'recharts';\r\nimport '../styles/therapistRoutines.css';\r\n\r\n// Mapeo de actividad a categoría\r\nconst categoryMap = {\r\n  futbol: 'Ocio', dibujos: 'Ocio', comics: 'Ocio',\r\n  tarea: 'Obligaciones', videojuegos: 'Ocio', helado: 'Ocio',\r\n  parque: 'Ocio', banio: 'Autocuidado', dormir: 'Autocuidado',\r\n  musica: 'Ocio', bailar: 'Ocio', amigos: 'Ocio',\r\n  bicicleta: 'Ocio', dibujar: 'Ocio', mascotas: 'Ocio',\r\n  experimentos: 'Obligaciones', cantar: 'Ocio', lego: 'Ocio',\r\n  nadar: 'Autocuidado', computadora: 'Ocio'\r\n};\r\n// Mapeo de categoría a grupo\r\nconst groupMap = {\r\n  Autocuidado: 'Autocuidado',\r\n  Obligaciones: 'Obligaciones',\r\n  Ocio: 'Ocio'\r\n};\r\n// Colores para gráficos\r\nconst COLORS = ['#8884d8', '#82ca9d', '#ffc658', '#ff8042', '#0088FE'];\r\n\r\nfunction PatientRoutines() {\r\n  const { patientId } = useParams();\r\n  const [results, setResults] = useState([]);\r\n  const [filtered, setFiltered] = useState([]);\r\n  const [from, setFrom] = useState('');\r\n  const [to, setTo] = useState('');\r\n  const [selected, setSelected] = useState(null);\r\n  const [metrics, setMetrics] = useState(null);\r\n\r\n  // 1) Cargar resultados de Máquina del Tiempo\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    axios.get(`/api/game?patientId=${patientId}`, {\r\n      headers: { 'x-auth-token': token }\r\n    })\r\n      .then(resp => {\r\n        setResults(resp.data);\r\n        // filtro inicial: últimos 7 días\r\n        const now = new Date(), weekAgo = new Date(now);\r\n        weekAgo.setDate(now.getDate() - 6);\r\n        setFrom(weekAgo.toISOString().slice(0,10));\r\n        setTo(now.toISOString().slice(0,10));\r\n      })\r\n      .catch(console.error);\r\n  }, [patientId]);\r\n\r\n  // 2) Filtrar por rango de fechas\r\n  useEffect(() => {\r\n    if (!from || !to) return;\r\n    const f = new Date(from), t = new Date(to);\r\n    t.setHours(23,59,59,999);\r\n    setFiltered(results.filter(r => {\r\n      const d = new Date(r.createdAt);\r\n      return d >= f && d <= t;\r\n    }));\r\n  }, [results, from, to]);\r\n\r\n  // 3) Elegir primer día filtrado\r\n  useEffect(() => {\r\n    if (filtered.length) {\r\n      setSelected(filtered[0].createdAt);\r\n    } else {\r\n      setSelected(null);\r\n      setMetrics(null);\r\n    }\r\n  }, [filtered]);\r\n\r\n  // 4) Calcular métricas al cambiar selección\r\n  useEffect(() => {\r\n    if (!selected) return;\r\n    const res = filtered.find(r => r.createdAt === selected);\r\n    if (!res) return setMetrics(null);\r\n    setMetrics(computeMetrics(res, filtered));\r\n  }, [selected, filtered]);\r\n\r\n  // Función para calcular todas las métricas\r\n  function computeMetrics(result, allResults) {\r\n    const slots = result.timeSlots || [];\r\n    // aplanar actividades\r\n    const activities = slots.flatMap(slot =>\r\n      (slot.activities || []).map(a => ({ ...a, slot: slot.slot }))\r\n    );\r\n    const totalMin = activities.reduce((s,a) => s + a.duration, 0) || 1;\r\n\r\n    // 1. Distribución % por categoría\r\n    const catSum = {};\r\n    activities.forEach(a => {\r\n      const c = categoryMap[a.activityId] || 'Otros';\r\n      catSum[c] = (catSum[c] || 0) + a.duration;\r\n    });\r\n    const distribution = Object.entries(catSum).map(([name,val]) => ({\r\n      name, value: +((val/totalMin)*100).toFixed(1)\r\n    }));\r\n\r\n    // 2. Horas absolutas por categoría\r\n    const hours = Object.entries(catSum).map(([name,val]) => ({\r\n      name, hours: +(val/60).toFixed(2)\r\n    }));\r\n\r\n    // 3. Diversidad de actividades (conteo único)\r\n    const diversity = new Set(activities.map(a=>a.activityId)).size;\r\n\r\n    // 4. Consistencia: % de franjas horarias (24) cubiertas\r\n    const covered = new Set(activities.map(a=>a.slot)).size;\r\n    const consistency = +((covered/24)*100).toFixed(1);\r\n\r\n    // 5. Balance Autocuidado/Obligaciones/Ocio (radar)\r\n    const grpSum = { Autocuidado:0, Obligaciones:0, Ocio:0 };\r\n    activities.forEach(a => {\r\n      const cat = categoryMap[a.activityId] || 'Ocio';\r\n      const g = groupMap[cat] || 'Ocio';\r\n      grpSum[g] += a.duration;\r\n    });\r\n    const groupBalance = Object.entries(grpSum).map(([subject,val]) => ({\r\n      subject, value: +((val/totalMin)*100).toFixed(1)\r\n    }));\r\n\r\n    // 6. Patrón horarios (mañana/tarde/noche)\r\n    const periods = { Mañana:[6,11], Tarde:[12,17], Noche:[18,23] };\r\n    const pdSum = { Mañana:0, Tarde:0, Noche:0 };\r\n    activities.forEach(a => {\r\n      const h = parseInt(a.slot.split(':')[0],10);\r\n      for (let p in periods) {\r\n        const [s,e] = periods[p];\r\n        if (h>=s && h<=e) pdSum[p] += a.duration;\r\n      }\r\n    });\r\n    const timeOfDay = Object.entries(pdSum).map(([name,val]) => ({\r\n      name, hours: +(val/60).toFixed(2)\r\n    }));\r\n\r\n    // 7. Variabilidad diaria: media y desviación por categoría\r\n    const allCatArrays = {};\r\n    allResults.forEach(r => {\r\n      const arr = (r.timeSlots||[]).flatMap(sl =>\r\n        (sl.activities||[]).map(a => {\r\n          const c = categoryMap[a.activityId]||'Otros';\r\n          return { c, dur: a.duration };\r\n        })\r\n      );\r\n      const sums = {};\r\n      arr.forEach(({c,dur}) => sums[c] = (sums[c]||0)+dur);\r\n      for (let c in sums) {\r\n        if (!allCatArrays[c]) allCatArrays[c]=[];\r\n        allCatArrays[c].push(sums[c]);\r\n      }\r\n    });\r\n    const variability = Object.entries(allCatArrays).map(([cat,arr]) => {\r\n      const mean = arr.reduce((a,b)=>a+b,0)/arr.length;\r\n      const std = Math.sqrt(arr.reduce((a,b)=>a+Math.pow(b-mean,2),0)/arr.length);\r\n      return { category: cat, mean: +(mean/60).toFixed(2), std: +(std/60).toFixed(2) };\r\n    });\r\n\r\n    // 8. Top 5 actividades por tiempo\r\n    const actSum = {};\r\n    activities.forEach(a => {\r\n      actSum[a.activityId] = (actSum[a.activityId]||0) + a.duration;\r\n    });\r\n    const top5 = Object.entries(actSum)\r\n      .map(([id,val]) => ({ id, name: id, minutes: val }))\r\n      .sort((a,b)=>b.minutes-a.minutes)\r\n      .slice(0,5);\r\n\r\n    // 9. Índice de equilibrio global (1 - suma |p_i - 1/N| / 2)\r\n    const N = distribution.length;\r\n    const uniform = 100/N;\r\n    const idx = 1 - (distribution.reduce((acc,cat)=>\r\n      acc + Math.abs(cat.value - uniform), 0)/2/100);\r\n    const balanceIndex = +idx.toFixed(2);\r\n\r\n    return {\r\n      distribution, hours, diversity, consistency,\r\n      groupBalance, timeOfDay, variability, top5, balanceIndex\r\n    };\r\n  }\r\n\r\n  return (\r\n    <div className=\"routines-container\">\r\n      <header className=\"routines-header\">\r\n        <Link to=\"/therapist/routines\">← Volver</Link>\r\n        <h2>Estadísticas de Rutinas</h2>\r\n      </header>\r\n\r\n      <section className=\"filter-section\">\r\n        <label>\r\n          Desde:\r\n          <input type=\"date\" value={from} onChange={e=>setFrom(e.target.value)} />\r\n        </label>\r\n        <label>\r\n          Hasta:\r\n          <input type=\"date\" value={to} onChange={e=>setTo(e.target.value)} />\r\n        </label>\r\n        <label>\r\n          Día:\r\n          <select value={selected||''} onChange={e=>setSelected(e.target.value)}>\r\n            {filtered.map(r=>{\r\n              const d = new Date(r.createdAt).toLocaleDateString();\r\n              return <option key={r.createdAt} value={r.createdAt}>{d}</option>;\r\n            })}\r\n          </select>\r\n        </label>\r\n      </section>\r\n\r\n      {metrics && (\r\n        <div className=\"metrics-grid\">\r\n          <div className=\"metric-card\">Diversidad: <strong>{metrics.diversity}</strong></div>\r\n          <div className=\"metric-card\">Consistencia: <strong>{metrics.consistency}%</strong></div>\r\n          <div className=\"metric-card\">Índice Equilibrio: <strong>{metrics.balanceIndex}</strong></div>\r\n        </div>\r\n      )}\r\n\r\n      {metrics && (\r\n        <div className=\"charts-grid\">\r\n          {/* Distribución % */}\r\n          <div className=\"chart-block\">\r\n            <h3>Distribución % por Categoría</h3>\r\n            <ResponsiveContainer width=\"100%\" height={250}>\r\n              <PieChart>\r\n                <Pie\r\n                  data={metrics.distribution}\r\n                  dataKey=\"value\"\r\n                  nameKey=\"name\"\r\n                  cx=\"50%\"\r\n                  cy=\"50%\"\r\n                  outerRadius={80}\r\n                  label\r\n                >\r\n                  {metrics.distribution.map((e,i)=>\r\n                    <Cell key={i} fill={COLORS[i%COLORS.length]} />\r\n                  )}\r\n                </Pie>\r\n                <Tooltip />\r\n                <Legend />\r\n              </PieChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n\r\n          {/* Horas absolutas */}\r\n          <div className=\"chart-block\">\r\n            <h3>Horas por Categoría</h3>\r\n            <ResponsiveContainer width=\"100%\" height={250}>\r\n              <BarChart data={metrics.hours} margin={{ top:20,right:30,left:0,bottom:0 }}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"name\"/>\r\n                <YAxis/>\r\n                <Tooltip/>\r\n                <Bar dataKey=\"hours\" fill=\"#8884d8\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n\r\n          {/* Radar balance */}\r\n          <div className=\"chart-block\">\r\n            <h3>Balance Ocupacional</h3>\r\n            <ResponsiveContainer width=\"100%\" height={250}>\r\n              <RadarChart cx=\"50%\" cy=\"50%\" outerRadius={80} data={metrics.groupBalance}>\r\n                <PolarGrid/>\r\n                <PolarAngleAxis dataKey=\"subject\"/>\r\n                <PolarRadiusAxis angle={30} domain={[0,100]}/>\r\n                <Radar\r\n                  dataKey=\"value\"\r\n                  stroke=\"#82ca9d\"\r\n                  fill=\"#82ca9d\"\r\n                  fillOpacity={0.6}\r\n                />\r\n                <Tooltip/>\r\n              </RadarChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n\r\n          {/* Patrón horario */}\r\n          <div className=\"chart-block\">\r\n            <h3>Horas Mañana/Tarde/Noche</h3>\r\n            <ResponsiveContainer width=\"100%\" height={250}>\r\n              <BarChart data={metrics.timeOfDay} margin={{ top:20,right:30,left:0,bottom:0 }}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"name\"/>\r\n                <YAxis/>\r\n                <Tooltip/>\r\n                <Bar dataKey=\"hours\" fill=\"#ffc658\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n\r\n          {/* Top 5 actividades */}\r\n          <div className=\"chart-block full-width\">\r\n            <h3>Top 5 Actividades (min)</h3>\r\n            <ResponsiveContainer width=\"100%\" height={250}>\r\n              <BarChart data={metrics.top5} layout=\"vertical\" margin={{ top:20,right:30,left:50,bottom:0 }}>\r\n                <CartesianGrid strokeDasharray=\"3 3\"/>\r\n                <XAxis type=\"number\"/>\r\n                <YAxis dataKey=\"name\" type=\"category\" />\r\n                <Tooltip/>\r\n                <Bar dataKey=\"minutes\" fill=\"#ff8042\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Variabilidad diaria */}\r\n      {metrics && (\r\n        <div className=\"variability-section\">\r\n          <h3>Variabilidad Diaria</h3>\r\n          <table className=\"variability-table\">\r\n            <thead>\r\n              <tr>\r\n                <th>Categoría</th>\r\n                <th>Media (h)</th>\r\n                <th>Desv. est. (h)</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {metrics.variability.map(v => (\r\n                <tr key={v.category}>\r\n                  <td>{v.category}</td>\r\n                  <td>{v.mean}</td>\r\n                  <td>{v.std}</td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PatientRoutines;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}