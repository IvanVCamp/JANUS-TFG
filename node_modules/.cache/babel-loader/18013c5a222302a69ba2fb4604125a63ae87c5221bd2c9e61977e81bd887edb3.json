{"ast":null,"code":"// src/pages/RoutineTemplatesPage.js\nimport React,{useState,useEffect,useCallback}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import{FaTrash,FaEdit}from'react-icons/fa';import'../styles/routineTemplates.css';import'./RoutineTemplatesPage.css';// crea este fichero para los estilos del modal\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function RoutineTemplatesPage(){const[templates,setTemplates]=useState([]);const[patients,setPatients]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[assignments,setAssignments]=useState({});// ** Estados para el modal de detalle paciente **\nconst[modalOpen,setModalOpen]=useState(false);const[selectedPatient,setSelectedPatient]=useState(null);const[patientInstances,setPatientInstances]=useState([]);const[notes,setNotes]=useState({});const[modalLoading,setModalLoading]=useState(false);const[modalError,setModalError]=useState(null);const navigate=useNavigate();const token=localStorage.getItem('token');const headers={'Content-Type':'application/json','x-auth-token':token};// Fetch inicial de plantillas y pacientes y assignments por plantilla\nuseEffect(()=>{if(!token){navigate('/login');setLoading(false);return;}Promise.all([fetch('/api/routines/templates',{headers}),fetch('/api/therapist/patients',{headers})]).then(async _ref=>{let[resTpl,resPat]=_ref;if(resTpl.status===401||resPat.status===401){setLoading(false);alert('Sesión expirada. Vuelve a iniciar sesión.');navigate('/login');return;}const dataTpl=await resTpl.json();const dataPat=await resPat.json();if(!Array.isArray(dataTpl)||!Array.isArray(dataPat)){throw new Error('Respuesta inesperada del servidor');}setTemplates(dataTpl);setPatients(dataPat);// obtenemos todas las instancias por plantilla\nconst resp=await Promise.all(dataTpl.map(async tpl=>{const{data:insts}=await axios.get(`/api/routines/instances/template/${tpl._id}`,{headers});return[tpl._id,insts];}));setAssignments(Object.fromEntries(resp));}).catch(err=>{console.error(err);setError(err.message);}).finally(()=>setLoading(false));},[navigate,token]);// Drag & drop...\nconst onDragStart=(e,item,type)=>{e.dataTransfer.setData('application/json',JSON.stringify({type,item}));e.dataTransfer.effectAllowed='copyMove';};const handleDrop=useCallback((e,zone)=>{e.preventDefault();const{type,item}=JSON.parse(e.dataTransfer.getData('application/json'));// ... tu lógica de eliminar/duplicar/asignar\n},[token]);const allowDrop=e=>e.preventDefault();// ** Cargar detalle de un paciente en modal **\nconst handleClickPatient=async p=>{setSelectedPatient(p);setModalError(null);setModalLoading(true);try{// traer todas las instancias de ese paciente\nconst{data:insts}=await axios.get(`/api/routines/instances/${p._id}`,{headers});const list=Array.isArray(insts)?insts:Array.isArray(insts.instances)?insts.instances:[];setPatientInstances(list);// inicializar notas por instancia y actividad\nconst initNotes={};list.forEach(inst=>{inst.template.activities.forEach((_,idx)=>{initNotes[`${inst._id}-${idx}`]='';});});setNotes(initNotes);setModalOpen(true);}catch(err){console.error(err);setModalError('No se pudo cargar el detalle del paciente');}finally{setModalLoading(false);}};// ** Toggle actividad dentro del modal **\nconst toggleActivity=async(inst,idx)=>{const key=`${inst._id}-${idx}`;const was=inst.completedActivities.includes(idx);try{await axios.post(`/api/routines/instances/${inst._id}/activities/${idx}`,{completed:!was},{headers});// actualizar en state\nsetPatientInstances(prev=>prev.map(i=>i._id!==inst._id?i:{...i,completedActivities:was?i.completedActivities.filter(n=>n!==idx):[...i.completedActivities,idx]}));}catch{alert('Error actualizando actividad');}};const handleNoteChange=(instId,idx,text)=>{setNotes(n=>({...n,[`${instId}-${idx}`]:text}));};const saveNote=(instId,idx)=>{console.log(`Nota para ${instId} act ${idx}:`,notes[`${instId}-${idx}`]);};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"tpl-container\",children:\"Cargando plantillas\\u2026\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-container\",children:[\"Error: \",error]});return/*#__PURE__*/_jsxs(\"div\",{className:\"routine-templates-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Mis Plantillas\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-new\",onClick:()=>navigate('/therapist/templates/new'),children:\"\\uD83D\\uDCC4 Nueva plantilla\"})]}),templates.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"empty-state\",children:\"\\uD83E\\uDD14 A\\xFAn no se han creado plantillas\"}):/*#__PURE__*/_jsx(\"div\",{className:\"tpl-grid\",children:templates.map(t=>/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-card\",draggable:true,onDragStart:e=>onDragStart(e,t,'template'),children:[/*#__PURE__*/_jsx(FaEdit,{className:\"icon-edit\",onClick:()=>navigate(`/therapist/templates/${t._id}/edit`)}),/*#__PURE__*/_jsx(\"h2\",{children:t.name}),/*#__PURE__*/_jsx(\"p\",{className:\"tpl-desc\",children:t.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-meta\",children:[t.activities.length,\" actividades\"]})]},t._id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"dropzones\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"dropzone trash\",onDragOver:allowDrop,onDrop:e=>handleDrop(e,'trash'),children:\"\\uD83D\\uDDD1\\uFE0F Arrastra aqu\\xED para eliminar\"}),/*#__PURE__*/_jsx(\"div\",{className:\"dropzone duplicate\",onDragOver:allowDrop,onDrop:e=>handleDrop(e,'duplicate'),children:\"\\uD83D\\uDCCB Arrastra aqu\\xED Ctrl+drag para duplicar\"})]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Pacientes\"}),/*#__PURE__*/_jsx(\"div\",{className:\"tpl-grid\",children:patients.map(p=>/*#__PURE__*/_jsxs(\"div\",{className:\"patient-card\",onDragOver:allowDrop,onDrop:e=>handleDrop(e,`assign-${p._id}`),onClick:()=>handleClickPatient(p),children:[/*#__PURE__*/_jsx(\"img\",{src:p.avatar,alt:p.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"patient-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:p.name}),/*#__PURE__*/_jsx(\"small\",{children:p.email})]})]},p._id))})]}),modalOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setModalOpen(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setModalOpen(false),children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Estado de \",selectedPatient.name]}),modalLoading&&/*#__PURE__*/_jsx(\"p\",{children:\"Cargando...\"}),modalError&&/*#__PURE__*/_jsx(\"p\",{className:\"error-msg\",children:modalError}),!modalLoading&&!modalError&&patientInstances.map(inst=>{const tpl=inst.template;const total=tpl.activities.length;const done=inst.completedActivities.length;const pct=Math.round(done/total*100);return/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-card modal-tpl-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:tpl.name}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-filled\",style:{width:`${pct}%`}})}),/*#__PURE__*/_jsxs(\"p\",{className:\"progress-text\",children:[done,\" / \",total,\" actividades (\",pct,\"%)\"]}),/*#__PURE__*/_jsx(\"ul\",{className:\"modal-activities-list\",children:tpl.activities.map((act,i)=>{const completed=inst.completedActivities.includes(i);return/*#__PURE__*/_jsxs(\"li\",{className:`modal-activity-item ${completed?'completed':''}`,children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:completed,onChange:()=>toggleActivity(inst,i)}),/*#__PURE__*/_jsx(\"span\",{children:act.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"activity-icons\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-clock-o\"}),\" \",act.minutes,\" min\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-star\"}),\" \",act.challenge]})]}),act.desc&&/*#__PURE__*/_jsx(\"p\",{className:\"activity-desc\",children:act.desc}),/*#__PURE__*/_jsx(\"textarea\",{className:\"note-box\",placeholder:\"Tus notas\\u2026\",value:notes[`${inst._id}-${i}`]||'',onChange:e=>handleNoteChange(inst._id,i,e.target.value)}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-note\",onClick:()=>saveNote(inst._id,i),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-save\"}),\" Guardar nota\"]})]},i);})})]},inst._id);})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useCallback","useNavigate","axios","FaTrash","FaEdit","jsx","_jsx","jsxs","_jsxs","RoutineTemplatesPage","templates","setTemplates","patients","setPatients","loading","setLoading","error","setError","assignments","setAssignments","modalOpen","setModalOpen","selectedPatient","setSelectedPatient","patientInstances","setPatientInstances","notes","setNotes","modalLoading","setModalLoading","modalError","setModalError","navigate","token","localStorage","getItem","headers","Promise","all","fetch","then","_ref","resTpl","resPat","status","alert","dataTpl","json","dataPat","Array","isArray","Error","resp","map","tpl","data","insts","get","_id","Object","fromEntries","catch","err","console","message","finally","onDragStart","e","item","type","dataTransfer","setData","JSON","stringify","effectAllowed","handleDrop","zone","preventDefault","parse","getData","allowDrop","handleClickPatient","p","list","instances","initNotes","forEach","inst","template","activities","_","idx","toggleActivity","key","was","completedActivities","includes","post","completed","prev","i","filter","n","handleNoteChange","instId","text","saveNote","log","className","children","onClick","length","t","draggable","name","description","onDragOver","onDrop","src","avatar","alt","email","stopPropagation","total","done","pct","Math","round","style","width","act","checked","onChange","minutes","challenge","desc","placeholder","value","target"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/TherapistTemplates.js"],"sourcesContent":["// src/pages/RoutineTemplatesPage.js\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { FaTrash, FaEdit } from 'react-icons/fa';\r\nimport '../styles/routineTemplates.css';\r\nimport './RoutineTemplatesPage.css'; // crea este fichero para los estilos del modal\r\n\r\nexport default function RoutineTemplatesPage() {\r\n  const [templates, setTemplates] = useState([]);\r\n  const [patients, setPatients] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  const [assignments, setAssignments] = useState({});\r\n\r\n  // ** Estados para el modal de detalle paciente **\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const [selectedPatient, setSelectedPatient] = useState(null);\r\n  const [patientInstances, setPatientInstances] = useState([]);\r\n  const [notes, setNotes] = useState({});\r\n  const [modalLoading, setModalLoading] = useState(false);\r\n  const [modalError, setModalError] = useState(null);\r\n\r\n  const navigate = useNavigate();\r\n  const token = localStorage.getItem('token');\r\n  const headers = {\r\n    'Content-Type': 'application/json',\r\n    'x-auth-token': token\r\n  };\r\n\r\n  // Fetch inicial de plantillas y pacientes y assignments por plantilla\r\n  useEffect(() => {\r\n    if (!token) {\r\n      navigate('/login');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    Promise.all([\r\n      fetch('/api/routines/templates', { headers }),\r\n      fetch('/api/therapist/patients', { headers })\r\n    ])\r\n      .then(async ([resTpl, resPat]) => {\r\n        if (resTpl.status === 401 || resPat.status === 401) {\r\n          setLoading(false);\r\n          alert('Sesión expirada. Vuelve a iniciar sesión.');\r\n          navigate('/login');\r\n          return;\r\n        }\r\n        const dataTpl = await resTpl.json();\r\n        const dataPat = await resPat.json();\r\n        if (!Array.isArray(dataTpl) || !Array.isArray(dataPat)) {\r\n          throw new Error('Respuesta inesperada del servidor');\r\n        }\r\n        setTemplates(dataTpl);\r\n        setPatients(dataPat);\r\n\r\n        // obtenemos todas las instancias por plantilla\r\n        const resp = await Promise.all(\r\n          dataTpl.map(async tpl => {\r\n            const { data: insts } = await axios.get(\r\n              `/api/routines/instances/template/${tpl._id}`,\r\n              { headers }\r\n            );\r\n            return [tpl._id, insts];\r\n          })\r\n        );\r\n        setAssignments(Object.fromEntries(resp));\r\n      })\r\n      .catch(err => {\r\n        console.error(err);\r\n        setError(err.message);\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }, [navigate, token]);\r\n\r\n  // Drag & drop...\r\n  const onDragStart = (e, item, type) => {\r\n    e.dataTransfer.setData('application/json', JSON.stringify({ type, item }));\r\n    e.dataTransfer.effectAllowed = 'copyMove';\r\n  };\r\n  const handleDrop = useCallback((e, zone) => {\r\n    e.preventDefault();\r\n    const { type, item } = JSON.parse(e.dataTransfer.getData('application/json'));\r\n    // ... tu lógica de eliminar/duplicar/asignar\r\n  }, [token]);\r\n\r\n  const allowDrop = e => e.preventDefault();\r\n\r\n  // ** Cargar detalle de un paciente en modal **\r\n  const handleClickPatient = async p => {\r\n    setSelectedPatient(p);\r\n    setModalError(null);\r\n    setModalLoading(true);\r\n    try {\r\n      // traer todas las instancias de ese paciente\r\n      const { data: insts } = await axios.get(\r\n        `/api/routines/instances/${p._id}`,\r\n        { headers }\r\n      );\r\n      const list = Array.isArray(insts) ? insts : Array.isArray(insts.instances) ? insts.instances : [];\r\n      setPatientInstances(list);\r\n\r\n      // inicializar notas por instancia y actividad\r\n      const initNotes = {};\r\n      list.forEach(inst => {\r\n        inst.template.activities.forEach((_, idx) => {\r\n          initNotes[`${inst._id}-${idx}`] = '';\r\n        });\r\n      });\r\n      setNotes(initNotes);\r\n\r\n      setModalOpen(true);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setModalError('No se pudo cargar el detalle del paciente');\r\n    } finally {\r\n      setModalLoading(false);\r\n    }\r\n  };\r\n\r\n  // ** Toggle actividad dentro del modal **\r\n  const toggleActivity = async (inst, idx) => {\r\n    const key = `${inst._id}-${idx}`;\r\n    const was = inst.completedActivities.includes(idx);\r\n    try {\r\n      await axios.post(\r\n        `/api/routines/instances/${inst._id}/activities/${idx}`,\r\n        { completed: !was },\r\n        { headers }\r\n      );\r\n      // actualizar en state\r\n      setPatientInstances(prev =>\r\n        prev.map(i =>\r\n          i._id !== inst._id\r\n            ? i\r\n            : {\r\n                ...i,\r\n                completedActivities: was\r\n                  ? i.completedActivities.filter(n => n !== idx)\r\n                  : [...i.completedActivities, idx]\r\n              }\r\n        )\r\n      );\r\n    } catch {\r\n      alert('Error actualizando actividad');\r\n    }\r\n  };\r\n\r\n  const handleNoteChange = (instId, idx, text) => {\r\n    setNotes(n => ({ ...n, [`${instId}-${idx}`]: text }));\r\n  };\r\n  const saveNote = (instId, idx) => {\r\n    console.log(`Nota para ${instId} act ${idx}:`, notes[`${instId}-${idx}`]);\r\n  };\r\n\r\n  if (loading) return <div className=\"tpl-container\">Cargando plantillas…</div>;\r\n  if (error) return <div className=\"tpl-container\">Error: {error}</div>;\r\n\r\n  return (\r\n    <div className=\"routine-templates-page\">\r\n      <div className=\"tpl-container\">\r\n        <div className=\"tpl-header\">\r\n          <h1>Mis Plantillas</h1>\r\n          <button className=\"btn-new\" onClick={() => navigate('/therapist/templates/new')}>\r\n            📄 Nueva plantilla\r\n          </button>\r\n        </div>\r\n\r\n        {/* grid de templates */}\r\n        {templates.length === 0 ? (\r\n          <div className=\"empty-state\">🤔 Aún no se han creado plantillas</div>\r\n        ) : (\r\n          <div className=\"tpl-grid\">\r\n            {templates.map(t => (\r\n              <div\r\n                key={t._id}\r\n                className=\"tpl-card\"\r\n                draggable\r\n                onDragStart={e => onDragStart(e, t, 'template')}\r\n              >\r\n                <FaEdit className=\"icon-edit\" onClick={() => navigate(`/therapist/templates/${t._id}/edit`)} />\r\n                <h2>{t.name}</h2>\r\n                <p className=\"tpl-desc\">{t.description}</p>\r\n                <div className=\"tpl-meta\">{t.activities.length} actividades</div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* dropzones */}\r\n        <div className=\"dropzones\">\r\n          <div className=\"dropzone trash\" onDragOver={allowDrop} onDrop={e => handleDrop(e, 'trash')}>\r\n            🗑️ Arrastra aquí para eliminar\r\n          </div>\r\n          <div className=\"dropzone duplicate\" onDragOver={allowDrop} onDrop={e => handleDrop(e, 'duplicate')}>\r\n            📋 Arrastra aquí Ctrl+drag para duplicar\r\n          </div>\r\n        </div>\r\n\r\n        {/* grid de pacientes */}\r\n        <h3>Pacientes</h3>\r\n        <div className=\"tpl-grid\">\r\n          {patients.map(p => (\r\n            <div\r\n              key={p._id}\r\n              className=\"patient-card\"\r\n              onDragOver={allowDrop}\r\n              onDrop={e => handleDrop(e, `assign-${p._id}`)}\r\n              onClick={() => handleClickPatient(p)}\r\n            >\r\n              <img src={p.avatar} alt={p.name} />\r\n              <div className=\"patient-info\">\r\n                <strong>{p.name}</strong>\r\n                <small>{p.email}</small>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modal de detalle */}\r\n      {modalOpen && (\r\n        <div className=\"modal-overlay\" onClick={() => setModalOpen(false)}>\r\n          <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n            <button className=\"modal-close\" onClick={() => setModalOpen(false)}>\r\n              &times;\r\n            </button>\r\n            <h2>Estado de {selectedPatient.name}</h2>\r\n\r\n            {modalLoading && <p>Cargando...</p>}\r\n            {modalError && <p className=\"error-msg\">{modalError}</p>}\r\n\r\n            {!modalLoading && !modalError && patientInstances.map(inst => {\r\n              const tpl = inst.template;\r\n              const total = tpl.activities.length;\r\n              const done = inst.completedActivities.length;\r\n              const pct = Math.round((done / total) * 100);\r\n              return (\r\n                <div key={inst._id} className=\"tpl-card modal-tpl-card\">\r\n                  <h3>{tpl.name}</h3>\r\n                  <div className=\"progress-bar\">\r\n                    <div className=\"progress-filled\" style={{ width: `${pct}%` }} />\r\n                  </div>\r\n                  <p className=\"progress-text\">{done} / {total} actividades ({pct}%)</p>\r\n                  <ul className=\"modal-activities-list\">\r\n                    {tpl.activities.map((act, i) => {\r\n                      const completed = inst.completedActivities.includes(i);\r\n                      return (\r\n                        <li key={i} className={`modal-activity-item ${completed ? 'completed' : ''}`}>\r\n                          <label>\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              checked={completed}\r\n                              onChange={() => toggleActivity(inst, i)}\r\n                            />\r\n                            <span>{act.name}</span>\r\n                          </label>\r\n                          <div className=\"activity-icons\">\r\n                            <span><i className=\"fa fa-clock-o\"></i> {act.minutes} min</span>\r\n                            <span><i className=\"fa fa-star\"></i> {act.challenge}</span>\r\n                          </div>\r\n                          {act.desc && <p className=\"activity-desc\">{act.desc}</p>}\r\n                          <textarea\r\n                            className=\"note-box\"\r\n                            placeholder=\"Tus notas…\"\r\n                            value={notes[`${inst._id}-${i}`] || ''}\r\n                            onChange={e => handleNoteChange(inst._id, i, e.target.value)}\r\n                          />\r\n                          <button className=\"btn-note\" onClick={() => saveNote(inst._id, i)}>\r\n                            <i className=\"fa fa-save\"></i> Guardar nota\r\n                          </button>\r\n                        </li>\r\n                      );\r\n                    })}\r\n                  </ul>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"AAAA;AAEA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CAC/D,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,OAAO,CAAEC,MAAM,KAAQ,gBAAgB,CAChD,MAAO,gCAAgC,CACvC,MAAO,4BAA4B,CAAE;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAErC,cAAe,SAAS,CAAAC,oBAAoBA,CAAA,CAAG,CAC7C,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACc,QAAQ,CAAEC,WAAW,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACgB,OAAO,CAAEC,UAAU,CAAC,CAAGjB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACkB,KAAK,CAAEC,QAAQ,CAAC,CAAGnB,QAAQ,CAAC,IAAI,CAAC,CAExC,KAAM,CAACoB,WAAW,CAAEC,cAAc,CAAC,CAAGrB,QAAQ,CAAC,CAAC,CAAC,CAAC,CAElD;AACA,KAAM,CAACsB,SAAS,CAAEC,YAAY,CAAC,CAAGvB,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACwB,eAAe,CAAEC,kBAAkB,CAAC,CAAGzB,QAAQ,CAAC,IAAI,CAAC,CAC5D,KAAM,CAAC0B,gBAAgB,CAAEC,mBAAmB,CAAC,CAAG3B,QAAQ,CAAC,EAAE,CAAC,CAC5D,KAAM,CAAC4B,KAAK,CAAEC,QAAQ,CAAC,CAAG7B,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtC,KAAM,CAAC8B,YAAY,CAAEC,eAAe,CAAC,CAAG/B,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAACgC,UAAU,CAAEC,aAAa,CAAC,CAAGjC,QAAQ,CAAC,IAAI,CAAC,CAElD,KAAM,CAAAkC,QAAQ,CAAG/B,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAgC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAC,OAAO,CAAG,CACd,cAAc,CAAE,kBAAkB,CAClC,cAAc,CAAEH,KAClB,CAAC,CAED;AACAlC,SAAS,CAAC,IAAM,CACd,GAAI,CAACkC,KAAK,CAAE,CACVD,QAAQ,CAAC,QAAQ,CAAC,CAClBjB,UAAU,CAAC,KAAK,CAAC,CACjB,OACF,CAEAsB,OAAO,CAACC,GAAG,CAAC,CACVC,KAAK,CAAC,yBAAyB,CAAE,CAAEH,OAAQ,CAAC,CAAC,CAC7CG,KAAK,CAAC,yBAAyB,CAAE,CAAEH,OAAQ,CAAC,CAAC,CAC9C,CAAC,CACCI,IAAI,CAAC,MAAAC,IAAA,EAA4B,IAArB,CAACC,MAAM,CAAEC,MAAM,CAAC,CAAAF,IAAA,CAC3B,GAAIC,MAAM,CAACE,MAAM,GAAK,GAAG,EAAID,MAAM,CAACC,MAAM,GAAK,GAAG,CAAE,CAClD7B,UAAU,CAAC,KAAK,CAAC,CACjB8B,KAAK,CAAC,2CAA2C,CAAC,CAClDb,QAAQ,CAAC,QAAQ,CAAC,CAClB,OACF,CACA,KAAM,CAAAc,OAAO,CAAG,KAAM,CAAAJ,MAAM,CAACK,IAAI,CAAC,CAAC,CACnC,KAAM,CAAAC,OAAO,CAAG,KAAM,CAAAL,MAAM,CAACI,IAAI,CAAC,CAAC,CACnC,GAAI,CAACE,KAAK,CAACC,OAAO,CAACJ,OAAO,CAAC,EAAI,CAACG,KAAK,CAACC,OAAO,CAACF,OAAO,CAAC,CAAE,CACtD,KAAM,IAAI,CAAAG,KAAK,CAAC,mCAAmC,CAAC,CACtD,CACAxC,YAAY,CAACmC,OAAO,CAAC,CACrBjC,WAAW,CAACmC,OAAO,CAAC,CAEpB;AACA,KAAM,CAAAI,IAAI,CAAG,KAAM,CAAAf,OAAO,CAACC,GAAG,CAC5BQ,OAAO,CAACO,GAAG,CAAC,KAAM,CAAAC,GAAG,EAAI,CACvB,KAAM,CAAEC,IAAI,CAAEC,KAAM,CAAC,CAAG,KAAM,CAAAtD,KAAK,CAACuD,GAAG,CACrC,oCAAoCH,GAAG,CAACI,GAAG,EAAE,CAC7C,CAAEtB,OAAQ,CACZ,CAAC,CACD,MAAO,CAACkB,GAAG,CAACI,GAAG,CAAEF,KAAK,CAAC,CACzB,CAAC,CACH,CAAC,CACDrC,cAAc,CAACwC,MAAM,CAACC,WAAW,CAACR,IAAI,CAAC,CAAC,CAC1C,CAAC,CAAC,CACDS,KAAK,CAACC,GAAG,EAAI,CACZC,OAAO,CAAC/C,KAAK,CAAC8C,GAAG,CAAC,CAClB7C,QAAQ,CAAC6C,GAAG,CAACE,OAAO,CAAC,CACvB,CAAC,CAAC,CACDC,OAAO,CAAC,IAAMlD,UAAU,CAAC,KAAK,CAAC,CAAC,CACrC,CAAC,CAAE,CAACiB,QAAQ,CAAEC,KAAK,CAAC,CAAC,CAErB;AACA,KAAM,CAAAiC,WAAW,CAAGA,CAACC,CAAC,CAAEC,IAAI,CAAEC,IAAI,GAAK,CACrCF,CAAC,CAACG,YAAY,CAACC,OAAO,CAAC,kBAAkB,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEJ,IAAI,CAAED,IAAK,CAAC,CAAC,CAAC,CAC1ED,CAAC,CAACG,YAAY,CAACI,aAAa,CAAG,UAAU,CAC3C,CAAC,CACD,KAAM,CAAAC,UAAU,CAAG3E,WAAW,CAAC,CAACmE,CAAC,CAAES,IAAI,GAAK,CAC1CT,CAAC,CAACU,cAAc,CAAC,CAAC,CAClB,KAAM,CAAER,IAAI,CAAED,IAAK,CAAC,CAAGI,IAAI,CAACM,KAAK,CAACX,CAAC,CAACG,YAAY,CAACS,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAC7E;AACF,CAAC,CAAE,CAAC9C,KAAK,CAAC,CAAC,CAEX,KAAM,CAAA+C,SAAS,CAAGb,CAAC,EAAIA,CAAC,CAACU,cAAc,CAAC,CAAC,CAEzC;AACA,KAAM,CAAAI,kBAAkB,CAAG,KAAM,CAAAC,CAAC,EAAI,CACpC3D,kBAAkB,CAAC2D,CAAC,CAAC,CACrBnD,aAAa,CAAC,IAAI,CAAC,CACnBF,eAAe,CAAC,IAAI,CAAC,CACrB,GAAI,CACF;AACA,KAAM,CAAE0B,IAAI,CAAEC,KAAM,CAAC,CAAG,KAAM,CAAAtD,KAAK,CAACuD,GAAG,CACrC,2BAA2ByB,CAAC,CAACxB,GAAG,EAAE,CAClC,CAAEtB,OAAQ,CACZ,CAAC,CACD,KAAM,CAAA+C,IAAI,CAAGlC,KAAK,CAACC,OAAO,CAACM,KAAK,CAAC,CAAGA,KAAK,CAAGP,KAAK,CAACC,OAAO,CAACM,KAAK,CAAC4B,SAAS,CAAC,CAAG5B,KAAK,CAAC4B,SAAS,CAAG,EAAE,CACjG3D,mBAAmB,CAAC0D,IAAI,CAAC,CAEzB;AACA,KAAM,CAAAE,SAAS,CAAG,CAAC,CAAC,CACpBF,IAAI,CAACG,OAAO,CAACC,IAAI,EAAI,CACnBA,IAAI,CAACC,QAAQ,CAACC,UAAU,CAACH,OAAO,CAAC,CAACI,CAAC,CAAEC,GAAG,GAAK,CAC3CN,SAAS,CAAC,GAAGE,IAAI,CAAC7B,GAAG,IAAIiC,GAAG,EAAE,CAAC,CAAG,EAAE,CACtC,CAAC,CAAC,CACJ,CAAC,CAAC,CACFhE,QAAQ,CAAC0D,SAAS,CAAC,CAEnBhE,YAAY,CAAC,IAAI,CAAC,CACpB,CAAE,MAAOyC,GAAG,CAAE,CACZC,OAAO,CAAC/C,KAAK,CAAC8C,GAAG,CAAC,CAClB/B,aAAa,CAAC,2CAA2C,CAAC,CAC5D,CAAC,OAAS,CACRF,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED;AACA,KAAM,CAAA+D,cAAc,CAAG,KAAAA,CAAOL,IAAI,CAAEI,GAAG,GAAK,CAC1C,KAAM,CAAAE,GAAG,CAAG,GAAGN,IAAI,CAAC7B,GAAG,IAAIiC,GAAG,EAAE,CAChC,KAAM,CAAAG,GAAG,CAAGP,IAAI,CAACQ,mBAAmB,CAACC,QAAQ,CAACL,GAAG,CAAC,CAClD,GAAI,CACF,KAAM,CAAAzF,KAAK,CAAC+F,IAAI,CACd,2BAA2BV,IAAI,CAAC7B,GAAG,eAAeiC,GAAG,EAAE,CACvD,CAAEO,SAAS,CAAE,CAACJ,GAAI,CAAC,CACnB,CAAE1D,OAAQ,CACZ,CAAC,CACD;AACAX,mBAAmB,CAAC0E,IAAI,EACtBA,IAAI,CAAC9C,GAAG,CAAC+C,CAAC,EACRA,CAAC,CAAC1C,GAAG,GAAK6B,IAAI,CAAC7B,GAAG,CACd0C,CAAC,CACD,CACE,GAAGA,CAAC,CACJL,mBAAmB,CAAED,GAAG,CACpBM,CAAC,CAACL,mBAAmB,CAACM,MAAM,CAACC,CAAC,EAAIA,CAAC,GAAKX,GAAG,CAAC,CAC5C,CAAC,GAAGS,CAAC,CAACL,mBAAmB,CAAEJ,GAAG,CACpC,CACN,CACF,CAAC,CACH,CAAE,KAAM,CACN9C,KAAK,CAAC,8BAA8B,CAAC,CACvC,CACF,CAAC,CAED,KAAM,CAAA0D,gBAAgB,CAAGA,CAACC,MAAM,CAAEb,GAAG,CAAEc,IAAI,GAAK,CAC9C9E,QAAQ,CAAC2E,CAAC,GAAK,CAAE,GAAGA,CAAC,CAAE,CAAC,GAAGE,MAAM,IAAIb,GAAG,EAAE,EAAGc,IAAK,CAAC,CAAC,CAAC,CACvD,CAAC,CACD,KAAM,CAAAC,QAAQ,CAAGA,CAACF,MAAM,CAAEb,GAAG,GAAK,CAChC5B,OAAO,CAAC4C,GAAG,CAAC,aAAaH,MAAM,QAAQb,GAAG,GAAG,CAAEjE,KAAK,CAAC,GAAG8E,MAAM,IAAIb,GAAG,EAAE,CAAC,CAAC,CAC3E,CAAC,CAED,GAAI7E,OAAO,CAAE,mBAAOR,IAAA,QAAKsG,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAC,2BAAoB,CAAK,CAAC,CAC7E,GAAI7F,KAAK,CAAE,mBAAOR,KAAA,QAAKoG,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAC,SAAO,CAAC7F,KAAK,EAAM,CAAC,CAErE,mBACER,KAAA,QAAKoG,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrCrG,KAAA,QAAKoG,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BrG,KAAA,QAAKoG,SAAS,CAAC,YAAY,CAAAC,QAAA,eACzBvG,IAAA,OAAAuG,QAAA,CAAI,gBAAc,CAAI,CAAC,cACvBvG,IAAA,WAAQsG,SAAS,CAAC,SAAS,CAACE,OAAO,CAAEA,CAAA,GAAM9E,QAAQ,CAAC,0BAA0B,CAAE,CAAA6E,QAAA,CAAC,8BAEjF,CAAQ,CAAC,EACN,CAAC,CAGLnG,SAAS,CAACqG,MAAM,GAAK,CAAC,cACrBzG,IAAA,QAAKsG,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,iDAAkC,CAAK,CAAC,cAErEvG,IAAA,QAAKsG,SAAS,CAAC,UAAU,CAAAC,QAAA,CACtBnG,SAAS,CAAC2C,GAAG,CAAC2D,CAAC,eACdxG,KAAA,QAEEoG,SAAS,CAAC,UAAU,CACpBK,SAAS,MACT/C,WAAW,CAAEC,CAAC,EAAID,WAAW,CAACC,CAAC,CAAE6C,CAAC,CAAE,UAAU,CAAE,CAAAH,QAAA,eAEhDvG,IAAA,CAACF,MAAM,EAACwG,SAAS,CAAC,WAAW,CAACE,OAAO,CAAEA,CAAA,GAAM9E,QAAQ,CAAC,wBAAwBgF,CAAC,CAACtD,GAAG,OAAO,CAAE,CAAE,CAAC,cAC/FpD,IAAA,OAAAuG,QAAA,CAAKG,CAAC,CAACE,IAAI,CAAK,CAAC,cACjB5G,IAAA,MAAGsG,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAEG,CAAC,CAACG,WAAW,CAAI,CAAC,cAC3C3G,KAAA,QAAKoG,SAAS,CAAC,UAAU,CAAAC,QAAA,EAAEG,CAAC,CAACvB,UAAU,CAACsB,MAAM,CAAC,cAAY,EAAK,CAAC,GAR5DC,CAAC,CAACtD,GASJ,CACN,CAAC,CACC,CACN,cAGDlD,KAAA,QAAKoG,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBvG,IAAA,QAAKsG,SAAS,CAAC,gBAAgB,CAACQ,UAAU,CAAEpC,SAAU,CAACqC,MAAM,CAAElD,CAAC,EAAIQ,UAAU,CAACR,CAAC,CAAE,OAAO,CAAE,CAAA0C,QAAA,CAAC,mDAE5F,CAAK,CAAC,cACNvG,IAAA,QAAKsG,SAAS,CAAC,oBAAoB,CAACQ,UAAU,CAAEpC,SAAU,CAACqC,MAAM,CAAElD,CAAC,EAAIQ,UAAU,CAACR,CAAC,CAAE,WAAW,CAAE,CAAA0C,QAAA,CAAC,uDAEpG,CAAK,CAAC,EACH,CAAC,cAGNvG,IAAA,OAAAuG,QAAA,CAAI,WAAS,CAAI,CAAC,cAClBvG,IAAA,QAAKsG,SAAS,CAAC,UAAU,CAAAC,QAAA,CACtBjG,QAAQ,CAACyC,GAAG,CAAC6B,CAAC,eACb1E,KAAA,QAEEoG,SAAS,CAAC,cAAc,CACxBQ,UAAU,CAAEpC,SAAU,CACtBqC,MAAM,CAAElD,CAAC,EAAIQ,UAAU,CAACR,CAAC,CAAE,UAAUe,CAAC,CAACxB,GAAG,EAAE,CAAE,CAC9CoD,OAAO,CAAEA,CAAA,GAAM7B,kBAAkB,CAACC,CAAC,CAAE,CAAA2B,QAAA,eAErCvG,IAAA,QAAKgH,GAAG,CAAEpC,CAAC,CAACqC,MAAO,CAACC,GAAG,CAAEtC,CAAC,CAACgC,IAAK,CAAE,CAAC,cACnC1G,KAAA,QAAKoG,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BvG,IAAA,WAAAuG,QAAA,CAAS3B,CAAC,CAACgC,IAAI,CAAS,CAAC,cACzB5G,IAAA,UAAAuG,QAAA,CAAQ3B,CAAC,CAACuC,KAAK,CAAQ,CAAC,EACrB,CAAC,GAVDvC,CAAC,CAACxB,GAWJ,CACN,CAAC,CACC,CAAC,EACH,CAAC,CAGLtC,SAAS,eACRd,IAAA,QAAKsG,SAAS,CAAC,eAAe,CAACE,OAAO,CAAEA,CAAA,GAAMzF,YAAY,CAAC,KAAK,CAAE,CAAAwF,QAAA,cAChErG,KAAA,QAAKoG,SAAS,CAAC,eAAe,CAACE,OAAO,CAAE3C,CAAC,EAAIA,CAAC,CAACuD,eAAe,CAAC,CAAE,CAAAb,QAAA,eAC/DvG,IAAA,WAAQsG,SAAS,CAAC,aAAa,CAACE,OAAO,CAAEA,CAAA,GAAMzF,YAAY,CAAC,KAAK,CAAE,CAAAwF,QAAA,CAAC,MAEpE,CAAQ,CAAC,cACTrG,KAAA,OAAAqG,QAAA,EAAI,YAAU,CAACvF,eAAe,CAAC4F,IAAI,EAAK,CAAC,CAExCtF,YAAY,eAAItB,IAAA,MAAAuG,QAAA,CAAG,aAAW,CAAG,CAAC,CAClC/E,UAAU,eAAIxB,IAAA,MAAGsG,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE/E,UAAU,CAAI,CAAC,CAEvD,CAACF,YAAY,EAAI,CAACE,UAAU,EAAIN,gBAAgB,CAAC6B,GAAG,CAACkC,IAAI,EAAI,CAC5D,KAAM,CAAAjC,GAAG,CAAGiC,IAAI,CAACC,QAAQ,CACzB,KAAM,CAAAmC,KAAK,CAAGrE,GAAG,CAACmC,UAAU,CAACsB,MAAM,CACnC,KAAM,CAAAa,IAAI,CAAGrC,IAAI,CAACQ,mBAAmB,CAACgB,MAAM,CAC5C,KAAM,CAAAc,GAAG,CAAGC,IAAI,CAACC,KAAK,CAAEH,IAAI,CAAGD,KAAK,CAAI,GAAG,CAAC,CAC5C,mBACEnH,KAAA,QAAoBoG,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACrDvG,IAAA,OAAAuG,QAAA,CAAKvD,GAAG,CAAC4D,IAAI,CAAK,CAAC,cACnB5G,IAAA,QAAKsG,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BvG,IAAA,QAAKsG,SAAS,CAAC,iBAAiB,CAACoB,KAAK,CAAE,CAAEC,KAAK,CAAE,GAAGJ,GAAG,GAAI,CAAE,CAAE,CAAC,CAC7D,CAAC,cACNrH,KAAA,MAAGoG,SAAS,CAAC,eAAe,CAAAC,QAAA,EAAEe,IAAI,CAAC,KAAG,CAACD,KAAK,CAAC,gBAAc,CAACE,GAAG,CAAC,IAAE,EAAG,CAAC,cACtEvH,IAAA,OAAIsG,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CAClCvD,GAAG,CAACmC,UAAU,CAACpC,GAAG,CAAC,CAAC6E,GAAG,CAAE9B,CAAC,GAAK,CAC9B,KAAM,CAAAF,SAAS,CAAGX,IAAI,CAACQ,mBAAmB,CAACC,QAAQ,CAACI,CAAC,CAAC,CACtD,mBACE5F,KAAA,OAAYoG,SAAS,CAAE,uBAAuBV,SAAS,CAAG,WAAW,CAAG,EAAE,EAAG,CAAAW,QAAA,eAC3ErG,KAAA,UAAAqG,QAAA,eACEvG,IAAA,UACE+D,IAAI,CAAC,UAAU,CACf8D,OAAO,CAAEjC,SAAU,CACnBkC,QAAQ,CAAEA,CAAA,GAAMxC,cAAc,CAACL,IAAI,CAAEa,CAAC,CAAE,CACzC,CAAC,cACF9F,IAAA,SAAAuG,QAAA,CAAOqB,GAAG,CAAChB,IAAI,CAAO,CAAC,EAClB,CAAC,cACR1G,KAAA,QAAKoG,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BrG,KAAA,SAAAqG,QAAA,eAAMvG,IAAA,MAAGsG,SAAS,CAAC,eAAe,CAAI,CAAC,IAAC,CAACsB,GAAG,CAACG,OAAO,CAAC,MAAI,EAAM,CAAC,cAChE7H,KAAA,SAAAqG,QAAA,eAAMvG,IAAA,MAAGsG,SAAS,CAAC,YAAY,CAAI,CAAC,IAAC,CAACsB,GAAG,CAACI,SAAS,EAAO,CAAC,EACxD,CAAC,CACLJ,GAAG,CAACK,IAAI,eAAIjI,IAAA,MAAGsG,SAAS,CAAC,eAAe,CAAAC,QAAA,CAAEqB,GAAG,CAACK,IAAI,CAAI,CAAC,cACxDjI,IAAA,aACEsG,SAAS,CAAC,UAAU,CACpB4B,WAAW,CAAC,iBAAY,CACxBC,KAAK,CAAE/G,KAAK,CAAC,GAAG6D,IAAI,CAAC7B,GAAG,IAAI0C,CAAC,EAAE,CAAC,EAAI,EAAG,CACvCgC,QAAQ,CAAEjE,CAAC,EAAIoC,gBAAgB,CAAChB,IAAI,CAAC7B,GAAG,CAAE0C,CAAC,CAAEjC,CAAC,CAACuE,MAAM,CAACD,KAAK,CAAE,CAC9D,CAAC,cACFjI,KAAA,WAAQoG,SAAS,CAAC,UAAU,CAACE,OAAO,CAAEA,CAAA,GAAMJ,QAAQ,CAACnB,IAAI,CAAC7B,GAAG,CAAE0C,CAAC,CAAE,CAAAS,QAAA,eAChEvG,IAAA,MAAGsG,SAAS,CAAC,YAAY,CAAI,CAAC,gBAChC,EAAQ,CAAC,GAtBFR,CAuBL,CAAC,CAET,CAAC,CAAC,CACA,CAAC,GApCGb,IAAI,CAAC7B,GAqCV,CAAC,CAEV,CAAC,CAAC,EACC,CAAC,CACH,CACN,EACE,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}