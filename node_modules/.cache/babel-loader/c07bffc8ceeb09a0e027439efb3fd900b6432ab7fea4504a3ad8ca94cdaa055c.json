{"ast":null,"code":"// src/components/PatientRoutines.js\nimport React,{useState,useEffect}from'react';import{useParams,Link}from'react-router-dom';import axios from'axios';import{ResponsiveContainer,PieChart,Pie,Cell,Tooltip,Legend,BarChart,Bar,XAxis,YAxis,CartesianGrid,RadarChart,PolarGrid,PolarAngleAxis,PolarRadiusAxis,Radar,LineChart,Line,RadialBarChart,RadialBar}from'recharts';import'../styles/therapistRoutines.css';// Fixed list of categories (in lowercase)\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ALL_CATEGORIES=['cuidado personal','actividades escolares','juego y tiempo libre','participación comunitaria','descanso y sueño'];// Map activityId ➔ category\nconst categoryMap={futbol:'juego y tiempo libre',dibujos:'juego y tiempo libre',comics:'juego y tiempo libre',tarea:'actividades escolares',videojuegos:'juego y tiempo libre',helado:'juego y tiempo libre',parque:'participación comunitaria',banio:'cuidado personal',dormir:'descanso y sueño',musica:'juego y tiempo libre',bailar:'juego y tiempo libre',amigos:'participación comunitaria',bicicleta:'juego y tiempo libre',dibujar:'juego y tiempo libre',mascotas:'juego y tiempo libre',experimentos:'actividades escolares',cantar:'juego y tiempo libre',lego:'juego y tiempo libre',nadar:'cuidado personal',computadora:'juego y tiempo libre'};export default function PatientRoutines(){const{patientId}=useParams();const[results,setResults]=useState([]);const[filtered,setFiltered]=useState([]);const[from,setFrom]=useState('');const[to,setTo]=useState('');const[selected,setSelected]=useState(null);const[metrics,setMetrics]=useState(null);const[multi,setMulti]=useState(null);const[wedRecord,setWedRecord]=useState(null);const[satRecord,setSatRecord]=useState(null);const[comparisonData,setComparisonData]=useState([]);// Fetch all game results for patient\nuseEffect(()=>{const token=localStorage.getItem('token');axios.get(`/api/game?patientId=${patientId}`,{headers:{'x-auth-token':token}}).then(_ref=>{let{data}=_ref;setResults(data);const now=new Date();const weekAgo=new Date(now);weekAgo.setDate(now.getDate()-6);setFrom(weekAgo.toISOString().slice(0,10));setTo(now.toISOString().slice(0,10));}).catch(console.error);},[patientId]);// Filter results by date range\nuseEffect(()=>{if(!from||!to)return;const f=new Date(from),t=new Date(to);t.setHours(23,59,59,999);const filt=results.filter(r=>{const d=new Date(r.createdAt);return d>=f&&d<=t;});setFiltered(filt);setWedRecord(filt.find(r=>r.day==='Miércoles')||null);setSatRecord(filt.find(r=>r.day==='Sábado')||null);},[results,from,to]);// Default select first available day\nuseEffect(()=>{setSelected(filtered.length?filtered[0].createdAt:null);},[filtered]);// Compute metrics for selected day\nuseEffect(()=>{if(!selected)return;const res=filtered.find(r=>r.createdAt===selected);if(!res)return;const slots=res.timeSlots||[];const acts=slots.flatMap(s=>s.activities||[]);const totalMin=acts.reduce((sum,a)=>sum+a.duration,0)||1;// Sum minutes per category\nconst catSum={};ALL_CATEGORIES.forEach(cat=>catSum[cat]=0);acts.forEach(a=>{const cat=categoryMap[a.activityId];if(cat)catSum[cat]+=a.duration;});// Distribution % by category\nconst distribution=ALL_CATEGORIES.map(name=>({name,value:+(catSum[name]/totalMin*100||0).toFixed(1)}));// Hours by category\nconst hours=ALL_CATEGORIES.map(name=>({name,hours:+(catSum[name]/60).toFixed(2)}));// Diversity (# unique activities)\nconst diversity=new Set(acts.map(a=>a.activityId)).size;// Consistency (% slots occupied)\nconst occupiedSlots=slots.filter(s=>{var _s$activities;return((_s$activities=s.activities)===null||_s$activities===void 0?void 0:_s$activities.length)>0;}).length;const consistency=+(occupiedSlots/24*100).toFixed(1);// Fragmentation index: count category transitions between consecutive hours\nconst fragmentation=slots.reduce((acc,slot,idx,arr)=>{var _prev$activities,_slot$activities;if(idx===0)return acc;const prev=arr[idx-1];const prevAct=(_prev$activities=prev.activities)===null||_prev$activities===void 0?void 0:_prev$activities[0];const currAct=(_slot$activities=slot.activities)===null||_slot$activities===void 0?void 0:_slot$activities[0];const prevCat=prevAct?categoryMap[prevAct.activityId]:null;const currCat=currAct?categoryMap[currAct.activityId]:null;if(prevCat&&currCat&&prevCat!==currCat){return acc+1;}return acc;},0);// Balance index (inverse entropy-like)\nconst N=distribution.length;const uniform=100/N;const distDiff=distribution.reduce((acc,d)=>acc+Math.abs(d.value-uniform),0)/2;const balanceIndex=+((100-distDiff)/100*100).toFixed(1);// Top 3 activities by time\nconst actSum={};acts.forEach(a=>{actSum[a.activityId]=(actSum[a.activityId]||0)+a.duration;});const top3=Object.entries(actSum).sort((a,b)=>b[1]-a[1]).slice(0,3).map(_ref2=>{let[id,val]=_ref2;return{name:id,hours:+(val/60).toFixed(2)};});// Sleep hours\nconst sleepHours=+(catSum['descanso y sueño']/60).toFixed(2);setMetrics({distribution,hours,diversity,consistency,fragmentation,groupBalance:distribution,balanceIndex,top3,sleepHours});},[selected,filtered]);// Compute multi-day metrics\nuseEffect(()=>{if(!filtered.length){setMulti(null);return;}const sleepData=filtered.map(r=>{const date=new Date(r.createdAt).toLocaleDateString();const sleepMin=r.timeSlots.reduce((sum,slot)=>{var _slot$activities2;const e=(_slot$activities2=slot.activities)===null||_slot$activities2===void 0?void 0:_slot$activities2.find(a=>a.activityId==='dormir');return sum+(e?e.duration:0);},0);return{date,hours:+(sleepMin/60).toFixed(2)};});const dayPercents=filtered.map(r=>{const acts=r.timeSlots.flatMap(s=>s.activities||[]);const total=acts.reduce((sum,a)=>sum+a.duration,0)||1;const sums={};ALL_CATEGORIES.forEach(cat=>sums[cat]=0);acts.forEach(a=>{const cat=categoryMap[a.activityId];if(cat)sums[cat]+=a.duration;});return ALL_CATEGORIES.reduce((obj,cat)=>{obj[cat]=+(sums[cat]/total*100).toFixed(1);return obj;},{});});const categoryVariance=ALL_CATEGORIES.map(cat=>{const vals=dayPercents.map(d=>d[cat]);const mean=vals.reduce((a,b)=>a+b,0)/vals.length;const varr=vals.reduce((acc,v)=>acc+(v-mean)**2,0)/vals.length;return{category:cat,variance:+varr.toFixed(2)};});setMulti({sleepData,categoryVariance});},[filtered]);// Prepare comparison data when both days present\nuseEffect(()=>{if(wedRecord&&satRecord){const computeHours=rec=>{const catSum={};ALL_CATEGORIES.forEach(cat=>catSum[cat]=0);rec.timeSlots.flatMap(s=>s.activities||[]).forEach(a=>{const cat=categoryMap[a.activityId];if(cat)catSum[cat]+=a.duration;});return ALL_CATEGORIES.map(name=>({category:name,Wed:+(catSum[name]/60).toFixed(2),Sat:0}));};const wedHours=computeHours(wedRecord);const satSum={};ALL_CATEGORIES.forEach(cat=>satSum[cat]=0);satRecord.timeSlots.flatMap(s=>s.activities||[]).forEach(a=>{const cat=categoryMap[a.activityId];if(cat)satSum[cat]+=a.duration;});const data=wedHours.map(item=>({category:item.category,Wed:item.Wed,Sat:+(satSum[item.category]/60).toFixed(2)}));setComparisonData(data);}else{setComparisonData([]);}},[wedRecord,satRecord]);return/*#__PURE__*/_jsxs(\"div\",{className:\"routines-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"routines-header\",children:[/*#__PURE__*/_jsx(Link,{to:\"/therapist/routines\",children:\"\\u2190 Volver\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Estad\\xEDsticas de Rutinas\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"filter-section\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Desde:\",/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:from,onChange:e=>setFrom(e.target.value)})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Hasta:\",/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:to,onChange:e=>setTo(e.target.value)})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"D\\xEDa:\",/*#__PURE__*/_jsx(\"select\",{value:selected||'',onChange:e=>setSelected(e.target.value),children:filtered.map(r=>{const d=new Date(r.createdAt).toLocaleDateString();return/*#__PURE__*/_jsx(\"option\",{value:r.createdAt,children:d},r.createdAt);})})]})]}),metrics&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"metrics-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Diversidad: \",/*#__PURE__*/_jsx(\"strong\",{children:metrics.diversity})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-info-circle info-icon\",title:\"N\\xFAmero de actividades distintas realizadas en el d\\xEDa.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Consistencia: \",/*#__PURE__*/_jsxs(\"strong\",{children:[metrics.consistency,\"%\"]})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-info-circle info-icon\",title:\"Porcentaje de franjas horarias ocupadas.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Fragmentaci\\xF3n: \",/*#__PURE__*/_jsx(\"strong\",{children:metrics.fragmentation})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-info-circle info-icon\",title:\"N\\xFAmero de cambios de categor\\xEDa entre horas consecutivas.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Equilibrio: \",/*#__PURE__*/_jsxs(\"strong\",{children:[metrics.balanceIndex,\"%\"]})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-info-circle info-icon\",title:\"Equilibrio relativo entre categor\\xEDas.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Sue\\xF1o (h): \",/*#__PURE__*/_jsx(\"strong\",{children:metrics.sleepHours})]}),/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-info-circle info-icon\",title:\"Horas dedicadas a descanso y sue\\xF1o.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"charts-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\xCDndice de Fragmentaci\\xF3n Ocupacional\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Mide cu\\xE1ntas veces cambiaste de categor\\xEDa de actividad entre horas consecutivas.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:200,children:/*#__PURE__*/_jsxs(RadialBarChart,{cx:\"50%\",cy:\"90%\",innerRadius:\"75%\",outerRadius:\"100%\",barSize:15,data:[{name:'Fragmentación',value:metrics.fragmentation}],startAngle:180,endAngle:0,children:[/*#__PURE__*/_jsx(RadialBar,{minAngle:15,background:true,clockWise:true,dataKey:\"value\",label:{position:'center',fill:'#333',fontSize:24,formatter:()=>`${metrics.fragmentation}`}}),/*#__PURE__*/_jsx(Tooltip,{formatter:val=>[`${val}`,'Fragmentación']})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Distribuci\\xF3n % por Categor\\xEDa\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Porcentaje de tiempo invertido en cada categor\\xEDa.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(PieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:metrics.distribution,dataKey:\"value\",nameKey:\"name\",outerRadius:80,label:true,children:metrics.distribution.map((_,i)=>/*#__PURE__*/_jsx(Cell,{fill:['#8884d8','#82ca9d','#ffc658','#ff8042','#0088FE'][i%5]},i))}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Horas por Categor\\xEDa\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Transforma minutos a horas por categor\\xEDa.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(BarChart,{data:metrics.hours,margin:{top:20,right:30,left:0,bottom:0},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"hours\",fill:\"#8884d8\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Balance de Categor\\xEDas\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Radar de distribuci\\xF3n porcentual.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(RadarChart,{data:metrics.groupBalance,cx:\"50%\",cy:\"50%\",outerRadius:80,children:[/*#__PURE__*/_jsx(PolarGrid,{}),/*#__PURE__*/_jsx(PolarAngleAxis,{dataKey:\"name\"}),/*#__PURE__*/_jsx(PolarRadiusAxis,{domain:[0,100]}),/*#__PURE__*/_jsx(Radar,{dataKey:\"value\",stroke:\"#82ca9d\",fill:\"#82ca9d\",fillOpacity:0.6}),/*#__PURE__*/_jsx(Tooltip,{})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\xCDndice de Fragmentaci\\xF3n\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Mide los cambios de categor\\xEDa entre horas consecutivas.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(RadialBarChart,{cx:\"50%\",cy:\"50%\",innerRadius:\"80%\",outerRadius:\"100%\",barSize:15,data:[{name:'Fragmentación',value:metrics.fragmentation}],startAngle:180,endAngle:-180,children:[/*#__PURE__*/_jsx(RadialBar,{minAngle:15,background:true,clockWise:true,dataKey:\"value\",fill:\"#ff6347\"}),/*#__PURE__*/_jsx(Legend,{iconSize:8,layout:\"vertical\",verticalAlign:\"middle\",align:\"right\"}),/*#__PURE__*/_jsx(Tooltip,{})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block full-width\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Top 3 Actividades\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Actividades con m\\xE1s tiempo dedicado.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:200,children:/*#__PURE__*/_jsxs(BarChart,{data:metrics.top3,layout:\"vertical\",margin:{top:10,right:30,left:50,bottom:5},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{type:\"number\"}),/*#__PURE__*/_jsx(YAxis,{dataKey:\"name\",type:\"category\"}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"hours\",fill:\"#ffc658\"})]})})]})]})]}),multi&&/*#__PURE__*/_jsxs(\"div\",{className:\"charts-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Tendencia de Sue\\xF1o\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Evoluci\\xF3n diaria de horas de sue\\xF1o.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:200,children:/*#__PURE__*/_jsxs(LineChart,{data:multi.sleepData,margin:{top:10,right:30,left:0,bottom:0},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Line,{type:\"monotone\",dataKey:\"hours\",stroke:\"#8884d8\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Variabilidad por Categor\\xEDa\"}),/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Varianza diaria de la distribuci\\xF3n.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:200,children:/*#__PURE__*/_jsxs(BarChart,{data:multi.categoryVariance,margin:{top:20,right:30,left:0,bottom:0},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"category\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"variance\",fill:\"#ff8042\"})]})})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"chart-block full-width\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Comparativa Mi\\xE9rcoles vs S\\xE1bado\"}),!wedRecord&&/*#__PURE__*/_jsxs(\"p\",{children:[\"No se ha completado la rutina de \",/*#__PURE__*/_jsx(\"strong\",{children:\"Mi\\xE9rcoles\"}),\".\"]}),!satRecord&&/*#__PURE__*/_jsxs(\"p\",{children:[\"No se ha completado la rutina de \",/*#__PURE__*/_jsx(\"strong\",{children:\"S\\xE1bado\"}),\".\"]}),comparisonData.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"chart-description\",children:\"Horas dedicadas por categor\\xEDa en ambos d\\xEDas. Permite identificar sesgos en la planificaci\\xF3n semanal.\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(BarChart,{data:comparisonData,margin:{top:20,right:30,left:0,bottom:5},children:[/*#__PURE__*/_jsx(CartesianGrid,{strokeDasharray:\"3 3\"}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"category\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"Wed\",name:\"Mi\\xE9rcoles\",fill:\"#82ca9d\"}),/*#__PURE__*/_jsx(Bar,{dataKey:\"Sat\",name:\"S\\xE1bado\",fill:\"#8884d8\"})]})})]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","axios","ResponsiveContainer","PieChart","Pie","Cell","Tooltip","Legend","BarChart","Bar","XAxis","YAxis","CartesianGrid","RadarChart","PolarGrid","PolarAngleAxis","PolarRadiusAxis","Radar","LineChart","Line","RadialBarChart","RadialBar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ALL_CATEGORIES","categoryMap","futbol","dibujos","comics","tarea","videojuegos","helado","parque","banio","dormir","musica","bailar","amigos","bicicleta","dibujar","mascotas","experimentos","cantar","lego","nadar","computadora","PatientRoutines","patientId","results","setResults","filtered","setFiltered","from","setFrom","to","setTo","selected","setSelected","metrics","setMetrics","multi","setMulti","wedRecord","setWedRecord","satRecord","setSatRecord","comparisonData","setComparisonData","token","localStorage","getItem","get","headers","then","_ref","data","now","Date","weekAgo","setDate","getDate","toISOString","slice","catch","console","error","f","t","setHours","filt","filter","r","d","createdAt","find","day","length","res","slots","timeSlots","acts","flatMap","s","activities","totalMin","reduce","sum","a","duration","catSum","forEach","cat","activityId","distribution","map","name","value","toFixed","hours","diversity","Set","size","occupiedSlots","_s$activities","consistency","fragmentation","acc","slot","idx","arr","_prev$activities","_slot$activities","prev","prevAct","currAct","prevCat","currCat","N","uniform","distDiff","Math","abs","balanceIndex","actSum","top3","Object","entries","sort","b","_ref2","id","val","sleepHours","groupBalance","sleepData","date","toLocaleDateString","sleepMin","_slot$activities2","e","dayPercents","total","sums","obj","categoryVariance","vals","mean","varr","v","category","variance","computeHours","rec","Wed","Sat","wedHours","satSum","item","className","children","type","onChange","target","title","width","height","cx","cy","innerRadius","outerRadius","barSize","startAngle","endAngle","minAngle","background","clockWise","dataKey","label","position","fill","fontSize","formatter","nameKey","_","i","margin","top","right","left","bottom","strokeDasharray","domain","stroke","fillOpacity","iconSize","layout","verticalAlign","align"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/PatientRoutines.js"],"sourcesContent":["// src/components/PatientRoutines.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport {\r\n  ResponsiveContainer,\r\n  PieChart, Pie, Cell, Tooltip, Legend,\r\n  BarChart, Bar, XAxis, YAxis, CartesianGrid,\r\n  RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar,\r\n  LineChart, Line,\r\n  RadialBarChart, RadialBar\r\n} from 'recharts';\r\nimport '../styles/therapistRoutines.css';\r\n\r\n// Fixed list of categories (in lowercase)\r\nconst ALL_CATEGORIES = [\r\n  'cuidado personal',\r\n  'actividades escolares',\r\n  'juego y tiempo libre',\r\n  'participación comunitaria',\r\n  'descanso y sueño'\r\n];\r\n\r\n// Map activityId ➔ category\r\nconst categoryMap = {\r\n  futbol: 'juego y tiempo libre',\r\n  dibujos: 'juego y tiempo libre',\r\n  comics: 'juego y tiempo libre',\r\n  tarea: 'actividades escolares',\r\n  videojuegos: 'juego y tiempo libre',\r\n  helado: 'juego y tiempo libre',\r\n  parque: 'participación comunitaria',\r\n  banio: 'cuidado personal',\r\n  dormir: 'descanso y sueño',\r\n  musica: 'juego y tiempo libre',\r\n  bailar: 'juego y tiempo libre',\r\n  amigos: 'participación comunitaria',\r\n  bicicleta: 'juego y tiempo libre',\r\n  dibujar: 'juego y tiempo libre',\r\n  mascotas: 'juego y tiempo libre',\r\n  experimentos: 'actividades escolares',\r\n  cantar: 'juego y tiempo libre',\r\n  lego: 'juego y tiempo libre',\r\n  nadar: 'cuidado personal',\r\n  computadora: 'juego y tiempo libre'\r\n};\r\n\r\nexport default function PatientRoutines() {\r\n  const { patientId } = useParams();\r\n  const [results, setResults] = useState([]);\r\n  const [filtered, setFiltered] = useState([]);\r\n  const [from, setFrom] = useState('');\r\n  const [to, setTo] = useState('');\r\n  const [selected, setSelected] = useState(null);\r\n  const [metrics, setMetrics] = useState(null);\r\n  const [multi, setMulti] = useState(null);\r\n  const [wedRecord, setWedRecord] = useState(null);\r\n  const [satRecord, setSatRecord] = useState(null);\r\n  const [comparisonData, setComparisonData] = useState([]);\r\n\r\n  // Fetch all game results for patient\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    axios.get(`/api/game?patientId=${patientId}`, {\r\n      headers: { 'x-auth-token': token }\r\n    }).then(({ data }) => {\r\n      setResults(data);\r\n      const now = new Date();\r\n      const weekAgo = new Date(now);\r\n      weekAgo.setDate(now.getDate() - 6);\r\n      setFrom(weekAgo.toISOString().slice(0,10));\r\n      setTo( now.toISOString().slice(0,10) );\r\n    }).catch(console.error);\r\n  }, [patientId]);\r\n\r\n  // Filter results by date range\r\n  useEffect(() => {\r\n    if (!from || !to) return;\r\n    const f = new Date(from), t = new Date(to);\r\n    t.setHours(23,59,59,999);\r\n    const filt = results.filter(r => {\r\n      const d = new Date(r.createdAt);\r\n      return d >= f && d <= t;\r\n    });\r\n    setFiltered(filt);\r\n    setWedRecord(filt.find(r => r.day === 'Miércoles') || null);\r\n    setSatRecord(filt.find(r => r.day === 'Sábado') || null);\r\n  }, [results, from, to]);\r\n\r\n  // Default select first available day\r\n  useEffect(() => {\r\n    setSelected(filtered.length ? filtered[0].createdAt : null);\r\n  }, [filtered]);\r\n\r\n  // Compute metrics for selected day\r\n  useEffect(() => {\r\n    if (!selected) return;\r\n    const res = filtered.find(r => r.createdAt === selected);\r\n    if (!res) return;\r\n    const slots = res.timeSlots || [];\r\n    const acts = slots.flatMap(s => s.activities || []);\r\n    const totalMin = acts.reduce((sum,a) => sum + a.duration, 0) || 1;\r\n\r\n    // Sum minutes per category\r\n    const catSum = {};\r\n    ALL_CATEGORIES.forEach(cat => catSum[cat] = 0);\r\n    acts.forEach(a => {\r\n      const cat = categoryMap[a.activityId];\r\n      if (cat) catSum[cat] += a.duration;\r\n    });\r\n\r\n    // Distribution % by category\r\n    const distribution = ALL_CATEGORIES.map(name => ({\r\n      name,\r\n      value: +((catSum[name] / totalMin * 100) || 0).toFixed(1)\r\n    }));\r\n\r\n    // Hours by category\r\n    const hours = ALL_CATEGORIES.map(name => ({\r\n      name,\r\n      hours: +(catSum[name] / 60).toFixed(2)\r\n    }));\r\n\r\n    // Diversity (# unique activities)\r\n    const diversity = new Set(acts.map(a => a.activityId)).size;\r\n\r\n    // Consistency (% slots occupied)\r\n    const occupiedSlots = slots.filter(s => s.activities?.length > 0).length;\r\n    const consistency = +((occupiedSlots / 24 * 100).toFixed(1));\r\n\r\n    // Fragmentation index: count category transitions between consecutive hours\r\n    const fragmentation = slots.reduce((acc, slot, idx, arr) => {\r\n      if (idx === 0) return acc;\r\n      const prev = arr[idx - 1];\r\n      const prevAct = prev.activities?.[0];\r\n      const currAct = slot.activities?.[0];\r\n      const prevCat = prevAct ? categoryMap[prevAct.activityId] : null;\r\n      const currCat = currAct ? categoryMap[currAct.activityId] : null;\r\n      if (prevCat && currCat && prevCat !== currCat) {\r\n        return acc + 1;\r\n      }\r\n      return acc;\r\n    }, 0);\r\n\r\n    // Balance index (inverse entropy-like)\r\n    const N = distribution.length;\r\n    const uniform = 100 / N;\r\n    const distDiff = distribution.reduce((acc,d) =>\r\n      acc + Math.abs(d.value - uniform), 0) / 2;\r\n    const balanceIndex = +((100 - distDiff) / 100 * 100).toFixed(1);\r\n\r\n    // Top 3 activities by time\r\n    const actSum = {};\r\n    acts.forEach(a => {\r\n      actSum[a.activityId] = (actSum[a.activityId]||0) + a.duration;\r\n    });\r\n    const top3 = Object.entries(actSum)\r\n      .sort((a,b) => b[1] - a[1]).slice(0,3)\r\n      .map(([id,val]) => ({ name: id, hours: +(val/60).toFixed(2) }));\r\n\r\n    // Sleep hours\r\n    const sleepHours = +(catSum['descanso y sueño'] / 60).toFixed(2);\r\n\r\n    setMetrics({\r\n      distribution,\r\n      hours,\r\n      diversity,\r\n      consistency,\r\n      fragmentation,\r\n      groupBalance: distribution,\r\n      balanceIndex,\r\n      top3,\r\n      sleepHours\r\n    });\r\n  }, [selected, filtered]);\r\n\r\n  // Compute multi-day metrics\r\n  useEffect(() => {\r\n    if (!filtered.length) {\r\n      setMulti(null);\r\n      return;\r\n    }\r\n    const sleepData = filtered.map(r => {\r\n      const date = new Date(r.createdAt).toLocaleDateString();\r\n      const sleepMin = r.timeSlots.reduce((sum, slot) => {\r\n        const e = slot.activities?.find(a => a.activityId === 'dormir');\r\n        return sum + (e ? e.duration : 0);\r\n      }, 0);\r\n      return { date, hours: +(sleepMin/60).toFixed(2) };\r\n    });\r\n    const dayPercents = filtered.map(r => {\r\n      const acts = r.timeSlots.flatMap(s => s.activities || []);\r\n      const total = acts.reduce((sum,a)=>sum+a.duration,0)||1;\r\n      const sums = {}; ALL_CATEGORIES.forEach(cat => sums[cat]=0);\r\n      acts.forEach(a => {\r\n        const cat = categoryMap[a.activityId];\r\n        if (cat) sums[cat] += a.duration;\r\n      });\r\n      return ALL_CATEGORIES.reduce((obj,cat) => {\r\n        obj[cat] = +(sums[cat]/total*100).toFixed(1);\r\n        return obj;\r\n      }, {});\r\n    });\r\n    const categoryVariance = ALL_CATEGORIES.map(cat => {\r\n      const vals = dayPercents.map(d => d[cat]);\r\n      const mean = vals.reduce((a,b)=>a+b,0)/vals.length;\r\n      const varr = vals.reduce((acc,v)=>acc+(v-mean)**2,0)/vals.length;\r\n      return { category: cat, variance: +varr.toFixed(2) };\r\n    });\r\n    setMulti({ sleepData, categoryVariance });\r\n  }, [filtered]);\r\n\r\n  // Prepare comparison data when both days present\r\n  useEffect(() => {\r\n    if (wedRecord && satRecord) {\r\n      const computeHours = rec => {\r\n        const catSum = {};\r\n        ALL_CATEGORIES.forEach(cat => catSum[cat] = 0);\r\n        rec.timeSlots.flatMap(s => s.activities||[]).forEach(a => {\r\n          const cat = categoryMap[a.activityId];\r\n          if (cat) catSum[cat] += a.duration;\r\n        });\r\n        return ALL_CATEGORIES.map(name => ({\r\n          category: name,\r\n          Wed: +(catSum[name]/60).toFixed(2),\r\n          Sat: 0\r\n        }));\r\n      };\r\n      const wedHours = computeHours(wedRecord);\r\n      const satSum = {};\r\n      ALL_CATEGORIES.forEach(cat => satSum[cat] = 0);\r\n      satRecord.timeSlots.flatMap(s => s.activities||[]).forEach(a => {\r\n        const cat = categoryMap[a.activityId];\r\n        if (cat) satSum[cat] += a.duration;\r\n      });\r\n      const data = wedHours.map(item => ({\r\n        category: item.category,\r\n        Wed: item.Wed,\r\n        Sat: +(satSum[item.category]/60).toFixed(2)\r\n      }));\r\n      setComparisonData(data);\r\n    } else {\r\n      setComparisonData([]);\r\n    }\r\n  }, [wedRecord, satRecord]);\r\n\r\n  return (\r\n    <div className=\"routines-container\">\r\n      <header className=\"routines-header\">\r\n        <Link to=\"/therapist/routines\">← Volver</Link>\r\n        <h2>Estadísticas de Rutinas</h2>\r\n      </header>\r\n\r\n      <section className=\"filter-section\">\r\n        <label>Desde:<input type=\"date\" value={from} onChange={e=>setFrom(e.target.value)} /></label>\r\n        <label>Hasta:<input type=\"date\" value={to} onChange={e=>setTo(e.target.value)} /></label>\r\n        <label>Día:\r\n          <select value={selected||''} onChange={e=>setSelected(e.target.value)}>\r\n            {filtered.map(r => {\r\n              const d = new Date(r.createdAt).toLocaleDateString();\r\n              return <option key={r.createdAt} value={r.createdAt}>{d}</option>;\r\n            })}\r\n          </select>\r\n        </label>\r\n      </section>\r\n\r\n      {metrics && (\r\n        <>\r\n          <div className=\"metrics-grid\">\r\n            <div className=\"metric-card\">\r\n              <span>Diversidad: <strong>{metrics.diversity}</strong></span>\r\n              <i className=\"fa fa-info-circle info-icon\" title=\"Número de actividades distintas realizadas en el día.\"></i>\r\n            </div>\r\n            <div className=\"metric-card\">\r\n              <span>Consistencia: <strong>{metrics.consistency}%</strong></span>\r\n              <i className=\"fa fa-info-circle info-icon\" title=\"Porcentaje de franjas horarias ocupadas.\"></i>\r\n            </div>\r\n            <div className=\"metric-card\">\r\n              <span>Fragmentación: <strong>{metrics.fragmentation}</strong></span>\r\n              <i className=\"fa fa-info-circle info-icon\" title=\"Número de cambios de categoría entre horas consecutivas.\"></i>\r\n            </div>\r\n            <div className=\"metric-card\">\r\n              <span>Equilibrio: <strong>{metrics.balanceIndex}%</strong></span>\r\n              <i className=\"fa fa-info-circle info-icon\" title=\"Equilibrio relativo entre categorías.\"></i>\r\n            </div>\r\n            <div className=\"metric-card\">\r\n              <span>Sueño (h): <strong>{metrics.sleepHours}</strong></span>\r\n              <i className=\"fa fa-info-circle info-icon\" title=\"Horas dedicadas a descanso y sueño.\"></i>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"charts-grid\">\r\n\r\n          <div className=\"chart-block\">\r\n              <h3>Índice de Fragmentación Ocupacional</h3>\r\n              <p className=\"chart-description\">\r\n                Mide cuántas veces cambiaste de categoría de actividad entre horas consecutivas.\r\n              </p>\r\n              <ResponsiveContainer width=\"100%\" height={200}>\r\n                <RadialBarChart\r\n                  cx=\"50%\" cy=\"90%\"\r\n                  innerRadius=\"75%\" outerRadius=\"100%\"\r\n                  barSize={15}\r\n                  data={[{ name: 'Fragmentación', value: metrics.fragmentation }]}\r\n                  startAngle={180} endAngle={0}\r\n                >\r\n                  <RadialBar\r\n                    minAngle={15}\r\n                    background\r\n                    clockWise\r\n                    dataKey=\"value\"\r\n                    label={{\r\n                      position: 'center',\r\n                      fill: '#333',\r\n                      fontSize: 24,\r\n                      formatter: () => `${metrics.fragmentation}`\r\n                    }}\r\n                  />\r\n                  <Tooltip formatter={val => [`${val}`, 'Fragmentación']} />\r\n                </RadialBarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n            \r\n            {/* Distribución % */}\r\n            <div className=\"chart-block\">\r\n              <h3>Distribución % por Categoría</h3>\r\n              <p className=\"chart-description\">Porcentaje de tiempo invertido en cada categoría.</p>\r\n              <ResponsiveContainer width=\"100%\" height={250}>\r\n                <PieChart>\r\n                  <Pie\r\n                    data={metrics.distribution}\r\n                    dataKey=\"value\"\r\n                    nameKey=\"name\"\r\n                    outerRadius={80}\r\n                    label\r\n                  >\r\n                    {metrics.distribution.map((_,i) =>\r\n                      <Cell key={i} fill={['#8884d8','#82ca9d','#ffc658','#ff8042','#0088FE'][i%5]} />\r\n                    )}\r\n                  </Pie>\r\n                  <Tooltip /><Legend />\r\n                </PieChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Horas */}\r\n            <div className=\"chart-block\">\r\n              <h3>Horas por Categoría</h3>\r\n              <p className=\"chart-description\">Transforma minutos a horas por categoría.</p>\r\n              <ResponsiveContainer width=\"100%\" height={250}>\r\n                <BarChart data={metrics.hours} margin={{ top:20,right:30,left:0,bottom:0 }}>\r\n                  <CartesianGrid strokeDasharray=\"3 3\" />\r\n                  <XAxis dataKey=\"name\" />\r\n                  <YAxis />\r\n                  <Tooltip />\r\n                  <Bar dataKey=\"hours\" fill=\"#8884d8\" />\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Radar */}\r\n            <div className=\"chart-block\">\r\n              <h3>Balance de Categorías</h3>\r\n              <p className=\"chart-description\">Radar de distribución porcentual.</p>\r\n              <ResponsiveContainer width=\"100%\" height={250}>\r\n                <RadarChart data={metrics.groupBalance} cx=\"50%\" cy=\"50%\" outerRadius={80}>\r\n                  <PolarGrid />\r\n                  <PolarAngleAxis dataKey=\"name\" />\r\n                  <PolarRadiusAxis domain={[0,100]} />\r\n                  <Radar dataKey=\"value\" stroke=\"#82ca9d\" fill=\"#82ca9d\" fillOpacity={0.6}/>\r\n                  <Tooltip />\r\n                </RadarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Fragmentación (Gauge) */}\r\n            <div className=\"chart-block\">\r\n              <h3>Índice de Fragmentación</h3>\r\n              <p className=\"chart-description\">Mide los cambios de categoría entre horas consecutivas.</p>\r\n              <ResponsiveContainer width=\"100%\" height={250}>\r\n                <RadialBarChart\r\n                  cx=\"50%\" cy=\"50%\"\r\n                  innerRadius=\"80%\" outerRadius=\"100%\"\r\n                  barSize={15}\r\n                  data={[{ name: 'Fragmentación', value: metrics.fragmentation }]}\r\n                  startAngle={180}\r\n                  endAngle={-180}\r\n                >\r\n                  <RadialBar\r\n                    minAngle={15}\r\n                    background\r\n                    clockWise\r\n                    dataKey=\"value\"\r\n                    fill=\"#ff6347\"\r\n                  />\r\n                  <Legend iconSize={8} layout=\"vertical\" verticalAlign=\"middle\" align=\"right\" />\r\n                  <Tooltip />\r\n                </RadialBarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n\r\n            {/* Top 3 Actividades (full-width) */}\r\n            <div className=\"chart-block full-width\">\r\n              <h3>Top 3 Actividades</h3>\r\n              <p className=\"chart-description\">Actividades con más tiempo dedicado.</p>\r\n              <ResponsiveContainer width=\"100%\" height={200}>\r\n                <BarChart data={metrics.top3} layout=\"vertical\" margin={{ top:10,right:30,left:50,bottom:5 }}>\r\n                  <CartesianGrid strokeDasharray=\"3 3\"/>\r\n                  <XAxis type=\"number\"/>\r\n                  <YAxis dataKey=\"name\" type=\"category\"/>\r\n                  <Tooltip/>\r\n                  <Bar dataKey=\"hours\" fill=\"#ffc658\" />\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Multi-day metrics */}\r\n      {multi && (\r\n        <div className=\"charts-grid\">\r\n          <div className=\"chart-block\">\r\n            <h3>Tendencia de Sueño</h3>\r\n            <p className=\"chart-description\">Evolución diaria de horas de sueño.</p>\r\n            <ResponsiveContainer width=\"100%\" height={200}>\r\n              <LineChart data={multi.sleepData} margin={{ top:10,right:30,left:0,bottom:0 }}>\r\n                <CartesianGrid strokeDasharray=\"3 3\"/>\r\n                <XAxis dataKey=\"date\"/>\r\n                <YAxis/>\r\n                <Tooltip/>\r\n                <Line type=\"monotone\" dataKey=\"hours\" stroke=\"#8884d8\" />\r\n              </LineChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n          <div className=\"chart-block\">\r\n            <h3>Variabilidad por Categoría</h3>\r\n            <p className=\"chart-description\">Varianza diaria de la distribución.</p>\r\n            <ResponsiveContainer width=\"100%\" height={200}>\r\n              <BarChart data={multi.categoryVariance} margin={{ top:20,right:30,left:0,bottom:0 }}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"category\"/>\r\n                <YAxis/>\r\n                <Tooltip/>\r\n                <Bar dataKey=\"variance\" fill=\"#ff8042\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Comparativa Miércoles vs Sábado */}\r\n      <section className=\"chart-block full-width\">\r\n        <h3>Comparativa Miércoles vs Sábado</h3>\r\n        {!wedRecord && <p>No se ha completado la rutina de <strong>Miércoles</strong>.</p>}\r\n        {!satRecord && <p>No se ha completado la rutina de <strong>Sábado</strong>.</p>}\r\n        {comparisonData.length > 0 && (\r\n          <>\r\n            <p className=\"chart-description\">\r\n              Horas dedicadas por categoría en ambos días. Permite identificar sesgos en la planificación semanal.\r\n            </p>\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={comparisonData} margin={{ top:20,right:30,left:0,bottom:5 }}>\r\n                <CartesianGrid strokeDasharray=\"3 3\"/>\r\n                <XAxis dataKey=\"category\"/>\r\n                <YAxis/>\r\n                <Tooltip/>\r\n                <Legend />\r\n                <Bar dataKey=\"Wed\" name=\"Miércoles\" fill=\"#82ca9d\" />\r\n                <Bar dataKey=\"Sat\" name=\"Sábado\" fill=\"#8884d8\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          </>\r\n        )}\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}