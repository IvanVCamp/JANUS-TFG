{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import templateService from'../services/templateService';import assignedService from'../services/assignedRoutineService';import'../styles/therapistTemplateManager.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function TherapistTemplateManager(){const[templates,setTemplates]=useState([]);const[patients,setPatients]=useState([]);const[modalNew,setModalNew]=useState(false);const[modalAssign,setModalAssign]=useState(null);const[formTpl,setFormTpl]=useState({title:'',description:'',type:'Terapia',duration:30});useEffect(()=>{const token=localStorage.getItem('token');templateService.getAll(token).then(r=>setTemplates(r.data));axios.get('/api/therapist/patients',{headers:{'x-auth-token':token}}).then(res=>setPatients(res.data));},[]);const handleSaveTpl=async e=>{e.preventDefault();const token=localStorage.getItem('token');const res=await templateService.create(formTpl,token);setTemplates([res.data,...templates]);setModalNew(false);};const assignTo=async(tplId,patientId)=>{const token=localStorage.getItem('token');await assignedService.assign({templateId:tplId,patientId},token);setModalAssign(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"tm-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"tm-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Gesti\\xF3n de Plantillas de Rutinas\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModalNew(true),children:\"+ Nueva Plantilla\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tm-list\",children:templates.map(t=>/*#__PURE__*/_jsxs(\"div\",{className:\"tm-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:t.title}),/*#__PURE__*/_jsx(\"p\",{children:t.description}),/*#__PURE__*/_jsx(\"span\",{className:\"badge\",children:t.type}),/*#__PURE__*/_jsxs(\"span\",{className:\"badge\",children:[t.duration,\" min\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModalAssign(t),children:\"Asignar \\u2192\"})]},t._id))}),modalNew&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"modal-content\",onSubmit:handleSaveTpl,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Nueva Plantilla\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"T\\xEDtulo\",required:true,value:formTpl.title,onChange:e=>setFormTpl({...formTpl,title:e.target.value})}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Descripci\\xF3n\",value:formTpl.description,onChange:e=>setFormTpl({...formTpl,description:e.target.value})}),/*#__PURE__*/_jsxs(\"select\",{value:formTpl.type,onChange:e=>setFormTpl({...formTpl,type:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Personal\",children:\"Personal\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Estudio\",children:\"Estudio\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Terapia\",children:\"Terapia\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Ocio\",children:\"Ocio\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Otro\",children:\"Otro\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"10\",max:\"180\",required:true,value:formTpl.duration,onChange:e=>setFormTpl({...formTpl,duration:+e.target.value})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Guardar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setModalNew(false),children:\"Cancelar\"})]})}),modalAssign&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content assign\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Asignar: \",modalAssign.title]}),/*#__PURE__*/_jsxs(\"select\",{onChange:e=>assignTo(modalAssign._id,e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Selecciona Paciente --\"}),patients.map(p=>/*#__PURE__*/_jsxs(\"option\",{value:p._id,children:[p.nombre,\" \",p.apellidos]},p._id))]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModalAssign(null),children:\"Cerrar\"})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","templateService","assignedService","jsx","_jsx","jsxs","_jsxs","TherapistTemplateManager","templates","setTemplates","patients","setPatients","modalNew","setModalNew","modalAssign","setModalAssign","formTpl","setFormTpl","title","description","type","duration","token","localStorage","getItem","getAll","then","r","data","get","headers","res","handleSaveTpl","e","preventDefault","create","assignTo","tplId","patientId","assign","templateId","className","children","onClick","map","t","_id","onSubmit","placeholder","required","value","onChange","target","min","max","p","nombre","apellidos"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/TherapistTemplateManager.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport templateService  from '../services/templateService';\r\nimport assignedService  from '../services/assignedRoutineService';\r\nimport '../styles/therapistTemplateManager.css';\r\n\r\nexport default function TherapistTemplateManager() {\r\n  const [templates, setTemplates] = useState([]);\r\n  const [patients,  setPatients ] = useState([]);\r\n  const [modalNew,  setModalNew ] = useState(false);\r\n  const [modalAssign,setModalAssign] = useState(null);\r\n  const [formTpl,   setFormTpl ] = useState({\r\n    title:'', description:'', type:'Terapia', duration:30\r\n  });\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    templateService.getAll(token)\r\n      .then(r => setTemplates(r.data));\r\n    axios.get('/api/therapist/patients', { headers:{ 'x-auth-token':token } })\r\n      .then(res => setPatients(res.data));\r\n  }, []);\r\n\r\n  const handleSaveTpl = async e => {\r\n    e.preventDefault();\r\n    const token = localStorage.getItem('token');\r\n    const res   = await templateService.create(formTpl, token);\r\n    setTemplates([res.data, ...templates]);\r\n    setModalNew(false);\r\n  };\r\n\r\n  const assignTo = async (tplId, patientId) => {\r\n    const token = localStorage.getItem('token');\r\n    await assignedService.assign({ templateId: tplId, patientId }, token);\r\n    setModalAssign(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"tm-container\">\r\n      <header className=\"tm-header\">\r\n        <h2>Gestión de Plantillas de Rutinas</h2>\r\n        <button onClick={()=>setModalNew(true)}>+ Nueva Plantilla</button>\r\n      </header>\r\n\r\n      <div className=\"tm-list\">\r\n        {templates.map(t => (\r\n          <div className=\"tm-card\" key={t._id}>\r\n            <h3>{t.title}</h3>\r\n            <p>{t.description}</p>\r\n            <span className=\"badge\">{t.type}</span>\r\n            <span className=\"badge\">{t.duration} min</span>\r\n            <button onClick={()=>setModalAssign(t)}>Asignar →</button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Modal Crear Plantilla */}\r\n      {modalNew && (\r\n        <div className=\"modal-overlay\">\r\n          <form className=\"modal-content\" onSubmit={handleSaveTpl}>\r\n            <h3>Nueva Plantilla</h3>\r\n            <input\r\n              type=\"text\" placeholder=\"Título\" required\r\n              value={formTpl.title}\r\n              onChange={e=>setFormTpl({...formTpl, title:e.target.value})}\r\n            />\r\n            <textarea\r\n              placeholder=\"Descripción\"\r\n              value={formTpl.description}\r\n              onChange={e=>setFormTpl({...formTpl, description:e.target.value})}\r\n            />\r\n            <select\r\n              value={formTpl.type}\r\n              onChange={e=>setFormTpl({...formTpl, type:e.target.value})}\r\n            >\r\n              <option value=\"Personal\">Personal</option>\r\n              <option value=\"Estudio\">Estudio</option>\r\n              <option value=\"Terapia\">Terapia</option>\r\n              <option value=\"Ocio\">Ocio</option>\r\n              <option value=\"Otro\">Otro</option>\r\n            </select>\r\n            <input\r\n              type=\"number\" min=\"10\" max=\"180\" required\r\n              value={formTpl.duration}\r\n              onChange={e=>setFormTpl({...formTpl, duration:+e.target.value})}\r\n            />\r\n            <button type=\"submit\">Guardar</button>\r\n            <button type=\"button\" onClick={()=>setModalNew(false)}>Cancelar</button>\r\n          </form>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal Asignar */}\r\n      {modalAssign && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-content assign\">\r\n            <h3>Asignar: {modalAssign.title}</h3>\r\n            <select onChange={e=>assignTo(modalAssign._id, e.target.value)}>\r\n              <option value=\"\">-- Selecciona Paciente --</option>\r\n              {patients.map(p => (\r\n                <option key={p._id} value={p._id}>\r\n                  {p.nombre} {p.apellidos}\r\n                </option>\r\n              ))}\r\n            </select>\r\n            <button onClick={()=>setModalAssign(null)}>Cerrar</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}