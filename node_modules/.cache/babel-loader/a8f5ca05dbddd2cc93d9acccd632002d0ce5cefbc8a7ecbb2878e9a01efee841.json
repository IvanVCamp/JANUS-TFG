{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import'../styles/patientsList.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function TherapistInterests(){const[patients,setPatients]=useState([]);const[loading,setLoading]=useState(true);const[hasPlanet,setHasPlanet]=useState({});const navigate=useNavigate();useEffect(()=>{const fetchPatients=async()=>{try{const token=localStorage.getItem('token');const res=await axios.get('/api/therapist/patients',{headers:{'x-auth-token':token}});setPatients(res.data);const checks=await Promise.all(res.data.map(async p=>{const resp=await axios.get(`/api/planet-map?patientId=${p._id}`,{headers:{'x-auth-token':token}});return[p._id,resp.data&&resp.data.elements&&resp.data.elements.length>0];}));setHasPlanet(Object.fromEntries(checks));}catch(err){console.error(err);}finally{setLoading(false);}};fetchPatients();},[]);if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Cargando pacientes\\u2026\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"therapist-patient-list\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Pacientes - Intereses\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"patient-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nombre Completo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Fecha de Nacimiento\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{className:\"action-col\",children:\"Estad\\xEDsticas\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:patients.map(p=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[p.nombre,\" \",p.apellidos]}),/*#__PURE__*/_jsx(\"td\",{children:new Date(p.fechaNacimiento).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:p.email}),/*#__PURE__*/_jsx(\"td\",{className:\"action-col\",children:/*#__PURE__*/_jsx(\"button\",{className:\"detail-btn\",disabled:!hasPlanet[p._id],onClick:()=>navigate(`/therapist/interests/${p._id}`),title:hasPlanet[p._id]?\"Ver intereses\":\"Mi Planeta pendiente\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-globe\"})})})]},p._id))})]})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","TherapistInterests","patients","setPatients","loading","setLoading","hasPlanet","setHasPlanet","navigate","fetchPatients","token","localStorage","getItem","res","get","headers","data","checks","Promise","all","map","p","resp","_id","elements","length","Object","fromEntries","err","console","error","children","className","nombre","apellidos","Date","fechaNacimiento","toLocaleDateString","email","disabled","onClick","title"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/TherapistInterests.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport '../styles/patientsList.css';\r\n\r\nexport default function TherapistInterests() {\r\n  const [patients, setPatients] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [hasPlanet, setHasPlanet] = useState({});\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchPatients = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const res = await axios.get('/api/therapist/patients', {\r\n          headers: { 'x-auth-token': token }\r\n        });\r\n        setPatients(res.data);\r\n        const checks = await Promise.all(res.data.map(async p => {\r\n          const resp = await axios.get(`/api/planet-map?patientId=${p._id}`, {\r\n            headers: { 'x-auth-token': token }\r\n          });\r\n          return [p._id, resp.data && resp.data.elements && resp.data.elements.length > 0];\r\n        }));\r\n        setHasPlanet(Object.fromEntries(checks));\r\n      } catch (err) {\r\n        console.error(err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchPatients();\r\n  }, []);\r\n\r\n  if (loading) return <p>Cargando pacientes…</p>;\r\n\r\n  return (\r\n    <div className=\"therapist-patient-list\">\r\n      <h1>Pacientes - Intereses</h1>\r\n      <table className=\"patient-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Nombre Completo</th>\r\n            <th>Fecha de Nacimiento</th>\r\n            <th>Email</th>\r\n            <th className=\"action-col\">Estadísticas</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {patients.map(p => (\r\n            <tr key={p._id}>\r\n              <td>{p.nombre} {p.apellidos}</td>\r\n              <td>{new Date(p.fechaNacimiento).toLocaleDateString()}</td>\r\n              <td>{p.email}</td>\r\n              <td className=\"action-col\">\r\n                <button\r\n                  className=\"detail-btn\"\r\n                  disabled={!hasPlanet[p._id]}\r\n                  onClick={() => navigate(`/therapist/interests/${p._id}`)}\r\n                  title={hasPlanet[p._id]\r\n                    ? \"Ver intereses\"\r\n                    : \"Mi Planeta pendiente\"}\r\n                >\r\n                  <i className=\"fa fa-globe\"></i>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}