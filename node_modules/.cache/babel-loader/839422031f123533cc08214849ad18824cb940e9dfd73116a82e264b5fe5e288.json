{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useParams,useNavigate}from'react-router-dom';import'../styles/detailsTemplate.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function TherapistPatientTemplatesDetail(){const{patientId}=useParams();const navigate=useNavigate();const[instances,setInstances]=useState([]);const[patient,setPatient]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchAll=async()=>{try{const token=localStorage.getItem('token');const[instRes,patRes]=await Promise.all([axios.get(`/api/routines/instances/${patientId}`,{headers:{'x-auth-token':token}}),axios.get(`/api/therapist/patients/${patientId}`,{headers:{'x-auth-token':token}})]);setInstances(instRes.data);setPatient(patRes.data);}catch(err){console.error(err);}finally{setLoading(false);}};fetchAll();},[patientId]);if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Cargando detalles\\u2026\"});if(!patient)return/*#__PURE__*/_jsx(\"p\",{children:\"Paciente no encontrado.\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"patient-assigns\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-new\",onClick:()=>navigate('/therapist/templates'),children:\"\\u2190 Volver\"}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Plantillas de \",patient.nombre,\" \",patient.apellidos]}),instances.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No hay plantillas asignadas.\"}):instances.map(inst=>{const{_id,template,completedActivities,createdAt,updatedAt}=inst;const total=template.activities.length;const done=completedActivities.length;const pct=Math.round(done/total*100);return/*#__PURE__*/_jsxs(\"div\",{className:`assign-card ${done===total?'status-completed':'status-postponed'}`,children:[/*#__PURE__*/_jsx(\"h3\",{children:template.title}),/*#__PURE__*/_jsxs(\"small\",{children:[\"Asignada: \",new Date(createdAt).toLocaleDateString(),\" \\xA0|\\xA0 \\xDAltima actualizaci\\xF3n: \",new Date(updatedAt).toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"progress-bar-container\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Progreso: \",done,\"/\",total,\" (\",pct,\"%)\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar-fill\",style:{width:`${pct}%`}})})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"activities-list\",children:template.activities.map((act,idx)=>/*#__PURE__*/_jsxs(\"li\",{className:`activity-item ${completedActivities.includes(idx)?'completed':'pending'}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"activity-header\",children:[act.icon&&/*#__PURE__*/_jsx(\"i\",{className:`fa ${act.icon}`}),/*#__PURE__*/_jsx(\"h4\",{children:act.name})]}),/*#__PURE__*/_jsx(\"p\",{children:act.description}),act.notes&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Notas:\"}),\" \",act.notes]}),/*#__PURE__*/_jsxs(\"div\",{className:\"activity-status\",children:[\"Estado: \",completedActivities.includes(idx)?'Completada':'Pendiente']})]},idx))})]},_id);})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","TherapistPatientTemplatesDetail","patientId","navigate","instances","setInstances","patient","setPatient","loading","setLoading","fetchAll","token","localStorage","getItem","instRes","patRes","Promise","all","get","headers","data","err","console","error","children","className","onClick","nombre","apellidos","length","map","inst","_id","template","completedActivities","createdAt","updatedAt","total","activities","done","pct","Math","round","title","Date","toLocaleDateString","toLocaleString","style","width","act","idx","includes","icon","name","description","notes"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/TherapistTemplatesDetail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport '../styles/detailsTemplate.css';\r\n\r\nexport default function TherapistPatientTemplatesDetail() {\r\n  const { patientId } = useParams();\r\n  const navigate = useNavigate();\r\n  const [instances, setInstances] = useState([]);\r\n  const [patient, setPatient] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchAll = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const [instRes, patRes] = await Promise.all([\r\n          axios.get(`/api/routines/instances/${patientId}`, {\r\n            headers: { 'x-auth-token': token }\r\n          }),\r\n          axios.get(`/api/therapist/patients/${patientId}`, {\r\n            headers: { 'x-auth-token': token }\r\n          })\r\n        ]);\r\n        setInstances(instRes.data);\r\n        setPatient(patRes.data);\r\n      } catch (err) {\r\n        console.error(err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchAll();\r\n  }, [patientId]);\r\n\r\n  if (loading) return <p>Cargando detalles…</p>;\r\n  if (!patient) return <p>Paciente no encontrado.</p>;\r\n\r\n  return (\r\n    <div className=\"patient-assigns\">\r\n      <button className=\"btn-new\" onClick={() => navigate('/therapist/templates')}>\r\n        ← Volver\r\n      </button>\r\n      <h1>Plantillas de {patient.nombre} {patient.apellidos}</h1>\r\n\r\n      {instances.length === 0\r\n        ? <p>No hay plantillas asignadas.</p>\r\n        : instances.map(inst => {\r\n            const { _id, template, completedActivities, createdAt, updatedAt } = inst;\r\n            const total = template.activities.length;\r\n            const done = completedActivities.length;\r\n            const pct = Math.round((done / total) * 100);\r\n\r\n            return (\r\n              <div key={_id} className={`assign-card ${done === total ? 'status-completed' : 'status-postponed'}`}>\r\n                <h3>{template.title}</h3>\r\n                <small>\r\n                  Asignada: {new Date(createdAt).toLocaleDateString()} &nbsp;|&nbsp;\r\n                  Última actualización: {new Date(updatedAt).toLocaleString()}\r\n                </small>\r\n\r\n                <div className=\"progress-bar-container\">\r\n                  <span>Progreso: {done}/{total} ({pct}%)</span>\r\n                  <div className=\"progress-bar\">\r\n                    <div className=\"progress-bar-fill\" style={{ width: `${pct}%` }} />\r\n                  </div>\r\n                </div>\r\n\r\n                <ul className=\"activities-list\">\r\n                  {template.activities.map((act, idx) => (\r\n                    <li key={idx} className={`activity-item ${completedActivities.includes(idx) ? 'completed' : 'pending'}`}>\r\n                      <div className=\"activity-header\">\r\n                        {act.icon && <i className={`fa ${act.icon}`}></i>}\r\n                        <h4>{act.name}</h4>\r\n                      </div>\r\n                      <p>{act.description}</p>\r\n                      {act.notes && <p><strong>Notas:</strong> {act.notes}</p>}\r\n                      <div className=\"activity-status\">\r\n                        Estado: {completedActivities.includes(idx) ? 'Completada' : 'Pendiente'}\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            );\r\n          })\r\n      }\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}