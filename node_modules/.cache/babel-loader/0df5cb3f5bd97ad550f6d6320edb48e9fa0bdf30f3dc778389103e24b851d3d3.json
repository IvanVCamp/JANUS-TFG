{"ast":null,"code":"// src/pages/PatientTemplatesPage.js\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import'../styles/patientTemplates.css';import{FaCheckCircle,FaRegCircle}from'react-icons/fa';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PatientTemplatesPage(){const[instances,setInstances]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const navigate=useNavigate();const token=localStorage.getItem('token');useEffect(()=>{if(!token){navigate('/login');return;}fetch('/api/routines/instances',{headers:{'x-auth-token':token}}).then(async res=>{if(!res.ok)throw new Error(`Error ${res.status}`);const data=await res.json();if(!Array.isArray(data))throw new Error('Respuesta malformada');setInstances(data);}).catch(err=>setError(err.message)).finally(()=>setLoading(false));},[navigate,token]);const markComplete=async id=>{try{const res=await fetch(`/api/routines/instances/${id}/complete`,{method:'PUT',headers:{'x-auth-token':token}});if(!res.ok)throw new Error(`Error ${res.status}`);setInstances(instances.map(ins=>ins._id===id?{...ins,status:'completed'}:ins));}catch(err){alert('No se pudo marcar como completada');console.error(err);}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"pt-container\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Cargando plantillas\\u2026\"})});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"pt-container\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"error\",children:[\"Error: \",error]})});return/*#__PURE__*/_jsxs(\"div\",{className:\"pt-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pt-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Mis Plantillas\"})}),instances.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"pt-empty\",children:\"\\uD83E\\uDD14 A\\xFAn no tienes plantillas asignadas\"}):/*#__PURE__*/_jsx(\"div\",{className:\"pt-grid\",children:instances.map(ins=>/*#__PURE__*/_jsxs(\"div\",{className:`pt-card ${ins.status}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pt-card-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:ins.template.name}),/*#__PURE__*/_jsx(\"button\",{className:\"pt-toggle-btn\",onClick:()=>markComplete(ins._id),title:ins.status==='completed'?'Marcar como pendiente':'Marcar como completada',children:ins.status==='completed'?/*#__PURE__*/_jsx(FaCheckCircle,{}):/*#__PURE__*/_jsx(FaRegCircle,{})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"pt-desc\",children:ins.template.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-footer\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[ins.template.activities.length,\" actividades\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"pt-action-btn\",onClick:()=>navigate(`/patient/templates/${ins._id}`),children:\"Ver detalles\"})]})]},ins._id))})]});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","FaCheckCircle","FaRegCircle","jsx","_jsx","jsxs","_jsxs","PatientTemplatesPage","instances","setInstances","loading","setLoading","error","setError","navigate","token","localStorage","getItem","fetch","headers","then","res","ok","Error","status","data","json","Array","isArray","catch","err","message","finally","markComplete","id","method","map","ins","_id","alert","console","className","children","length","template","name","onClick","title","description","activities"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/PatientTemplatesPage.js"],"sourcesContent":["// src/pages/PatientTemplatesPage.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport '../styles/patientTemplates.css';\r\nimport { FaCheckCircle, FaRegCircle } from 'react-icons/fa';\r\n\r\nexport default function PatientTemplatesPage() {\r\n  const [instances, setInstances] = useState([]);\r\n  const [loading, setLoading]   = useState(true);\r\n  const [error, setError]       = useState(null);\r\n  const navigate = useNavigate();\r\n  const token = localStorage.getItem('token');\r\n\r\n  useEffect(() => {\r\n    if (!token) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n    fetch('/api/routines/instances', {\r\n      headers: { 'x-auth-token': token }\r\n    })\r\n      .then(async res => {\r\n        if (!res.ok) throw new Error(`Error ${res.status}`);\r\n        const data = await res.json();\r\n        if (!Array.isArray(data)) throw new Error('Respuesta malformada');\r\n        setInstances(data);\r\n      })\r\n      .catch(err => setError(err.message))\r\n      .finally(() => setLoading(false));\r\n  }, [navigate, token]);\r\n\r\n  const markComplete = async (id) => {\r\n    try {\r\n      const res = await fetch(`/api/routines/instances/${id}/complete`, {\r\n        method: 'PUT',\r\n        headers: { 'x-auth-token': token }\r\n      });\r\n      if (!res.ok) throw new Error(`Error ${res.status}`);\r\n      setInstances(instances.map(ins =>\r\n        ins._id === id ? { ...ins, status: 'completed' } : ins\r\n      ));\r\n    } catch (err) {\r\n      alert('No se pudo marcar como completada');\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  if (loading) return (\r\n    <div className=\"pt-container\">\r\n      <p>Cargando plantillasâ€¦</p>\r\n    </div>\r\n  );\r\n  if (error) return (\r\n    <div className=\"pt-container\">\r\n      <p className=\"error\">Error: {error}</p>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"pt-container\">\r\n      <div className=\"pt-header\">\r\n        <h1>Mis Plantillas</h1>\r\n      </div>\r\n\r\n      {instances.length === 0 ? (\r\n        <div className=\"pt-empty\">\r\n          ðŸ¤” AÃºn no tienes plantillas asignadas\r\n        </div>\r\n      ) : (\r\n        <div className=\"pt-grid\">\r\n          {instances.map(ins => (\r\n            <div key={ins._id} className={`pt-card ${ins.status}`}>\r\n              <div className=\"pt-card-header\">\r\n                <h2>{ins.template.name}</h2>\r\n                <button\r\n                  className=\"pt-toggle-btn\"\r\n                  onClick={() => markComplete(ins._id)}\r\n                  title={ins.status === 'completed'\r\n                    ? 'Marcar como pendiente'\r\n                    : 'Marcar como completada'}\r\n                >\r\n                  {ins.status === 'completed'\r\n                    ? <FaCheckCircle />\r\n                    : <FaRegCircle />}\r\n                </button>\r\n              </div>\r\n              <p className=\"pt-desc\">{ins.template.description}</p>\r\n              <div className=\"pt-footer\">\r\n                <span>{ins.template.activities.length} actividades</span>\r\n                <button\r\n                  className=\"pt-action-btn\"\r\n                  onClick={() => navigate(`/patient/templates/${ins._id}`)}\r\n                >\r\n                  Ver detalles\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}