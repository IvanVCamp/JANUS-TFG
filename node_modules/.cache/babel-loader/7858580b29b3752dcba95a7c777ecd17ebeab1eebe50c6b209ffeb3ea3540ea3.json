{"ast":null,"code":"// src/pages/PatientTemplatesPage.js\nimport React,{useState,useEffect}from'react';// ⚠️ Import correcto de jwt-decode:\nimport{decode as jwtDecode}from'jwt-decode';import assignedRoutineService from'../services/assignedRoutineService';import'../styles/routineTemplates.css';import'../styles/patientTemplates.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PatientTemplatesPage(){const[templates,setTemplates]=useState([]);const[loading,setLoading]=useState(true);const[expandedIds,setExpanded]=useState([]);const[search,setSearch]=useState('');const[filterStatus,setFilter]=useState('all');const[sortKey,setSort]=useState('dueDate');// ─── 1) Extraer patientId del JWT ──────────────────────────\nlet patientId='';const rawToken=localStorage.getItem('token');if(rawToken){try{const payload=jwtDecode(rawToken);// si tu backend pone el id en payload.id:\npatientId=payload.id||'';// o si lo anidas en payload.user.id:\n// patientId = payload.user?.id || '';\n}catch(e){console.warn('Token inválido o expirado:',e);}}// ─── 2) Fetch de plantillas asignadas ──────────────────────\nuseEffect(()=>{if(!patientId){console.error('No se ha encontrado patientId en el token');setLoading(false);return;}assignedRoutineService.getAssignedTemplates(patientId).then(_ref=>{let{data}=_ref;const arr=data.map(inst=>({id:inst._id,title:inst.template.name||inst.template.title,description:inst.template.description,dueDate:inst.template.dueDate||inst.assignedAt,activities:inst.template.activities.map((act,idx)=>({id:idx,name:act.name,details:act.desc||act.details||'',estimatedTime:act.minutes||act.estimatedTime||'',completed:inst.completedActivities.includes(idx)})),progress:inst.template.activities.length===0?0:Math.round(inst.completedActivities.length/inst.template.activities.length*100),status:inst.completedActivities.length===inst.template.activities.length?'completed':inst.completedActivities.length>0?'in-progress':'pending'}));setTemplates(arr);}).catch(err=>console.error('Error al cargar plantillas:',err)).finally(()=>setLoading(false));},[patientId]);// ─── 3) Handlers ───────────────────────────────────────────\nconst toggleExpand=id=>setExpanded(ids=>ids.includes(id)?ids.filter(x=>x!==id):[...ids,id]);const handleActivityToggle=(tplId,actId)=>{const inst=templates.find(t=>t.id===tplId);const currently=inst.activities.find(a=>a.id===actId).completed;assignedRoutineService.toggleActivity(tplId,actId,!currently).then(()=>{setTemplates(ts=>ts.map(t=>{if(t.id!==tplId)return t;const completedCount=t.activities.filter(a=>a.completed).length+(currently?-1:1);return{...t,activities:t.activities.map(a=>a.id===actId?{...a,completed:!currently}:a),progress:Math.round(completedCount/t.activities.length*100)};}));}).catch(err=>console.error('Error marcando actividad:',err));};// ─── 4) Render ─────────────────────────────────────────────\nif(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"pt-loading\",children:\"Cargando plantillas\\u2026\"});if(!patientId)return/*#__PURE__*/_jsx(\"div\",{className:\"pt-loading\",children:\"Debes iniciar sesi\\xF3n para ver tus plantillas.\"});const visible=templates.filter(t=>filterStatus==='all'||t.status===filterStatus).filter(t=>t.title.toLowerCase().includes(search.toLowerCase())).sort((a,b)=>{if(sortKey==='dueDate')return new Date(a.dueDate)-new Date(b.dueDate);if(sortKey==='progress')return a.progress-b.progress;return 0;});return/*#__PURE__*/_jsxs(\"div\",{className:\"pt-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"pt-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Mis Plantillas Asignadas\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-controls\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Buscar plantilla\\u2026\",value:search,onChange:e=>setSearch(e.target.value)}),/*#__PURE__*/_jsxs(\"select\",{value:filterStatus,onChange:e=>setFilter(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"Todas\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pendientes\"}),/*#__PURE__*/_jsx(\"option\",{value:\"in-progress\",children:\"En progreso\"}),/*#__PURE__*/_jsx(\"option\",{value:\"completed\",children:\"Completadas\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:sortKey,onChange:e=>setSort(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"dueDate\",children:\"Por fecha\"}),/*#__PURE__*/_jsx(\"option\",{value:\"progress\",children:\"Por progreso\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-grid\",children:visible.map(t=>/*#__PURE__*/_jsxs(\"div\",{className:\"pt-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pt-card-header\",onClick:()=>toggleExpand(t.id),children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:t.title}),/*#__PURE__*/_jsxs(\"small\",{children:[\"Vence: \",new Date(t.dueDate).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-progress-wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pt-progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"pt-progress-filled\",style:{width:`${t.progress}%`}})}),/*#__PURE__*/_jsxs(\"span\",{className:\"pt-progress-label\",children:[t.progress,\"%\"]})]})]}),expandedIds.includes(t.id)&&/*#__PURE__*/_jsxs(\"div\",{className:\"pt-card-body\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"pt-description\",children:t.description}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-activities\",children:t.activities.map(act=>/*#__PURE__*/_jsx(\"div\",{className:`pt-activity-item ${act.completed?'done':''}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"pt-act-main\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:act.completed,onChange:()=>handleActivityToggle(t.id,act.id)}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:act.name}),/*#__PURE__*/_jsx(\"p\",{children:act.details}),/*#__PURE__*/_jsxs(\"small\",{children:[\"Tiempo estimado: \",act.estimatedTime,\" min\"]})]})]})},act.id))})]})]},t.id))})]});}","map":{"version":3,"names":["React","useState","useEffect","decode","jwtDecode","assignedRoutineService","jsx","_jsx","jsxs","_jsxs","PatientTemplatesPage","templates","setTemplates","loading","setLoading","expandedIds","setExpanded","search","setSearch","filterStatus","setFilter","sortKey","setSort","patientId","rawToken","localStorage","getItem","payload","id","e","console","warn","error","getAssignedTemplates","then","_ref","data","arr","map","inst","_id","title","template","name","description","dueDate","assignedAt","activities","act","idx","details","desc","estimatedTime","minutes","completed","completedActivities","includes","progress","length","Math","round","status","catch","err","finally","toggleExpand","ids","filter","x","handleActivityToggle","tplId","actId","find","t","currently","a","toggleActivity","ts","completedCount","className","children","visible","toLowerCase","sort","b","Date","type","placeholder","value","onChange","target","onClick","toLocaleDateString","style","width","checked"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/PatientTemplatesPage.js"],"sourcesContent":["// src/pages/PatientTemplatesPage.js\r\nimport React, { useState, useEffect } from 'react';\r\n// ⚠️ Import correcto de jwt-decode:\r\nimport { decode as jwtDecode } from 'jwt-decode';\r\n\r\nimport assignedRoutineService from '../services/assignedRoutineService';\r\nimport '../styles/routineTemplates.css';\r\nimport '../styles/patientTemplates.css';\r\n\r\nexport default function PatientTemplatesPage() {\r\n  const [templates, setTemplates]   = useState([]);\r\n  const [loading, setLoading]       = useState(true);\r\n  const [expandedIds, setExpanded]  = useState([]);\r\n  const [search, setSearch]         = useState('');\r\n  const [filterStatus, setFilter]   = useState('all');\r\n  const [sortKey, setSort]          = useState('dueDate');\r\n\r\n  // ─── 1) Extraer patientId del JWT ──────────────────────────\r\n  let patientId = '';\r\n  const rawToken = localStorage.getItem('token');\r\n  if (rawToken) {\r\n    try {\r\n      const payload = jwtDecode(rawToken);\r\n      // si tu backend pone el id en payload.id:\r\n      patientId = payload.id || '';\r\n      // o si lo anidas en payload.user.id:\r\n      // patientId = payload.user?.id || '';\r\n    } catch (e) {\r\n      console.warn('Token inválido o expirado:', e);\r\n    }\r\n  }\r\n\r\n  // ─── 2) Fetch de plantillas asignadas ──────────────────────\r\n  useEffect(() => {\r\n    if (!patientId) {\r\n      console.error('No se ha encontrado patientId en el token');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    assignedRoutineService\r\n      .getAssignedTemplates(patientId)\r\n      .then(({ data }) => {\r\n        const arr = data.map(inst => ({\r\n          id: inst._id,\r\n          title: inst.template.name || inst.template.title,\r\n          description: inst.template.description,\r\n          dueDate: inst.template.dueDate || inst.assignedAt,\r\n          activities: inst.template.activities.map((act, idx) => ({\r\n            id: idx,\r\n            name: act.name,\r\n            details: act.desc || act.details || '',\r\n            estimatedTime: act.minutes || act.estimatedTime || '',\r\n            completed: inst.completedActivities.includes(idx)\r\n          })),\r\n          progress:\r\n            inst.template.activities.length === 0\r\n              ? 0\r\n              : Math.round(\r\n                  inst.completedActivities.length /\r\n                    inst.template.activities.length *\r\n                  100\r\n                ),\r\n          status:\r\n            inst.completedActivities.length === inst.template.activities.length\r\n              ? 'completed'\r\n              : inst.completedActivities.length > 0\r\n              ? 'in-progress'\r\n              : 'pending'\r\n        }));\r\n        setTemplates(arr);\r\n      })\r\n      .catch(err => console.error('Error al cargar plantillas:', err))\r\n      .finally(() => setLoading(false));\r\n  }, [patientId]);\r\n\r\n  // ─── 3) Handlers ───────────────────────────────────────────\r\n  const toggleExpand = id =>\r\n    setExpanded(ids =>\r\n      ids.includes(id) ? ids.filter(x => x !== id) : [...ids, id]\r\n    );\r\n\r\n  const handleActivityToggle = (tplId, actId) => {\r\n    const inst = templates.find(t => t.id === tplId);\r\n    const currently = inst.activities.find(a => a.id === actId).completed;\r\n\r\n    assignedRoutineService\r\n      .toggleActivity(tplId, actId, !currently)\r\n      .then(() => {\r\n        setTemplates(ts =>\r\n          ts.map(t => {\r\n            if (t.id !== tplId) return t;\r\n            const completedCount =\r\n              t.activities.filter(a => a.completed).length +\r\n              (currently ? -1 : 1);\r\n            return {\r\n              ...t,\r\n              activities: t.activities.map(a =>\r\n                a.id === actId ? { ...a, completed: !currently } : a\r\n              ),\r\n              progress: Math.round(\r\n                (completedCount / t.activities.length) * 100\r\n              )\r\n            };\r\n          })\r\n        );\r\n      })\r\n      .catch(err => console.error('Error marcando actividad:', err));\r\n  };\r\n\r\n  // ─── 4) Render ─────────────────────────────────────────────\r\n  if (loading)\r\n    return <div className=\"pt-loading\">Cargando plantillas…</div>;\r\n  if (!patientId)\r\n    return (\r\n      <div className=\"pt-loading\">\r\n        Debes iniciar sesión para ver tus plantillas.\r\n      </div>\r\n    );\r\n\r\n  const visible = templates\r\n    .filter(t => filterStatus === 'all' || t.status === filterStatus)\r\n    .filter(t => t.title.toLowerCase().includes(search.toLowerCase()))\r\n    .sort((a, b) => {\r\n      if (sortKey === 'dueDate')\r\n        return new Date(a.dueDate) - new Date(b.dueDate);\r\n      if (sortKey === 'progress') return a.progress - b.progress;\r\n      return 0;\r\n    });\r\n\r\n  return (\r\n    <div className=\"pt-container\">\r\n      <header className=\"pt-header\">\r\n        <h1>Mis Plantillas Asignadas</h1>\r\n        <div className=\"pt-controls\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Buscar plantilla…\"\r\n            value={search}\r\n            onChange={e => setSearch(e.target.value)}\r\n          />\r\n          <select\r\n            value={filterStatus}\r\n            onChange={e => setFilter(e.target.value)}\r\n          >\r\n            <option value=\"all\">Todas</option>\r\n            <option value=\"pending\">Pendientes</option>\r\n            <option value=\"in-progress\">En progreso</option>\r\n            <option value=\"completed\">Completadas</option>\r\n          </select>\r\n          <select\r\n            value={sortKey}\r\n            onChange={e => setSort(e.target.value)}\r\n          >\r\n            <option value=\"dueDate\">Por fecha</option>\r\n            <option value=\"progress\">Por progreso</option>\r\n          </select>\r\n        </div>\r\n      </header>\r\n\r\n      <div className=\"pt-grid\">\r\n        {visible.map(t => (\r\n          <div key={t.id} className=\"pt-card\">\r\n            <div\r\n              className=\"pt-card-header\"\r\n              onClick={() => toggleExpand(t.id)}\r\n            >\r\n              <div>\r\n                <h2>{t.title}</h2>\r\n                <small>\r\n                  Vence: {new Date(t.dueDate).toLocaleDateString()}\r\n                </small>\r\n              </div>\r\n              <div className=\"pt-progress-wrapper\">\r\n                <div className=\"pt-progress-bar\">\r\n                  <div\r\n                    className=\"pt-progress-filled\"\r\n                    style={{ width: `${t.progress}%` }}\r\n                  />\r\n                </div>\r\n                <span className=\"pt-progress-label\">\r\n                  {t.progress}%\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {expandedIds.includes(t.id) && (\r\n              <div className=\"pt-card-body\">\r\n                <p className=\"pt-description\">{t.description}</p>\r\n                <div className=\"pt-activities\">\r\n                  {t.activities.map(act => (\r\n                    <div\r\n                      key={act.id}\r\n                      className={`pt-activity-item ${\r\n                        act.completed ? 'done' : ''\r\n                      }`}\r\n                    >\r\n                      <div className=\"pt-act-main\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={act.completed}\r\n                          onChange={() =>\r\n                            handleActivityToggle(t.id, act.id)\r\n                          }\r\n                        />\r\n                        <div>\r\n                          <h3>{act.name}</h3>\r\n                          <p>{act.details}</p>\r\n                          <small>\r\n                            Tiempo estimado: {act.estimatedTime} min\r\n                          </small>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}