{"ast":null,"code":"// src/components/TherapistInterests.js\nimport React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import'../styles/patientsList.css';// Reutilizamos el CSS de la tabla\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function TherapistSatisfaction(){const[patients,setPatients]=useState([]);const[loading,setLoading]=useState(true);const[hasDiary,setHasDiary]=useState({});const navigate=useNavigate();useEffect(()=>{const fetchPatients=async()=>{try{const token=localStorage.getItem('token');const{data}=await axios.get('/api/therapist/patients',{headers:{'x-auth-token':token}});setPatients(data);// Comprobar para cada paciente si tiene al menos un diario\nconst diaryChecks=await Promise.all(data.map(async p=>{const resp=await axios.get(`/api/emotions?patientId=${p._id}`,{headers:{'x-auth-token':token}});return[p._id,resp.data&&resp.data.length>0];}));setHasDiary(Object.fromEntries(diaryChecks));}catch(err){console.error(err);}finally{setLoading(false);}};fetchPatients();},[]);if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Cargando pacientes\\u2026\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"therapist-patient-list\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Pacientes - Intereses Emocionales\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"patient-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Nombre Completo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Fecha de Nacimiento\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{className:\"action-col\",children:\"Estad\\xEDsticas\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:patients.map(p=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[p.nombre,\" \",p.apellidos]}),/*#__PURE__*/_jsx(\"td\",{children:new Date(p.fechaNacimiento).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:p.email}),/*#__PURE__*/_jsx(\"td\",{className:\"action-col\",children:/*#__PURE__*/_jsx(\"button\",{className:\"detail-btn\",disabled:!hasDiary[p._id],onClick:()=>navigate(`/therapist/interests/${p._id}`),title:hasDiary[p._id]?\"Ver estadísticas de emociones\":\"Diario de emociones pendiente\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-smile-o\"})})})]},p._id))})]})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","TherapistSatisfaction","patients","setPatients","loading","setLoading","hasDiary","setHasDiary","navigate","fetchPatients","token","localStorage","getItem","data","get","headers","diaryChecks","Promise","all","map","p","resp","_id","length","Object","fromEntries","err","console","error","children","className","nombre","apellidos","Date","fechaNacimiento","toLocaleDateString","email","disabled","onClick","title"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/TherapistSatisfaction.js"],"sourcesContent":["// src/components/TherapistInterests.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport '../styles/patientsList.css'; // Reutilizamos el CSS de la tabla\r\n\r\nexport default function TherapistSatisfaction() {\r\n  const [patients, setPatients] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [hasDiary, setHasDiary] = useState({});\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchPatients = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const { data } = await axios.get('/api/therapist/patients', {\r\n          headers: { 'x-auth-token': token }\r\n        });\r\n        setPatients(data);\r\n\r\n        // Comprobar para cada paciente si tiene al menos un diario\r\n        const diaryChecks = await Promise.all(data.map(async p => {\r\n          const resp = await axios.get(`/api/emotions?patientId=${p._id}`, {\r\n            headers: { 'x-auth-token': token }\r\n          });\r\n          return [p._id, resp.data && resp.data.length > 0];\r\n        }));\r\n        setHasDiary(Object.fromEntries(diaryChecks));\r\n      } catch (err) {\r\n        console.error(err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchPatients();\r\n  }, []);\r\n\r\n  if (loading) return <p>Cargando pacientes…</p>;\r\n\r\n  return (\r\n    <div className=\"therapist-patient-list\">\r\n      <h1>Pacientes - Intereses Emocionales</h1>\r\n      <table className=\"patient-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>Nombre Completo</th>\r\n            <th>Fecha de Nacimiento</th>\r\n            <th>Email</th>\r\n            <th className=\"action-col\">Estadísticas</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {patients.map(p => (\r\n            <tr key={p._id}>\r\n              <td>{p.nombre} {p.apellidos}</td>\r\n              <td>{new Date(p.fechaNacimiento).toLocaleDateString()}</td>\r\n              <td>{p.email}</td>\r\n              <td className=\"action-col\">\r\n                <button\r\n                  className=\"detail-btn\"\r\n                  disabled={!hasDiary[p._id]}\r\n                  onClick={() => navigate(`/therapist/interests/${p._id}`)}\r\n                  title={hasDiary[p._id]\r\n                    ? \"Ver estadísticas de emociones\"\r\n                    : \"Diario de emociones pendiente\"}\r\n                >\r\n                  <i className=\"fa fa-smile-o\"></i>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}