{"ast":null,"code":"// src/components/AssignTemplate.js\nimport React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import axios from'axios';import'../styles/routineTemplates.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AssignTemplate(){const{templateId}=useParams();const[tpl,setTpl]=useState(null);const[patients,setPatients]=useState([]);const[selected,setSelected]=useState('');const[msg,setMsg]=useState('');const nav=useNavigate();useEffect(()=>{const token=localStorage.getItem('token');axios.get('/api/routines/templates/${templateId}',{headers:{'x-auth-token':token}}).then(r=>setTpl(r.data));axios.get('/api/therapist/patients',{headers:{'x-auth-token':token}}).then(r=>setPatients(r.data));},[templateId]);const handleAssign=async()=>{try{const token=localStorage.getItem('token');await axios.post('/api/routines/instances',{templateId,patientId:selected},{headers:{'x-auth-token':token}});setMsg('Asignación realizada con éxito');setTimeout(()=>nav('/therapist/templates'),1000);}catch{setMsg('Error al asignar la plantilla');}};if(!tpl)return/*#__PURE__*/_jsx(\"p\",{children:\"Cargando plantilla\\u2026\"});return/*#__PURE__*/_jsx(\"div\",{className:\"routine-templates-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"assign-form\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Asignar: \",tpl.name]}),/*#__PURE__*/_jsx(\"label\",{children:\"Paciente\"}),/*#__PURE__*/_jsxs(\"select\",{value:selected,onChange:e=>setSelected(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"--Selecciona--\"}),patients.map(p=>/*#__PURE__*/_jsxs(\"option\",{value:p._id,children:[p.nombre,\" \",p.apellidos]},p._id))]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-save\",onClick:handleAssign,disabled:!selected,children:\"Confirmar Asignaci\\xF3n\"}),msg&&/*#__PURE__*/_jsx(\"p\",{className:\"assign-msg\",children:msg})]})});}","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","AssignTemplate","templateId","tpl","setTpl","patients","setPatients","selected","setSelected","msg","setMsg","nav","token","localStorage","getItem","get","headers","then","r","data","handleAssign","post","patientId","setTimeout","children","className","name","value","onChange","e","target","map","p","_id","nombre","apellidos","onClick","disabled"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/AssignTemplate.js"],"sourcesContent":["// src/components/AssignTemplate.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport '../styles/routineTemplates.css';\r\n\r\nexport default function AssignTemplate() {\r\n  const { templateId } = useParams();\r\n  const [tpl, setTpl] = useState(null);\r\n  const [patients, setPatients] = useState([]);\r\n  const [selected, setSelected] = useState('');\r\n  const [msg, setMsg] = useState('');\r\n  const nav = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    axios.get('/api/routines/templates/${templateId}', { headers: {'x-auth-token':token} })\r\n      .then(r=> setTpl(r.data));\r\n    axios.get('/api/therapist/patients', { headers: {'x-auth-token':token} })\r\n      .then(r=> setPatients(r.data));\r\n  }, [templateId]);\r\n\r\n  const handleAssign = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      await axios.post('/api/routines/instances',\r\n        { templateId, patientId: selected },\r\n        { headers:{ 'x-auth-token': token } }\r\n      );\r\n      setMsg('Asignación realizada con éxito');\r\n      setTimeout(() => nav('/therapist/templates'), 1000);\r\n    } catch {\r\n      setMsg('Error al asignar la plantilla');\r\n    }\r\n  };\r\n\r\n  if (!tpl) return <p>Cargando plantilla…</p>;\r\n\r\n  return (\r\n    <div className=\"routine-templates-page\">\r\n    <div className=\"assign-form\">\r\n      <h2>Asignar: {tpl.name}</h2>\r\n      <label>Paciente</label>\r\n      <select value={selected} onChange={e=>setSelected(e.target.value)}>\r\n        <option value=\"\">--Selecciona--</option>\r\n        {patients.map(p => (\r\n          <option key={p._id} value={p._id}>\r\n            {p.nombre} {p.apellidos}\r\n          </option>\r\n        ))}\r\n      </select>\r\n\r\n      <button\r\n        className=\"btn-save\"\r\n        onClick={handleAssign}\r\n        disabled={!selected}\r\n      >\r\n        Confirmar Asignación\r\n      </button>\r\n      {msg && <p className=\"assign-msg\">{msg}</p>}\r\n    </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}