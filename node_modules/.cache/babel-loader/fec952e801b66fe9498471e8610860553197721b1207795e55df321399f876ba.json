{"ast":null,"code":"// src/components/PatientInterests.js\nimport React,{useState,useEffect}from'react';import{useParams,Link}from'react-router-dom';import axios from'axios';import{ResponsiveContainer,BarChart,Bar,XAxis,YAxis,Tooltip,Legend,PieChart,Pie,Cell}from'recharts';import'../styles/therapistRoutines.css';// Para la disposición de cards y grid\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PatientInterests(){const{patientId}=useParams();const[diary,setDiary]=useState(null);const[metrics,setMetrics]=useState(null);useEffect(()=>{const fetchDiary=async()=>{const token=localStorage.getItem('token');const{data}=await axios.get(`/api/emotions?patientId=${patientId}`,{headers:{'x-auth-token':token}});if(data&&data.length>0){const latest=data[0].diary;setDiary(latest);}};fetchDiary();},[patientId]);useEffect(()=>{if(!diary)return;// Calcular métricas\nconst ratings=diary.map(e=>e.rating);const avg=(ratings.reduce((a,b)=>a+b,0)/ratings.length).toFixed(2);const dist=[1,2,3,4,5].map(r=>({rating:r,count:ratings.filter(v=>v===r).length}));const actData=diary.map(e=>({name:e.title,rating:e.rating}));setMetrics({average:avg,distribution:dist,activities:actData});},[diary]);if(!diary){return/*#__PURE__*/_jsxs(\"div\",{className:\"routines-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"routines-header\",children:[/*#__PURE__*/_jsx(Link,{to:\"/therapist/interests\",children:\"\\u2190 Volver\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Estad\\xEDsticas de Emociones\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"No se ha encontrado un diario guardado para este paciente.\"})]});}const COLORS=['#8884d8','#82ca9d','#ffc658','#ff8042','#0088FE'];return/*#__PURE__*/_jsxs(\"div\",{className:\"routines-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"routines-header\",children:[/*#__PURE__*/_jsx(Link,{to:\"/therapist/interests\",children:\"\\u2190 Volver\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Estad\\xEDsticas de Emociones\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metrics-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[\"Promedio de Estado: \",/*#__PURE__*/_jsx(\"strong\",{children:metrics.average})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"metric-card\",children:[\"Actividades: \",/*#__PURE__*/_jsx(\"strong\",{children:metrics.activities.length})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"charts-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Distribuci\\xF3n de Calificaciones\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:250,children:/*#__PURE__*/_jsxs(PieChart,{children:[/*#__PURE__*/_jsx(Pie,{data:metrics.distribution,dataKey:\"count\",nameKey:\"rating\",cx:\"50%\",cy:\"50%\",outerRadius:80,label:true,children:metrics.distribution.map((_,i)=>/*#__PURE__*/_jsx(Cell,{fill:COLORS[i%COLORS.length]},i))}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{verticalAlign:\"bottom\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-block full-width\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Calificaci\\xF3n por Actividad\"}),/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(BarChart,{data:metrics.activities,margin:{top:20,right:30,left:0,bottom:0},children:[/*#__PURE__*/_jsx(XAxis,{dataKey:\"name\"}),/*#__PURE__*/_jsx(YAxis,{domain:[1,5]}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"rating\",fill:\"#82ca9d\"})]})})]})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","axios","ResponsiveContainer","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","PieChart","Pie","Cell","jsx","_jsx","jsxs","_jsxs","PatientInterests","patientId","diary","setDiary","metrics","setMetrics","fetchDiary","token","localStorage","getItem","data","get","headers","length","latest","ratings","map","e","rating","avg","reduce","a","b","toFixed","dist","r","count","filter","v","actData","name","title","average","distribution","activities","className","children","to","COLORS","width","height","dataKey","nameKey","cx","cy","outerRadius","label","_","i","fill","verticalAlign","margin","top","right","left","bottom","domain"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/PatientInterests.js"],"sourcesContent":["// src/components/PatientInterests.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport {\r\n  ResponsiveContainer,\r\n  BarChart, Bar, XAxis, YAxis, Tooltip, Legend,\r\n  PieChart, Pie, Cell\r\n} from 'recharts';\r\nimport '../styles/therapistRoutines.css'; // Para la disposición de cards y grid\r\n\r\nexport default function PatientInterests() {\r\n  const { patientId } = useParams();\r\n  const [diary, setDiary] = useState(null);\r\n  const [metrics, setMetrics] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchDiary = async () => {\r\n      const token = localStorage.getItem('token');\r\n      const { data } = await axios.get(`/api/emotions?patientId=${patientId}`, {\r\n        headers: { 'x-auth-token': token }\r\n      });\r\n      if (data && data.length > 0) {\r\n        const latest = data[0].diary;\r\n        setDiary(latest);\r\n      }\r\n    };\r\n    fetchDiary();\r\n  }, [patientId]);\r\n\r\n  useEffect(() => {\r\n    if (!diary) return;\r\n    // Calcular métricas\r\n    const ratings = diary.map(e => e.rating);\r\n    const avg = (ratings.reduce((a,b)=>a+b,0)/ratings.length).toFixed(2);\r\n    const dist = [1,2,3,4,5].map(r => ({\r\n      rating: r,\r\n      count: ratings.filter(v => v===r).length\r\n    }));\r\n    const actData = diary.map(e => ({ name: e.title, rating: e.rating }));\r\n    setMetrics({ average: avg, distribution: dist, activities: actData });\r\n  }, [diary]);\r\n\r\n  if (!diary) {\r\n    return (\r\n      <div className=\"routines-container\">\r\n        <header className=\"routines-header\">\r\n          <Link to=\"/therapist/interests\">← Volver</Link>\r\n          <h2>Estadísticas de Emociones</h2>\r\n        </header>\r\n        <p>No se ha encontrado un diario guardado para este paciente.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const COLORS = ['#8884d8','#82ca9d','#ffc658','#ff8042','#0088FE'];\r\n\r\n  return (\r\n    <div className=\"routines-container\">\r\n      <header className=\"routines-header\">\r\n        <Link to=\"/therapist/interests\">← Volver</Link>\r\n        <h2>Estadísticas de Emociones</h2>\r\n      </header>\r\n\r\n      <div className=\"metrics-grid\">\r\n        <div className=\"metric-card\">Promedio de Estado: <strong>{metrics.average}</strong></div>\r\n        <div className=\"metric-card\">Actividades: <strong>{metrics.activities.length}</strong></div>\r\n      </div>\r\n\r\n      <div className=\"charts-grid\">\r\n        <div className=\"chart-block\">\r\n          <h3>Distribución de Calificaciones</h3>\r\n          <ResponsiveContainer width=\"100%\" height={250}>\r\n            <PieChart>\r\n              <Pie\r\n                data={metrics.distribution}\r\n                dataKey=\"count\"\r\n                nameKey=\"rating\"\r\n                cx=\"50%\" cy=\"50%\"\r\n                outerRadius={80}\r\n                label\r\n              >\r\n                {metrics.distribution.map((_,i) => (\r\n                  <Cell key={i} fill={COLORS[i % COLORS.length]} />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip />\r\n              <Legend verticalAlign=\"bottom\" />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n\r\n        <div className=\"chart-block full-width\">\r\n          <h3>Calificación por Actividad</h3>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <BarChart data={metrics.activities} margin={{ top:20, right:30, left:0, bottom:0 }}>\r\n              <XAxis dataKey=\"name\" />\r\n              <YAxis domain={[1,5]} />\r\n              <Tooltip />\r\n              <Bar dataKey=\"rating\" fill=\"#82ca9d\" />\r\n            </BarChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,SAAS,CAAEC,IAAI,KAAQ,kBAAkB,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OACEC,mBAAmB,CACnBC,QAAQ,CAAEC,GAAG,CAAEC,KAAK,CAAEC,KAAK,CAAEC,OAAO,CAAEC,MAAM,CAC5CC,QAAQ,CAAEC,GAAG,CAAEC,IAAI,KACd,UAAU,CACjB,MAAO,iCAAiC,CAAE;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1C,cAAe,SAAS,CAAAC,gBAAgBA,CAAA,CAAG,CACzC,KAAM,CAAEC,SAAU,CAAC,CAAGlB,SAAS,CAAC,CAAC,CACjC,KAAM,CAACmB,KAAK,CAAEC,QAAQ,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAACuB,OAAO,CAAEC,UAAU,CAAC,CAAGxB,QAAQ,CAAC,IAAI,CAAC,CAE5CC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAwB,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAEC,IAAK,CAAC,CAAG,KAAM,CAAAzB,KAAK,CAAC0B,GAAG,CAAC,2BAA2BV,SAAS,EAAE,CAAE,CACvEW,OAAO,CAAE,CAAE,cAAc,CAAEL,KAAM,CACnC,CAAC,CAAC,CACF,GAAIG,IAAI,EAAIA,IAAI,CAACG,MAAM,CAAG,CAAC,CAAE,CAC3B,KAAM,CAAAC,MAAM,CAAGJ,IAAI,CAAC,CAAC,CAAC,CAACR,KAAK,CAC5BC,QAAQ,CAACW,MAAM,CAAC,CAClB,CACF,CAAC,CACDR,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,CAACL,SAAS,CAAC,CAAC,CAEfnB,SAAS,CAAC,IAAM,CACd,GAAI,CAACoB,KAAK,CAAE,OACZ;AACA,KAAM,CAAAa,OAAO,CAAGb,KAAK,CAACc,GAAG,CAACC,CAAC,EAAIA,CAAC,CAACC,MAAM,CAAC,CACxC,KAAM,CAAAC,GAAG,CAAG,CAACJ,OAAO,CAACK,MAAM,CAAC,CAACC,CAAC,CAACC,CAAC,GAAGD,CAAC,CAACC,CAAC,CAAC,CAAC,CAAC,CAACP,OAAO,CAACF,MAAM,EAAEU,OAAO,CAAC,CAAC,CAAC,CACpE,KAAM,CAAAC,IAAI,CAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACR,GAAG,CAACS,CAAC,GAAK,CACjCP,MAAM,CAAEO,CAAC,CACTC,KAAK,CAAEX,OAAO,CAACY,MAAM,CAACC,CAAC,EAAIA,CAAC,GAAGH,CAAC,CAAC,CAACZ,MACpC,CAAC,CAAC,CAAC,CACH,KAAM,CAAAgB,OAAO,CAAG3B,KAAK,CAACc,GAAG,CAACC,CAAC,GAAK,CAAEa,IAAI,CAAEb,CAAC,CAACc,KAAK,CAAEb,MAAM,CAAED,CAAC,CAACC,MAAO,CAAC,CAAC,CAAC,CACrEb,UAAU,CAAC,CAAE2B,OAAO,CAAEb,GAAG,CAAEc,YAAY,CAAET,IAAI,CAAEU,UAAU,CAAEL,OAAQ,CAAC,CAAC,CACvE,CAAC,CAAE,CAAC3B,KAAK,CAAC,CAAC,CAEX,GAAI,CAACA,KAAK,CAAE,CACV,mBACEH,KAAA,QAAKoC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjCrC,KAAA,WAAQoC,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eACjCvC,IAAA,CAACb,IAAI,EAACqD,EAAE,CAAC,sBAAsB,CAAAD,QAAA,CAAC,eAAQ,CAAM,CAAC,cAC/CvC,IAAA,OAAAuC,QAAA,CAAI,8BAAyB,CAAI,CAAC,EAC5B,CAAC,cACTvC,IAAA,MAAAuC,QAAA,CAAG,4DAA0D,CAAG,CAAC,EAC9D,CAAC,CAEV,CAEA,KAAM,CAAAE,MAAM,CAAG,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,CAElE,mBACEvC,KAAA,QAAKoC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjCrC,KAAA,WAAQoC,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eACjCvC,IAAA,CAACb,IAAI,EAACqD,EAAE,CAAC,sBAAsB,CAAAD,QAAA,CAAC,eAAQ,CAAM,CAAC,cAC/CvC,IAAA,OAAAuC,QAAA,CAAI,8BAAyB,CAAI,CAAC,EAC5B,CAAC,cAETrC,KAAA,QAAKoC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BrC,KAAA,QAAKoC,SAAS,CAAC,aAAa,CAAAC,QAAA,EAAC,sBAAoB,cAAAvC,IAAA,WAAAuC,QAAA,CAAShC,OAAO,CAAC4B,OAAO,CAAS,CAAC,EAAK,CAAC,cACzFjC,KAAA,QAAKoC,SAAS,CAAC,aAAa,CAAAC,QAAA,EAAC,eAAa,cAAAvC,IAAA,WAAAuC,QAAA,CAAShC,OAAO,CAAC8B,UAAU,CAACrB,MAAM,CAAS,CAAC,EAAK,CAAC,EACzF,CAAC,cAENd,KAAA,QAAKoC,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BrC,KAAA,QAAKoC,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BvC,IAAA,OAAAuC,QAAA,CAAI,mCAA8B,CAAI,CAAC,cACvCvC,IAAA,CAACX,mBAAmB,EAACqD,KAAK,CAAC,MAAM,CAACC,MAAM,CAAE,GAAI,CAAAJ,QAAA,cAC5CrC,KAAA,CAACN,QAAQ,EAAA2C,QAAA,eACPvC,IAAA,CAACH,GAAG,EACFgB,IAAI,CAAEN,OAAO,CAAC6B,YAAa,CAC3BQ,OAAO,CAAC,OAAO,CACfC,OAAO,CAAC,QAAQ,CAChBC,EAAE,CAAC,KAAK,CAACC,EAAE,CAAC,KAAK,CACjBC,WAAW,CAAE,EAAG,CAChBC,KAAK,MAAAV,QAAA,CAEJhC,OAAO,CAAC6B,YAAY,CAACjB,GAAG,CAAC,CAAC+B,CAAC,CAACC,CAAC,gBAC5BnD,IAAA,CAACF,IAAI,EAASsD,IAAI,CAAEX,MAAM,CAACU,CAAC,CAAGV,MAAM,CAACzB,MAAM,CAAE,EAAnCmC,CAAqC,CACjD,CAAC,CACC,CAAC,cACNnD,IAAA,CAACN,OAAO,GAAE,CAAC,cACXM,IAAA,CAACL,MAAM,EAAC0D,aAAa,CAAC,QAAQ,CAAE,CAAC,EACzB,CAAC,CACQ,CAAC,EACnB,CAAC,cAENnD,KAAA,QAAKoC,SAAS,CAAC,wBAAwB,CAAAC,QAAA,eACrCvC,IAAA,OAAAuC,QAAA,CAAI,+BAA0B,CAAI,CAAC,cACnCvC,IAAA,CAACX,mBAAmB,EAACqD,KAAK,CAAC,MAAM,CAACC,MAAM,CAAE,GAAI,CAAAJ,QAAA,cAC5CrC,KAAA,CAACZ,QAAQ,EAACuB,IAAI,CAAEN,OAAO,CAAC8B,UAAW,CAACiB,MAAM,CAAE,CAAEC,GAAG,CAAC,EAAE,CAAEC,KAAK,CAAC,EAAE,CAAEC,IAAI,CAAC,CAAC,CAAEC,MAAM,CAAC,CAAE,CAAE,CAAAnB,QAAA,eACjFvC,IAAA,CAACR,KAAK,EAACoD,OAAO,CAAC,MAAM,CAAE,CAAC,cACxB5C,IAAA,CAACP,KAAK,EAACkE,MAAM,CAAE,CAAC,CAAC,CAAC,CAAC,CAAE,CAAE,CAAC,cACxB3D,IAAA,CAACN,OAAO,GAAE,CAAC,cACXM,IAAA,CAACT,GAAG,EAACqD,OAAO,CAAC,QAAQ,CAACQ,IAAI,CAAC,SAAS,CAAE,CAAC,EAC/B,CAAC,CACQ,CAAC,EACnB,CAAC,EACH,CAAC,EACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}