{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useParams,Link}from'react-router-dom';import'../styles/routineTemplates.css';import'./patientTemplates.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function decodeJwt(token){try{const b64=token.split('.')[1].replace(/-/g,'+').replace(/_/g,'/');return JSON.parse(atob(b64));}catch{return null;}}function getPatientId(){var _payload$user;const raw=localStorage.getItem('token');if(!raw)return null;const token=raw.startsWith('Bearer ')?raw.slice(7):raw;const payload=decodeJwt(token);return(payload===null||payload===void 0?void 0:payload.id)||(payload===null||payload===void 0?void 0:payload.sub)||(payload===null||payload===void 0?void 0:(_payload$user=payload.user)===null||_payload$user===void 0?void 0:_payload$user.id)||localStorage.getItem('userId');}export default function PatientTemplateDetail(){var _tpl$tags;const{instanceId}=useParams();const[instance,setInstance]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[allOpen,setAllOpen]=useState(false);useEffect(()=>{async function fetchDetail(){const token=localStorage.getItem('token');const patientId=getPatientId();if(!token||!patientId){setError('No estás autenticado. Por favor, inicia sesión.');setLoading(false);return;}try{const res=await axios.get(`/api/routines/instances/${patientId}`,{headers:{'x-auth-token':token}});const list=Array.isArray(res.data)?res.data:Array.isArray(res.data.instances)?res.data.instances:[];const found=list.find(i=>i._id===instanceId);if(!found){setError('No se encontró la plantilla solicitada.');}else{setInstance(found);}}catch(err){var _err$response,_err$response$data;console.error(err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.msg)||'Error al cargar detalles');}finally{setLoading(false);}}fetchDetail();},[instanceId]);const toggleActivity=async idx=>{const token=localStorage.getItem('token');if(!token||!instance)return;const was=instance.completedActivities.includes(idx);try{await axios.post(`/api/routines/instances/${instanceId}/activities/${idx}`,{completed:!was},{headers:{'x-auth-token':token}});setInstance(inst=>({...inst,completedActivities:was?inst.completedActivities.filter(i=>i!==idx):[...inst.completedActivities,idx]}));}catch(err){console.error(err);setError('No se pudo actualizar la actividad.');}};const markAll=async completed=>{const token=localStorage.getItem('token');if(!token||!instance)return;// marcaremos todas las actividades secuencialmente\nconst updates=instance.template.activities.map((_,idx)=>axios.post(`/api/routines/instances/${instanceId}/activities/${idx}`,{completed},{headers:{'x-auth-token':token}}));try{await Promise.all(updates);setInstance(inst=>({...inst,completedActivities:completed?instance.template.activities.map((_,i)=>i):[]}));}catch{setError('Error al marcar todas las actividades.');}};if(loading)return/*#__PURE__*/_jsx(\"p\",{className:\"loading\",children:\"Cargando detalles\\u2026\"});if(error)return/*#__PURE__*/_jsx(\"p\",{className:\"error-msg\",children:error});if(!instance)return null;const tpl=instance.template;const total=tpl.activities.length;const doneCount=instance.completedActivities.length;const pct=Math.round(doneCount/total*100);return/*#__PURE__*/_jsxs(\"div\",{className:\"routine-templates-page tpl-detail-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-detail-header\",children:[/*#__PURE__*/_jsx(Link,{to:\"/patient/templates\",className:\"back-link\",children:\"\\u2190 Volver\"}),/*#__PURE__*/_jsx(\"div\",{className:\"tpl-cover\",children:/*#__PURE__*/_jsx(\"img\",{src:tpl.coverUrl||'/images/cover-placeholder.jpg',alt:\"Portada\",className:\"tpl-cover-img\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-info\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"tpl-name\",children:tpl.name}),/*#__PURE__*/_jsx(\"p\",{className:\"tpl-desc-wide\",children:tpl.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-meta-detail\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-clock-o\"}),\" \",tpl.duration,\" min\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-tachometer\"}),\" Nivel \",tpl.challengeLevel]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-tags\"}),\" \",(_tpl$tags=tpl.tags)===null||_tpl$tags===void 0?void 0:_tpl$tags.join(', ')]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-calendar\"}),\" \",new Date(instance.createdAt).toLocaleDateString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-progress\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill\",style:{width:`${pct}%`},\"aria-label\":`${pct}% completado`})}),/*#__PURE__*/_jsxs(\"span\",{className:\"progress-label\",children:[doneCount,\" / \",total,\" completadas (\",pct,\"%)\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>markAll(true),className:\"btn-small\",children:\"Marcar todo\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>markAll(false),className:\"btn-small btn-outline\",children:\"Reiniciar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setAllOpen(!allOpen),className:\"btn-small\",children:allOpen?'Cerrar todo':'Abrir todo'})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"tpl-activities-detail\",children:tpl.activities.map((act,i)=>{const completed=instance.completedActivities.includes(i);return/*#__PURE__*/_jsxs(\"details\",{className:`activity-panel ${completed?'done':''}`,open:allOpen,children:[/*#__PURE__*/_jsxs(\"summary\",{onClick:()=>toggleActivity(i),children:[/*#__PURE__*/_jsx(\"span\",{className:\"act-title\",children:act.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"act-meta\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-tachometer\"}),\" \",act.challenge,\"\\xA0|\\xA0\",/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-clock-o\"}),\" \",act.minutes,\" min\"]}),/*#__PURE__*/_jsx(\"i\",{className:`fa ${completed?'fa-check-circle':'fa-circle-o'}`})]}),act.desc&&/*#__PURE__*/_jsx(\"p\",{className:\"activity-desc\",children:act.desc}),/*#__PURE__*/_jsxs(\"div\",{className:\"activity-notes\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Notas:\"}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"A\\xF1ade tus comentarios...\",rows:\"2\"})]})]},i);})})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","useParams","Link","jsx","_jsx","jsxs","_jsxs","decodeJwt","token","b64","split","replace","JSON","parse","atob","getPatientId","_payload$user","raw","localStorage","getItem","startsWith","slice","payload","id","sub","user","PatientTemplateDetail","_tpl$tags","instanceId","instance","setInstance","loading","setLoading","error","setError","allOpen","setAllOpen","fetchDetail","patientId","res","get","headers","list","Array","isArray","data","instances","found","find","i","_id","err","_err$response","_err$response$data","console","response","msg","toggleActivity","idx","was","completedActivities","includes","post","completed","inst","filter","markAll","updates","template","activities","map","_","Promise","all","className","children","tpl","total","length","doneCount","pct","Math","round","to","src","coverUrl","alt","name","description","duration","challengeLevel","tags","join","Date","createdAt","toLocaleDateString","style","width","onClick","act","open","challenge","minutes","desc","placeholder","rows"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/PatientTemplateDetail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport '../styles/routineTemplates.css';\r\nimport './patientTemplates.css';\r\n\r\nfunction decodeJwt(token) {\r\n  try {\r\n    const b64 = token.split('.')[1]\r\n      .replace(/-/g, '+')\r\n      .replace(/_/g, '/');\r\n    return JSON.parse(atob(b64));\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction getPatientId() {\r\n  const raw = localStorage.getItem('token');\r\n  if (!raw) return null;\r\n  const token = raw.startsWith('Bearer ') ? raw.slice(7) : raw;\r\n  const payload = decodeJwt(token);\r\n  return payload?.id || payload?.sub || payload?.user?.id || localStorage.getItem('userId');\r\n}\r\n\r\nexport default function PatientTemplateDetail() {\r\n  const { instanceId } = useParams();\r\n  const [instance, setInstance] = useState(null);\r\n  const [loading, setLoading]   = useState(true);\r\n  const [error, setError]       = useState(null);\r\n  const [allOpen, setAllOpen]   = useState(false);\r\n\r\n  useEffect(() => {\r\n    async function fetchDetail() {\r\n      const token     = localStorage.getItem('token');\r\n      const patientId = getPatientId();\r\n      if (!token || !patientId) {\r\n        setError('No estás autenticado. Por favor, inicia sesión.');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      try {\r\n        const res = await axios.get(\r\n          `/api/routines/instances/${patientId}`,\r\n          { headers: { 'x-auth-token': token } }\r\n        );\r\n        const list = Array.isArray(res.data)\r\n          ? res.data\r\n          : Array.isArray(res.data.instances)\r\n            ? res.data.instances\r\n            : [];\r\n        const found = list.find(i => i._id === instanceId);\r\n        if (!found) {\r\n          setError('No se encontró la plantilla solicitada.');\r\n        } else {\r\n          setInstance(found);\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n        setError(err.response?.data?.msg || 'Error al cargar detalles');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    fetchDetail();\r\n  }, [instanceId]);\r\n\r\n  const toggleActivity = async idx => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token || !instance) return;\r\n    const was = instance.completedActivities.includes(idx);\r\n    try {\r\n      await axios.post(\r\n        `/api/routines/instances/${instanceId}/activities/${idx}`,\r\n        { completed: !was },\r\n        { headers: { 'x-auth-token': token } }\r\n      );\r\n      setInstance(inst => ({\r\n        ...inst,\r\n        completedActivities: was\r\n          ? inst.completedActivities.filter(i => i !== idx)\r\n          : [...inst.completedActivities, idx]\r\n      }));\r\n    } catch (err) {\r\n      console.error(err);\r\n      setError('No se pudo actualizar la actividad.');\r\n    }\r\n  };\r\n\r\n  const markAll = async completed => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token || !instance) return;\r\n    // marcaremos todas las actividades secuencialmente\r\n    const updates = instance.template.activities.map((_, idx) =>\r\n      axios.post(\r\n        `/api/routines/instances/${instanceId}/activities/${idx}`,\r\n        { completed },\r\n        { headers: { 'x-auth-token': token } }\r\n      )\r\n    );\r\n    try {\r\n      await Promise.all(updates);\r\n      setInstance(inst => ({\r\n        ...inst,\r\n        completedActivities: completed\r\n          ? instance.template.activities.map((_, i) => i)\r\n          : []\r\n      }));\r\n    } catch {\r\n      setError('Error al marcar todas las actividades.');\r\n    }\r\n  };\r\n\r\n  if (loading) return <p className=\"loading\">Cargando detalles…</p>;\r\n  if (error)   return <p className=\"error-msg\">{error}</p>;\r\n  if (!instance) return null;\r\n\r\n  const tpl       = instance.template;\r\n  const total     = tpl.activities.length;\r\n  const doneCount = instance.completedActivities.length;\r\n  const pct       = Math.round((doneCount / total) * 100);\r\n\r\n  return (\r\n    <div className=\"routine-templates-page tpl-detail-page\">\r\n      <div className=\"tpl-detail-header\">\r\n        <Link to=\"/patient/templates\" className=\"back-link\">← Volver</Link>\r\n        <div className=\"tpl-cover\">\r\n          {/* Imagen de portada de plantilla (maqueta) */}\r\n          <img src={tpl.coverUrl || '/images/cover-placeholder.jpg'}\r\n               alt=\"Portada\"\r\n               className=\"tpl-cover-img\" />\r\n        </div>\r\n        <div className=\"tpl-info\">\r\n          <h1 className=\"tpl-name\">{tpl.name}</h1>\r\n          <p className=\"tpl-desc-wide\">{tpl.description}</p>\r\n          <div className=\"tpl-meta-detail\">\r\n            <span><i className=\"fa fa-clock-o\"></i> {tpl.duration} min</span>\r\n            <span><i className=\"fa fa-tachometer\"></i> Nivel {tpl.challengeLevel}</span>\r\n            <span><i className=\"fa fa-tags\"></i> {tpl.tags?.join(', ')}</span>\r\n            <span><i className=\"fa fa-calendar\"></i> {new Date(instance.createdAt).toLocaleDateString()}</span>\r\n          </div>\r\n          <div className=\"tpl-progress\">\r\n            <div className=\"progress-bar\">\r\n              <div\r\n                className=\"progress-fill\"\r\n                style={{ width: `${pct}%` }}\r\n                aria-label={`${pct}% completado`}\r\n              />\r\n            </div>\r\n            <span className=\"progress-label\">{doneCount} / {total} completadas ({pct}%)</span>\r\n          </div>\r\n          <div className=\"tpl-actions\">\r\n            <button onClick={() => markAll(true)}  className=\"btn-small\">Marcar todo</button>\r\n            <button onClick={() => markAll(false)} className=\"btn-small btn-outline\">Reiniciar</button>\r\n            <button onClick={() => setAllOpen(!allOpen)} className=\"btn-small\">\r\n              {allOpen ? 'Cerrar todo' : 'Abrir todo'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"tpl-activities-detail\">\r\n        {tpl.activities.map((act, i) => {\r\n          const completed = instance.completedActivities.includes(i);\r\n          return (\r\n            <details\r\n              key={i}\r\n              className={`activity-panel ${completed ? 'done' : ''}`}\r\n              open={allOpen}\r\n            >\r\n              <summary onClick={() => toggleActivity(i)}>\r\n                <span className=\"act-title\">{act.name}</span>\r\n                <span className=\"act-meta\">\r\n                  <i className=\"fa fa-tachometer\"></i> {act.challenge}\r\n                  &nbsp;|&nbsp;\r\n                  <i className=\"fa fa-clock-o\"></i> {act.minutes} min\r\n                </span>\r\n                <i className={`fa ${completed ? 'fa-check-circle' : 'fa-circle-o'}`}></i>\r\n              </summary>\r\n              {act.desc && <p className=\"activity-desc\">{act.desc}</p>}\r\n              <div className=\"activity-notes\">\r\n                <label>Notas:</label>\r\n                <textarea\r\n                  placeholder=\"Añade tus comentarios...\"\r\n                  rows=\"2\"\r\n                />\r\n              </div>\r\n            </details>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}