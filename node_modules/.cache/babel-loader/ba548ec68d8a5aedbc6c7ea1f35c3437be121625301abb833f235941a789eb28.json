{"ast":null,"code":"// src/pages/PatientTemplatesPage.js\nimport React,{useState,useEffect}from'react';import{FaChevronDown,FaChevronUp,FaCheckCircle,FaRegCircle}from'react-icons/fa';import'../styles/routineTemplates.css';// Estilos de tarjetas y grid :contentReference[oaicite:0]{index=0}:contentReference[oaicite:1]{index=1}\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function PatientTemplatesPage(){const[instances,setInstances]=useState([]);const[filtered,setFiltered]=useState([]);const[expanded,setExpanded]=useState({});const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[search,setSearch]=useState('');const[statusFilter,setStatusFilter]=useState('all');const[sortOption,setSortOption]=useState('name');const[currentPage,setCurrentPage]=useState(1);const itemsPerPage=6;const navigate=useNavigate();const token=localStorage.getItem('token');// Decodificar patientId desde el payload del JWT :contentReference[oaicite:2]{index=2}:contentReference[oaicite:3]{index=3}\nlet patientId=null;if(token){try{var _payload$user;const payload=JSON.parse(atob(token.split('.')[1]));patientId=((_payload$user=payload.user)===null||_payload$user===void 0?void 0:_payload$user.id)||payload.id||payload.sub;}catch(e){console.error('Token inválido:',e);}}// Fetch de instancias asignadas :contentReference[oaicite:4]{index=4}:contentReference[oaicite:5]{index=5}\nuseEffect(()=>{if(!token||!patientId){navigate('/login');return;}const headers={'Content-Type':'application/json','x-auth-token':token};fetch(`/api/routines/instances/${patientId}`,{headers}).then(res=>{if(res.status===401){alert('Sesión expirada. Inicia sesión de nuevo.');navigate('/login');return null;}if(!res.ok)throw new Error(`Error ${res.status}`);return res.json();}).then(data=>Array.isArray(data)?setInstances(data):setError('Respuesta inesperada')).catch(err=>setError(err.message)).finally(()=>setLoading(false));},[navigate,token,patientId]);// Aplicar búsqueda, filtro y orden sobre instances\nuseEffect(()=>{let list=[...instances];// búsqueda por nombre\nif(search){list=list.filter(i=>i.template.name.toLowerCase().includes(search.toLowerCase()));}// filtro por estado\nif(statusFilter!=='all'){list=list.filter(i=>i.status===statusFilter);}// orden\nlist.sort((a,b)=>{if(sortOption==='name'){return a.template.name.localeCompare(b.template.name);}else if(sortOption==='progress'){const pa=a.completedActivities.length/a.template.activities.length;const pb=b.completedActivities.length/b.template.activities.length;return pb-pa;}return 0;});setFiltered(list);setCurrentPage(1);},[instances,search,statusFilter,sortOption]);// Helpers de interacción\nconst toggleExpand=id=>{setExpanded(e=>({...e,[id]:!e[id]}));};const markActivity=(instId,idx)=>{const headers={'Content-Type':'application/json','x-auth-token':token};fetch(`/api/routines/instances/${instId}/activities/${idx}`,{method:'POST',headers,body:JSON.stringify({completed:true})}).then(res=>{if(!res.ok)throw new Error('No se pudo actualizar');// actualizar local\nsetInstances(list=>list.map(i=>{if(i._id!==instId)return i;const set=new Set(i.completedActivities);set.add(idx);return{...i,completedActivities:Array.from(set)};}));}).catch(console.error);};const completeAll=inst=>{inst.template.activities.forEach((_,idx)=>{if(!inst.completedActivities.includes(idx)){markActivity(inst._id,idx);}});};const postpone=instId=>{setInstances(list=>list.map(i=>i._id===instId?{...i,status:'postponed'}:i));};// Paginación\nconst totalPages=Math.ceil(filtered.length/itemsPerPage);const paginated=filtered.slice((currentPage-1)*itemsPerPage,currentPage*itemsPerPage);if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"tpl-container\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Cargando\\u2026\"})});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"tpl-container\",children:/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error})});return/*#__PURE__*/_jsx(\"div\",{className:\"routine-templates-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"tpl-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Mis Plantillas Asignadas\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Buscar por nombre\\u2026\",value:search,onChange:e=>setSearch(e.target.value)}),/*#__PURE__*/_jsxs(\"select\",{value:statusFilter,onChange:e=>setStatusFilter(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"Todas\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"Pendientes\"}),/*#__PURE__*/_jsx(\"option\",{value:\"completed\",children:\"Completadas\"}),/*#__PURE__*/_jsx(\"option\",{value:\"postponed\",children:\"Pospuestas\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:sortOption,onChange:e=>setSortOption(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"name\",children:\"Ordenar por nombre\"}),/*#__PURE__*/_jsx(\"option\",{value:\"progress\",children:\"Ordenar por progreso\"})]})]}),paginated.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"empty-state\",children:\"\\uD83E\\uDD14 No hay plantillas que mostrar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"tpl-grid\",children:paginated.map(inst=>{const total=inst.template.activities.length;const done=inst.completedActivities.length;const pct=total?done/total*100:0;const statusClass=inst.status==='completed'?'status-completed':inst.status==='postponed'?'status-postponed':'';return/*#__PURE__*/_jsxs(\"div\",{className:`tpl-card ${statusClass}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"assign-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:inst.template.name}),/*#__PURE__*/_jsx(\"p\",{className:\"tpl-desc\",children:inst.template.description})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-icon\",onClick:()=>toggleExpand(inst._id),children:expanded[inst._id]?/*#__PURE__*/_jsx(FaChevronUp,{}):/*#__PURE__*/_jsx(FaChevronDown,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"progress-container\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[done,\"/\",total,\" completadas\"]}),/*#__PURE__*/_jsx(\"progress\",{value:pct,max:\"100\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"assign-actions\",children:[inst.status==='pending'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-complete\",onClick:()=>completeAll(inst),children:\"Completar todo\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-postpone\",onClick:()=>postpone(inst._id),children:\"Posponer\"})]}),inst.status==='completed'&&/*#__PURE__*/_jsx(\"span\",{children:\"\\u2714\\uFE0F Completado\"}),inst.status==='postponed'&&/*#__PURE__*/_jsx(\"span\",{children:\"\\u23F3 Pospuesto\"})]}),expanded[inst._id]&&/*#__PURE__*/_jsx(\"div\",{className:\"activities-list\",children:inst.template.activities.map((act,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:`activity-line ${inst.completedActivities.includes(idx)?'completed':''}`,children:[/*#__PURE__*/_jsxs(\"div\",{children:[inst.completedActivities.includes(idx)?/*#__PURE__*/_jsx(FaCheckCircle,{}):/*#__PURE__*/_jsx(FaRegCircle,{}),/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:'0.5rem'},children:act.name})]}),!inst.completedActivities.includes(idx)&&/*#__PURE__*/_jsx(\"button\",{className:\"btn-complete\",onClick:()=>markActivity(inst._id,idx),children:\"Marcar\"})]},idx))})]},inst._id);})}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',margin:'2rem 0'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(p=>Math.max(p-1,1)),disabled:currentPage===1,children:\"\\xAB Anterior\"}),/*#__PURE__*/_jsxs(\"span\",{style:{margin:'0 1rem'},children:[currentPage,\" / \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(p=>Math.min(p+1,totalPages)),disabled:currentPage===totalPages,children:\"Siguiente \\xBB\"})]})]})});}","map":{"version":3,"names":["React","useState","useEffect","FaChevronDown","FaChevronUp","FaCheckCircle","FaRegCircle","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PatientTemplatesPage","instances","setInstances","filtered","setFiltered","expanded","setExpanded","loading","setLoading","error","setError","search","setSearch","statusFilter","setStatusFilter","sortOption","setSortOption","currentPage","setCurrentPage","itemsPerPage","navigate","useNavigate","token","localStorage","getItem","patientId","_payload$user","payload","JSON","parse","atob","split","user","id","sub","e","console","headers","fetch","then","res","status","alert","ok","Error","json","data","Array","isArray","catch","err","message","finally","list","filter","i","template","name","toLowerCase","includes","sort","a","b","localeCompare","pa","completedActivities","length","activities","pb","toggleExpand","markActivity","instId","idx","method","body","stringify","completed","map","_id","set","Set","add","from","completeAll","inst","forEach","_","postpone","totalPages","Math","ceil","paginated","slice","className","children","style","color","type","placeholder","value","onChange","target","total","done","pct","statusClass","description","onClick","max","act","marginLeft","textAlign","margin","p","disabled","min"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/PatientTemplatesPage.js"],"sourcesContent":["// src/pages/PatientTemplatesPage.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport {\r\n  FaChevronDown,\r\n  FaChevronUp,\r\n  FaCheckCircle,\r\n  FaRegCircle\r\n} from 'react-icons/fa';\r\nimport '../styles/routineTemplates.css'; // Estilos de tarjetas y grid :contentReference[oaicite:0]{index=0}:contentReference[oaicite:1]{index=1}\r\n\r\nexport default function PatientTemplatesPage() {\r\n  const [instances, setInstances]       = useState([]);\r\n  const [filtered, setFiltered]         = useState([]);\r\n  const [expanded, setExpanded]         = useState({});\r\n  const [loading, setLoading]           = useState(true);\r\n  const [error, setError]               = useState(null);\r\n  const [search, setSearch]             = useState('');\r\n  const [statusFilter, setStatusFilter] = useState('all');\r\n  const [sortOption, setSortOption]     = useState('name');\r\n  const [currentPage, setCurrentPage]   = useState(1);\r\n  const itemsPerPage = 6;\r\n\r\n  const navigate = useNavigate();\r\n  const token    = localStorage.getItem('token');\r\n\r\n  // Decodificar patientId desde el payload del JWT :contentReference[oaicite:2]{index=2}:contentReference[oaicite:3]{index=3}\r\n  let patientId = null;\r\n  if (token) {\r\n    try {\r\n      const payload = JSON.parse(atob(token.split('.')[1]));\r\n      patientId = payload.user?.id || payload.id || payload.sub;\r\n    } catch (e) {\r\n      console.error('Token inválido:', e);\r\n    }\r\n  }\r\n\r\n  // Fetch de instancias asignadas :contentReference[oaicite:4]{index=4}:contentReference[oaicite:5]{index=5}\r\n  useEffect(() => {\r\n    if (!token || !patientId) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n    const headers = {\r\n      'Content-Type': 'application/json',\r\n      'x-auth-token': token\r\n    };\r\n    fetch(`/api/routines/instances/${patientId}`, { headers })\r\n      .then(res => {\r\n        if (res.status === 401) {\r\n          alert('Sesión expirada. Inicia sesión de nuevo.');\r\n          navigate('/login');\r\n          return null;\r\n        }\r\n        if (!res.ok) throw new Error(`Error ${res.status}`);\r\n        return res.json();\r\n      })\r\n      .then(data => Array.isArray(data) ? setInstances(data) : setError('Respuesta inesperada'))\r\n      .catch(err => setError(err.message))\r\n      .finally(() => setLoading(false));\r\n  }, [navigate, token, patientId]);\r\n\r\n  // Aplicar búsqueda, filtro y orden sobre instances\r\n  useEffect(() => {\r\n    let list = [...instances];\r\n    // búsqueda por nombre\r\n    if (search) {\r\n      list = list.filter(i =>\r\n        i.template.name.toLowerCase().includes(search.toLowerCase())\r\n      );\r\n    }\r\n    // filtro por estado\r\n    if (statusFilter !== 'all') {\r\n      list = list.filter(i => i.status === statusFilter);\r\n    }\r\n    // orden\r\n    list.sort((a, b) => {\r\n      if (sortOption === 'name') {\r\n        return a.template.name.localeCompare(b.template.name);\r\n      } else if (sortOption === 'progress') {\r\n        const pa = a.completedActivities.length / a.template.activities.length;\r\n        const pb = b.completedActivities.length / b.template.activities.length;\r\n        return pb - pa;\r\n      }\r\n      return 0;\r\n    });\r\n    setFiltered(list);\r\n    setCurrentPage(1);\r\n  }, [instances, search, statusFilter, sortOption]);\r\n\r\n  // Helpers de interacción\r\n  const toggleExpand = id => {\r\n    setExpanded(e => ({ ...e, [id]: !e[id] }));\r\n  };\r\n  const markActivity = (instId, idx) => {\r\n    const headers = { 'Content-Type':'application/json','x-auth-token':token };\r\n    fetch(`/api/routines/instances/${instId}/activities/${idx}`, {\r\n      method: 'POST', headers, body: JSON.stringify({ completed: true })\r\n    })\r\n      .then(res => {\r\n        if (!res.ok) throw new Error('No se pudo actualizar');\r\n        // actualizar local\r\n        setInstances(list =>\r\n          list.map(i => {\r\n            if (i._id !== instId) return i;\r\n            const set = new Set(i.completedActivities);\r\n            set.add(idx);\r\n            return { ...i, completedActivities: Array.from(set) };\r\n          })\r\n        );\r\n      })\r\n      .catch(console.error);\r\n  };\r\n  const completeAll = inst => {\r\n    inst.template.activities.forEach((_, idx) => {\r\n      if (!inst.completedActivities.includes(idx)) {\r\n        markActivity(inst._id, idx);\r\n      }\r\n    });\r\n  };\r\n  const postpone = instId => {\r\n    setInstances(list =>\r\n      list.map(i => i._id === instId ? { ...i, status: 'postponed' } : i)\r\n    );\r\n  };\r\n\r\n  // Paginación\r\n  const totalPages = Math.ceil(filtered.length / itemsPerPage);\r\n  const paginated = filtered.slice(\r\n    (currentPage-1)*itemsPerPage,\r\n    currentPage*itemsPerPage\r\n  );\r\n\r\n  if (loading) return <div className=\"tpl-container\"><p>Cargando…</p></div>;\r\n  if (error)   return <div className=\"tpl-container\"><p style={{color:'red'}}>{error}</p></div>;\r\n\r\n  return (\r\n    <div className=\"routine-templates-page\">\r\n      <div className=\"tpl-container\">\r\n        <h1>Mis Plantillas Asignadas</h1>\r\n\r\n        {/* Búsqueda y filtros */}\r\n        <div className=\"filter-section\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Buscar por nombre…\"\r\n            value={search}\r\n            onChange={e=>setSearch(e.target.value)}\r\n          />\r\n          <select value={statusFilter} onChange={e=>setStatusFilter(e.target.value)}>\r\n            <option value=\"all\">Todas</option>\r\n            <option value=\"pending\">Pendientes</option>\r\n            <option value=\"completed\">Completadas</option>\r\n            <option value=\"postponed\">Pospuestas</option>\r\n          </select>\r\n          <select value={sortOption} onChange={e=>setSortOption(e.target.value)}>\r\n            <option value=\"name\">Ordenar por nombre</option>\r\n            <option value=\"progress\">Ordenar por progreso</option>\r\n          </select>\r\n        </div>\r\n\r\n        {paginated.length === 0 ? (\r\n          <div className=\"empty-state\">\r\n            🤔 No hay plantillas que mostrar\r\n          </div>\r\n        ) : (\r\n          <div className=\"tpl-grid\">\r\n            {paginated.map(inst => {\r\n              const total = inst.template.activities.length;\r\n              const done  = inst.completedActivities.length;\r\n              const pct   = total ? (done/total)*100 : 0;\r\n              const statusClass =\r\n                inst.status==='completed' ? 'status-completed' :\r\n                inst.status==='postponed'  ? 'status-postponed' : '';\r\n\r\n              return (\r\n                <div key={inst._id} className={`tpl-card ${statusClass}`}>\r\n                  <div className=\"assign-header\">\r\n                    <div>\r\n                      <h2>{inst.template.name}</h2>\r\n                      <p className=\"tpl-desc\">{inst.template.description}</p>\r\n                    </div>\r\n                    <button className=\"btn-icon\" onClick={()=>toggleExpand(inst._id)}>\r\n                      {expanded[inst._id] ? <FaChevronUp/> : <FaChevronDown/>}\r\n                    </button>\r\n                  </div>\r\n\r\n                  <div className=\"progress-container\">\r\n                    <label>{done}/{total} completadas</label>\r\n                    <progress value={pct} max=\"100\"/>\r\n                  </div>\r\n\r\n                  <div className=\"assign-actions\">\r\n                    {inst.status==='pending' && (\r\n                      <>\r\n                        <button className=\"btn-complete\" onClick={()=>completeAll(inst)}>\r\n                          Completar todo\r\n                        </button>\r\n                        <button className=\"btn-postpone\" onClick={()=>postpone(inst._id)}>\r\n                          Posponer\r\n                        </button>\r\n                      </>\r\n                    )}\r\n                    {inst.status==='completed' && <span>✔️ Completado</span>}\r\n                    {inst.status==='postponed'  && <span>⏳ Pospuesto</span>}\r\n                  </div>\r\n\r\n                  {expanded[inst._id] && (\r\n                    <div className=\"activities-list\">\r\n                      {inst.template.activities.map((act, idx) => (\r\n                        <div key={idx}\r\n                          className={`activity-line ${inst.completedActivities.includes(idx)?'completed':''}`}>\r\n                          <div>\r\n                            {inst.completedActivities.includes(idx)\r\n                              ? <FaCheckCircle/>\r\n                              : <FaRegCircle/>}\r\n                            <span style={{marginLeft:'0.5rem'}}>{act.name}</span>\r\n                          </div>\r\n                          {!inst.completedActivities.includes(idx) && (\r\n                            <button\r\n                              className=\"btn-complete\"\r\n                              onClick={()=>markActivity(inst._id, idx)}>\r\n                              Marcar\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n\r\n        {/* Paginación */}\r\n        {totalPages > 1 && (\r\n          <div style={{textAlign:'center', margin:'2rem 0'}}>\r\n            <button\r\n              onClick={()=>setCurrentPage(p=>Math.max(p-1,1))}\r\n              disabled={currentPage===1}\r\n            >« Anterior</button>\r\n            <span style={{margin:'0 1rem'}}>{currentPage} / {totalPages}</span>\r\n            <button\r\n              onClick={()=>setCurrentPage(p=>Math.min(p+1,totalPages))}\r\n              disabled={currentPage===totalPages}\r\n            >Siguiente »</button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}