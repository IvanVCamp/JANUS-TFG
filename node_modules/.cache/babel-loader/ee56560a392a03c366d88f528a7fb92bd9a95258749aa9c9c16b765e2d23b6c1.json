{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import chatService from'../services/chatService';import'../styles/messaging.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Messaging(){const navigate=useNavigate();// ID del usuario actual\nconst[currentUserId,setCurrentUserId]=useState(null);// Lista de chats, chat seleccionado, mensajes\nconst[chats,setChats]=useState([]);const[selectedChatId,setSelectedChatId]=useState(null);const[messages,setMessages]=useState([]);// B√∫squeda de usuarios\nconst[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);// Texto del mensaje (comentario opcional) y archivo adjunto\nconst[newMessage,setNewMessage]=useState('');const[file,setFile]=useState(null);// Vista previa del archivo\nconst[filePreview,setFilePreview]=useState(null);// Decodificar el token para obtener el ID del usuario (simplificado)\nuseEffect(()=>{const token=localStorage.getItem('token');if(token){var _decoded$user;const decoded=JSON.parse(atob(token.split('.')[1]));setCurrentUserId((_decoded$user=decoded.user)===null||_decoded$user===void 0?void 0:_decoded$user.id);}},[]);// Cargar la lista de chats\nuseEffect(()=>{async function fetchChats(){try{const data=await chatService.getChats();setChats(data);}catch(err){console.error('Error obteniendo chats:',err);}}fetchChats();},[]);// Cargar mensajes al seleccionar un chat\nuseEffect(()=>{if(selectedChatId){async function fetchMessages(){try{const data=await chatService.getMessages(selectedChatId);setMessages(data);}catch(err){console.error('Error obteniendo mensajes:',err);}}fetchMessages();}else{setMessages([]);}},[selectedChatId]);// B√∫squeda con debounce\nuseEffect(()=>{const delayDebounceFn=setTimeout(()=>{if(searchQuery.trim()){chatService.searchUsers(searchQuery.trim()).then(results=>setSearchResults(results)).catch(err=>{console.error('Error buscando usuarios:',err);setSearchResults([]);});}else{setSearchResults([]);}},300);return()=>clearTimeout(delayDebounceFn);},[searchQuery]);const handleSearchChange=e=>{setSearchQuery(e.target.value);};const handleSelectUser=async user=>{try{const newChat=await chatService.startChat(user._id);setChats(prev=>[...prev,newChat]);setSelectedChatId(newChat._id||newChat.id);setSearchQuery('');setSearchResults([]);}catch(err){console.error('Error iniciando chat:',err);}};const handleFileChange=e=>{if(e.target.files&&e.target.files.length>0){const selectedFile=e.target.files[0];setFile(selectedFile);const previewURL=URL.createObjectURL(selectedFile);const sizeKB=(selectedFile.size/1024).toFixed(1);setFilePreview({name:selectedFile.name,sizeKB,type:selectedFile.type,previewURL});setNewMessage('');}};const handleCancelPreview=()=>{setFile(null);setFilePreview(null);setNewMessage('');};const handleSendMessage=async()=>{if(!selectedChatId)return;if(!file&&!newMessage.trim())return;try{const formData=new FormData();formData.append('text',newMessage);if(file)formData.append('file',file);const msgCreated=await chatService.sendMessage(selectedChatId,formData);setMessages(prev=>[...prev,msgCreated]);setNewMessage('');setFile(null);setFilePreview(null);setChats(prevChats=>prevChats.map(c=>c._id===selectedChatId||c.id===selectedChatId?{...c,lastMessage:msgCreated}:c));}catch(err){console.error('Error enviando mensaje:',err);}};const handleLogout=()=>{navigate('/');};// Bot√≥n para regresar al Dashboard\nconst handleGoDashboard=()=>{navigate('/dashboard');};const getOtherParticipant=chat=>{if(!chat.participants||!currentUserId)return null;return chat.participants.find(p=>p._id!==currentUserId);};const renderChatList=()=>{if(chats.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"no-chats\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Comienza a conversar ahora con tus especialistas! \\uD83D\\uDE0A\"})});}return/*#__PURE__*/_jsx(\"ul\",{className:\"chat-list\",children:chats.map(chat=>{const chatId=chat._id||chat.id;const otherUser=getOtherParticipant(chat);const isSelected=chatId===selectedChatId;return/*#__PURE__*/_jsxs(\"li\",{className:`chat-item ${isSelected?'selected':''}`,onClick:()=>setSelectedChatId(chatId),children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat-avatar\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-user-circle\",\"aria-hidden\":\"true\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-info\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"chat-name\",children:otherUser?`${otherUser.nombre} ${otherUser.apellidos}`:'Usuario desconocido'}),chat.lastMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"chat-last-message\",children:chat.lastMessage.text?chat.lastMessage.text:'[Archivo adjunto]'})]})]},chatId);})});};const renderFilePreview=()=>{if(!filePreview)return null;const isImage=filePreview.type.startsWith('image/');return/*#__PURE__*/_jsxs(\"div\",{className:\"file-preview-container\",children:[isImage?/*#__PURE__*/_jsx(\"img\",{src:filePreview.previewURL,alt:\"Vista previa\",className:\"file-preview-image\"}):/*#__PURE__*/_jsx(\"div\",{className:\"file-preview-placeholder\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-file-pdf-o\",\"aria-hidden\":\"true\"})}),/*#__PURE__*/_jsxs(\"p\",{className:\"file-preview-name\",children:[filePreview.name,\" (\",filePreview.sizeKB,\" KB)\"]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"file-preview-comment\",placeholder:\"Comentario (opcional)\",value:newMessage,onChange:e=>setNewMessage(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-preview-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelPreview,className:\"btn-cancel\",children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,className:\"btn-send\",children:\"Enviar\"})]})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"messaging-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"top-bar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left-section\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-dashboard-btn\",onClick:handleGoDashboard,children:\"\\u2190\"}),/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-user-circle user-icon\",\"aria-hidden\":\"true\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"center-section\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"JANUS\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"right-section\",children:/*#__PURE__*/_jsx(\"button\",{className:\"logout-btn\",onClick:handleLogout,children:\"Cerrar Sesi\\xF3n\"})})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"messaging-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-list-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-bar\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Buscar usuarios...\",value:searchQuery,onChange:handleSearchChange}),searchResults.length>0&&/*#__PURE__*/_jsx(\"ul\",{className:\"search-dropdown\",children:searchResults.map(user=>/*#__PURE__*/_jsxs(\"li\",{className:\"search-dropdown-item\",onClick:()=>handleSelectUser(user),children:[user.nombre,\" \",user.apellidos,\" (\",user.email,\")\"]},user._id))})]}),renderChatList()]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-detail\",children:selectedChatId?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"messages-area\",children:messages.map((msg,idx)=>{var _msg$sender;const isOutgoing=((_msg$sender=msg.sender)===null||_msg$sender===void 0?void 0:_msg$sender._id)===currentUserId||msg.sender===currentUserId;return/*#__PURE__*/_jsxs(\"div\",{className:`message-item ${isOutgoing?'message-outgoing':'message-incoming'}`,children:[/*#__PURE__*/_jsx(\"p\",{className:\"message-text\",children:msg.text}),msg.fileUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"message-file\",children:/*#__PURE__*/_jsx(\"a\",{href:msg.fileUrl,download:true,children:msg.fileName||'Descargar archivo'})})]},idx);})}),filePreview?renderFilePreview():/*#__PURE__*/_jsxs(\"div\",{className:\"new-message-area\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",className:\"attach-btn\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-paperclip\",\"aria-hidden\":\"true\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:'none'},onChange:handleFileChange}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"message-input\",placeholder:\"Escribe algo...\",value:newMessage,onChange:e=>setNewMessage(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"send-btn\",onClick:handleSendMessage,children:\"Enviar\"})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"no-chat-selected\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Selecciona un chat para ver los mensajes\"})})})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"footer-bar\",children:/*#__PURE__*/_jsx(\"p\",{children:\"2025 \\xA9 Iv\\xE1n Vela Campos\"})})]});}export default Messaging;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","chatService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Messaging","navigate","currentUserId","setCurrentUserId","chats","setChats","selectedChatId","setSelectedChatId","messages","setMessages","searchQuery","setSearchQuery","searchResults","setSearchResults","newMessage","setNewMessage","file","setFile","filePreview","setFilePreview","token","localStorage","getItem","_decoded$user","decoded","JSON","parse","atob","split","user","id","fetchChats","data","getChats","err","console","error","fetchMessages","getMessages","delayDebounceFn","setTimeout","trim","searchUsers","then","results","catch","clearTimeout","handleSearchChange","e","target","value","handleSelectUser","newChat","startChat","_id","prev","handleFileChange","files","length","selectedFile","previewURL","URL","createObjectURL","sizeKB","size","toFixed","name","type","handleCancelPreview","handleSendMessage","formData","FormData","append","msgCreated","sendMessage","prevChats","map","c","lastMessage","handleLogout","handleGoDashboard","getOtherParticipant","chat","participants","find","p","renderChatList","className","children","chatId","otherUser","isSelected","onClick","nombre","apellidos","text","renderFilePreview","isImage","startsWith","src","alt","placeholder","onChange","email","msg","idx","_msg$sender","isOutgoing","sender","fileUrl","href","download","fileName","htmlFor","style","display"],"sources":["C:/Users/User/Desktop/TFG/prototipo-TFG/Janus-TFG/src/components/Messaging.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport chatService from '../services/chatService';\r\nimport '../styles/messaging.css';\r\n\r\nfunction Messaging() {\r\n  const navigate = useNavigate();\r\n\r\n  // ID del usuario actual\r\n  const [currentUserId, setCurrentUserId] = useState(null);\r\n\r\n  // Lista de chats, chat seleccionado, mensajes\r\n  const [chats, setChats] = useState([]);\r\n  const [selectedChatId, setSelectedChatId] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  // B√∫squeda de usuarios\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n\r\n  // Texto del mensaje (comentario opcional) y archivo adjunto\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [file, setFile] = useState(null);\r\n\r\n  // Vista previa del archivo\r\n  const [filePreview, setFilePreview] = useState(null);\r\n\r\n  // Decodificar el token para obtener el ID del usuario (simplificado)\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      const decoded = JSON.parse(atob(token.split('.')[1])); \r\n      setCurrentUserId(decoded.user?.id);\r\n    }\r\n  }, []);\r\n\r\n  // Cargar la lista de chats\r\n  useEffect(() => {\r\n    async function fetchChats() {\r\n      try {\r\n        const data = await chatService.getChats();\r\n        setChats(data);\r\n      } catch (err) {\r\n        console.error('Error obteniendo chats:', err);\r\n      }\r\n    }\r\n    fetchChats();\r\n  }, []);\r\n\r\n  // Cargar mensajes al seleccionar un chat\r\n  useEffect(() => {\r\n    if (selectedChatId) {\r\n      async function fetchMessages() {\r\n        try {\r\n          const data = await chatService.getMessages(selectedChatId);\r\n          setMessages(data);\r\n        } catch (err) {\r\n          console.error('Error obteniendo mensajes:', err);\r\n        }\r\n      }\r\n      fetchMessages();\r\n    } else {\r\n      setMessages([]);\r\n    }\r\n  }, [selectedChatId]);\r\n\r\n  // B√∫squeda con debounce\r\n  useEffect(() => {\r\n    const delayDebounceFn = setTimeout(() => {\r\n      if (searchQuery.trim()) {\r\n        chatService.searchUsers(searchQuery.trim())\r\n          .then(results => setSearchResults(results))\r\n          .catch(err => {\r\n            console.error('Error buscando usuarios:', err);\r\n            setSearchResults([]);\r\n          });\r\n      } else {\r\n        setSearchResults([]);\r\n      }\r\n    }, 300);\r\n\r\n    return () => clearTimeout(delayDebounceFn);\r\n  }, [searchQuery]);\r\n\r\n  const handleSearchChange = (e) => {\r\n    setSearchQuery(e.target.value);\r\n  };\r\n\r\n  const handleSelectUser = async (user) => {\r\n    try {\r\n      const newChat = await chatService.startChat(user._id);\r\n      setChats(prev => [...prev, newChat]);\r\n      setSelectedChatId(newChat._id || newChat.id);\r\n      setSearchQuery('');\r\n      setSearchResults([]);\r\n    } catch (err) {\r\n      console.error('Error iniciando chat:', err);\r\n    }\r\n  };\r\n\r\n  const handleFileChange = (e) => {\r\n    if (e.target.files && e.target.files.length > 0) {\r\n      const selectedFile = e.target.files[0];\r\n      setFile(selectedFile);\r\n      const previewURL = URL.createObjectURL(selectedFile);\r\n      const sizeKB = (selectedFile.size / 1024).toFixed(1);\r\n      setFilePreview({\r\n        name: selectedFile.name,\r\n        sizeKB,\r\n        type: selectedFile.type,\r\n        previewURL\r\n      });\r\n      setNewMessage('');\r\n    }\r\n  };\r\n\r\n  const handleCancelPreview = () => {\r\n    setFile(null);\r\n    setFilePreview(null);\r\n    setNewMessage('');\r\n  };\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!selectedChatId) return;\r\n    if (!file && !newMessage.trim()) return;\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('text', newMessage);\r\n      if (file) formData.append('file', file);\r\n      const msgCreated = await chatService.sendMessage(selectedChatId, formData);\r\n      setMessages(prev => [...prev, msgCreated]);\r\n      setNewMessage('');\r\n      setFile(null);\r\n      setFilePreview(null);\r\n      setChats(prevChats =>\r\n        prevChats.map(c =>\r\n          (c._id === selectedChatId || c.id === selectedChatId)\r\n            ? { ...c, lastMessage: msgCreated }\r\n            : c\r\n        )\r\n      );\r\n    } catch (err) {\r\n      console.error('Error enviando mensaje:', err);\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    navigate('/');\r\n  };\r\n\r\n  // Bot√≥n para regresar al Dashboard\r\n  const handleGoDashboard = () => {\r\n    navigate('/dashboard');\r\n  };\r\n\r\n  const getOtherParticipant = (chat) => {\r\n    if (!chat.participants || !currentUserId) return null;\r\n    return chat.participants.find(p => p._id !== currentUserId);\r\n  };\r\n\r\n  const renderChatList = () => {\r\n    if (chats.length === 0) {\r\n      return (\r\n        <div className=\"no-chats\">\r\n          <p>Comienza a conversar ahora con tus especialistas! üòä</p>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <ul className=\"chat-list\">\r\n        {chats.map((chat) => {\r\n          const chatId = chat._id || chat.id;\r\n          const otherUser = getOtherParticipant(chat);\r\n          const isSelected = chatId === selectedChatId;\r\n          return (\r\n            <li\r\n              key={chatId}\r\n              className={`chat-item ${isSelected ? 'selected' : ''}`}\r\n              onClick={() => setSelectedChatId(chatId)}\r\n            >\r\n              <div className=\"chat-avatar\">\r\n                <i className=\"fa fa-user-circle\" aria-hidden=\"true\"></i>\r\n              </div>\r\n              <div className=\"chat-info\">\r\n                <p className=\"chat-name\">\r\n                  {otherUser ? `${otherUser.nombre} ${otherUser.apellidos}` : 'Usuario desconocido'}\r\n                </p>\r\n                {chat.lastMessage && (\r\n                  <p className=\"chat-last-message\">\r\n                    {chat.lastMessage.text ? chat.lastMessage.text : '[Archivo adjunto]'}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n    );\r\n  };\r\n\r\n  const renderFilePreview = () => {\r\n    if (!filePreview) return null;\r\n    const isImage = filePreview.type.startsWith('image/');\r\n    return (\r\n      <div className=\"file-preview-container\">\r\n        {isImage ? (\r\n          <img src={filePreview.previewURL} alt=\"Vista previa\" className=\"file-preview-image\" />\r\n        ) : (\r\n          <div className=\"file-preview-placeholder\">\r\n            <i className=\"fa fa-file-pdf-o\" aria-hidden=\"true\"></i>\r\n          </div>\r\n        )}\r\n        <p className=\"file-preview-name\">\r\n          {filePreview.name} ({filePreview.sizeKB} KB)\r\n        </p>\r\n        <textarea\r\n          className=\"file-preview-comment\"\r\n          placeholder=\"Comentario (opcional)\"\r\n          value={newMessage}\r\n          onChange={(e) => setNewMessage(e.target.value)}\r\n        />\r\n        <div className=\"file-preview-buttons\">\r\n          <button onClick={handleCancelPreview} className=\"btn-cancel\">Cancelar</button>\r\n          <button onClick={handleSendMessage} className=\"btn-send\">Enviar</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"messaging-container\">\r\n      <header className=\"top-bar\">\r\n        <div className=\"left-section\">\r\n          <button className=\"back-dashboard-btn\" onClick={handleGoDashboard}>‚Üê</button>\r\n          <i className=\"fa fa-user-circle user-icon\" aria-hidden=\"true\"></i>\r\n        </div>\r\n        <div className=\"center-section\">\r\n          <h1 className=\"title\">JANUS</h1>\r\n        </div>\r\n        <div className=\"right-section\">\r\n          <button className=\"logout-btn\" onClick={handleLogout}>\r\n            Cerrar Sesi√≥n\r\n          </button>\r\n        </div>\r\n      </header>\r\n\r\n      <main className=\"messaging-main\">\r\n        <div className=\"chat-list-container\">\r\n          <div className=\"search-bar\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Buscar usuarios...\"\r\n              value={searchQuery}\r\n              onChange={handleSearchChange}\r\n            />\r\n            {searchResults.length > 0 && (\r\n              <ul className=\"search-dropdown\">\r\n                {searchResults.map((user) => (\r\n                  <li\r\n                    key={user._id}\r\n                    className=\"search-dropdown-item\"\r\n                    onClick={() => handleSelectUser(user)}\r\n                  >\r\n                    {user.nombre} {user.apellidos} ({user.email})\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            )}\r\n          </div>\r\n          {renderChatList()}\r\n        </div>\r\n\r\n        <div className=\"chat-detail\">\r\n          {selectedChatId ? (\r\n            <>\r\n              <div className=\"messages-area\">\r\n                {messages.map((msg, idx) => {\r\n                  const isOutgoing = msg.sender?._id === currentUserId || msg.sender === currentUserId;\r\n                  return (\r\n                    <div\r\n                      key={idx}\r\n                      className={`message-item ${isOutgoing ? 'message-outgoing' : 'message-incoming'}`}\r\n                    >\r\n                      <p className=\"message-text\">{msg.text}</p>\r\n                      {msg.fileUrl && (\r\n                        <div className=\"message-file\">\r\n                          <a href={msg.fileUrl} download>\r\n                            {msg.fileName || 'Descargar archivo'}\r\n                          </a>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n              {filePreview ? renderFilePreview() : (\r\n                <div className=\"new-message-area\">\r\n                  <label htmlFor=\"fileInput\" className=\"attach-btn\">\r\n                    <i className=\"fa fa-paperclip\" aria-hidden=\"true\"></i>\r\n                  </label>\r\n                  <input\r\n                    type=\"file\"\r\n                    id=\"fileInput\"\r\n                    style={{ display: 'none' }}\r\n                    onChange={handleFileChange}\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    className=\"message-input\"\r\n                    placeholder=\"Escribe algo...\"\r\n                    value={newMessage}\r\n                    onChange={(e) => setNewMessage(e.target.value)}\r\n                  />\r\n                  <button className=\"send-btn\" onClick={handleSendMessage}>\r\n                    Enviar\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </>\r\n          ) : (\r\n            <div className=\"no-chat-selected\">\r\n              <p>Selecciona un chat para ver los mensajes</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n\r\n      <footer className=\"footer-bar\">\r\n        <p>2025 ¬© Iv√°n Vela Campos</p>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Messaging;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}